{"version":3,"file":"klinecharts.simple.js","sources":["../src/store/extension.js","../src/utils/typeChecks.js","../src/options/styleOptions.js","../src/utils/format.js","../src/utils/logger.js","../src/utils/number.js","../src/enum/ActionType.js","../src/store/TimeScaleStore.js","../src/component/technicalindicator/TechnicalIndicator.js","../src/store/TechnicalIndicatorStore.js","../src/component/overlay/Overlay.js","../src/renderer/circle.js","../src/extension/shape/shapeHelper.js","../src/renderer/path.js","../src/renderer/line.js","../src/utils/canvas.js","../src/component/overlay/Shape.js","../src/enum/InvalidateLevel.js","../src/store/ShapeStore.js","../src/store/AnnotationStore.js","../src/store/TagStore.js","../src/store/CrosshairStore.js","../src/store/ActionStore.js","../src/store/ChartStore.js","../src/utils/element.js","../src/pane/Pane.js","../src/widget/Widget.js","../src/utils/compatible.js","../src/view/View.js","../src/view/TechnicalIndicatorView.js","../src/renderer/text.js","../src/view/TechnicalIndicatorOverlayView.js","../src/widget/TechnicalIndicatorWidget.js","../src/renderer/rect.js","../src/view/YAxisView.js","../src/view/YAxisOverlayView.js","../src/widget/YAxisWidget.js","../src/component/axis/Axis.js","../src/component/axis/YAxis.js","../src/pane/TechnicalIndicatorPane.js","../src/view/CandleView.js","../src/view/CandleOverlayView.js","../src/widget/CandleWidget.js","../src/pane/CandlePane.js","../src/view/XAxisView.js","../src/view/XAxisOverlayView.js","../src/widget/XAxisWidget.js","../src/component/axis/XAxis.js","../src/pane/XAxisPane.js","../src/event/eventTypeChecks.js","../src/event/EventBase.js","../src/pane/SeparatorPane.js","../src/event/EventHandler.js","../src/event/ZoomScrollEventHandler.js","../src/event/OverlayEventHandler.js","../src/event/KeyBoardEventHandler.js","../src/event/ChartEvent.js","../src/utils/performance.js","../src/renderer/diamond.js","../src/renderer/triangle.js","../src/component/overlay/Annotation.js","../src/component/overlay/Tag.js","../src/pane/ChartPane.js","../src/Chart.js","../src/core.js"],"sourcesContent":["/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default {\n  technicalIndicatorExtensions: {},\n  shapeExtensions: {},\n  addTechnicalIndicatorTemplate (template) {\n    if (template) {\n      ([].concat(template)).forEach(\n        tmp => {\n          if (tmp.name) {\n            this.technicalIndicatorExtensions[tmp.name] = tmp\n          }\n        }\n      )\n    }\n  },\n  addShapeTemplate (template) {\n    if (template) {\n      ([].concat(template)).forEach(\n        tmp => {\n          if (tmp.name) {\n            this.shapeExtensions[tmp.name] = tmp\n          }\n        }\n      )\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 合并\n * @param target\n * @param source\n */\nexport function merge (target, source) {\n  if (!isObject(target) || !isObject(source)) {\n    return\n  }\n  for (const key in source) {\n    if (Object.prototype.hasOwnProperty.call(source, key) && (key in target)) {\n      const targetProp = target[key]\n      const sourceProp = source[key]\n      if (\n        isObject(sourceProp) &&\n        isObject(targetProp) &&\n        !isArray(sourceProp) &&\n        !isArray(targetProp)\n      ) {\n        merge(targetProp, sourceProp)\n      } else {\n        if (isValid(source[key])) {\n          target[key] = source[key]\n        }\n      }\n    }\n  }\n}\n\n/**\n * 克隆\n * @param target\n * @return {{}|*}\n */\nexport function clone (target) {\n  if (!isObject(target)) {\n    return target\n  }\n\n  let copy\n  if (isArray(target)) {\n    copy = []\n  } else {\n    copy = {}\n  }\n  for (const key in target) {\n    if (Object.prototype.hasOwnProperty.call(target, key)) {\n      const v = target[key]\n      if (isObject(v)) {\n        copy[key] = clone(v)\n      } else {\n        copy[key] = v\n      }\n    }\n  }\n  return copy\n}\n\n/**\n * 是否是数组\n * @param value\n * @return {boolean}\n */\nexport function isArray (value) {\n  return Object.prototype.toString.call(value) === '[object Array]'\n}\n\n/**\n * 是否是方法\n * @param {*} value\n * @return {boolean}\n */\nexport function isFunction (value) {\n  return value && typeof value === 'function'\n}\n\n/**\n * 是否是对象\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject (value) {\n  return (!!value && typeof value === 'object')\n}\n\n/**\n * 判断是否是数字\n * @param value\n * @returns {boolean}\n */\nexport function isNumber (value) {\n  return typeof value === 'number' && !isNaN(value)\n}\n\n/**\n * 判断是否有效\n * @param value\n * @returns {boolean}\n */\nexport function isValid (value) {\n  return value !== null && value !== undefined\n}\n\n/**\n * 判断是否是boolean\n * @param value\n * @returns {boolean}\n */\nexport function isBoolean (value) {\n  return typeof value === 'boolean'\n}\n\n/**\n * 是否是字符串\n * @param value\n * @return {boolean}\n */\nexport function isString (value) {\n  return typeof value === 'string'\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 填充空心样式类型\n */\nexport const StrokeFillStyle = {\n  STROKE: 'stroke',\n  FILL: 'fill'\n}\n\n/**\n * 线的样式\n * @type {{DASH: string, SOLID: string}}\n */\nexport const LineStyle = {\n  DASH: 'dash',\n  SOLID: 'solid'\n}\n\n/**\n * y轴位置\n * @type {{LEFT: string, RIGHT: string}}\n */\nexport const YAxisPosition = {\n  LEFT: 'left',\n  RIGHT: 'right'\n}\n\n/**\n * y轴类型\n * @type {{PERCENTAGE: string, NORMAL: string}}\n */\nexport const YAxisType = {\n  NORMAL: 'normal',\n  PERCENTAGE: 'percentage',\n  LOG: 'log'\n}\n\n/**\n * 蜡烛图样式\n * @type {{AREA: string, OHLC: string, CANDLE_STROKE: string, CANDLE_SOLID: string, CANDLE_DOWN_STROKE: string, CANDLE_UP_STROKE: string}}\n */\nexport const CandleType = {\n  CANDLE_SOLID: 'candle_solid',\n  CANDLE_STROKE: 'candle_stroke',\n  CANDLE_UP_STROKE: 'candle_up_stroke',\n  CANDLE_DOWN_STROKE: 'candle_down_stroke',\n  OHLC: 'ohlc',\n  AREA: 'area'\n}\n\n/**\n * 说明显示规则\n * @type {{FOLLOW_CROSS: string, NONE: string, ALWAYS: string}}\n */\nexport const TooltipShowRule = {\n  ALWAYS: 'always',\n  FOLLOW_CROSS: 'follow_cross',\n  NONE: 'none'\n}\n\n/**\n * 数据提示显示类型\n * @type {{RECT: string, STANDARD: string}}\n */\nexport const TooltipShowType = {\n  RECT: 'rect',\n  STANDARD: 'standard'\n}\n\n/**\n * 注解标识类似\n * @type {{RECT: string, TRIANGLE: string, DIAMOND: string, CUSTOM: string, NONE: string, CIRCLE: string}}\n */\nexport const AnnotationSymbolType = {\n  CIRCLE: 'circle',\n  RECT: 'rect',\n  TRIANGLE: 'triangle',\n  DIAMOND: 'diamond',\n  CUSTOM: 'custom',\n  NONE: 'none'\n}\n\n/**\n * 覆盖物位置\n * @type {{TOP: string, BOTTOM: string, POINT: string}}\n */\nexport const OverlayPosition = {\n  POINT: 'point',\n  TOP: 'top',\n  BOTTOM: 'bottom'\n}\n\n/**\n * 默认网格配置\n * @type {{horizontal: {size: number, color: string, dashValue: number[], show: boolean, style: string}, show: boolean, vertical: {size: number, color: string, dashValue: number[], show: boolean, style: string}}}\n */\nconst defaultGrid = {\n  show: true,\n  horizontal: {\n    show: true,\n    size: 1,\n    color: '#EDEDED',\n    style: LineStyle.DASH,\n    dashValue: [2, 2]\n  },\n  vertical: {\n    show: true,\n    size: 1,\n    color: '#EDEDED',\n    style: LineStyle.DASH,\n    dashValue: [2, 2]\n  }\n}\n\n/**\n * 默认蜡烛柱图样式配置\n * @type {{area: {backgroundColor: [{offset: number, color: string}, {offset: number, color: string}], lineColor: string, lineSize: number, value: string}, bar: {noChangeColor: string, upColor: string, downColor: string}, tooltip: {rect: {offsetTop: number, fillColor: string, borderColor: string, paddingBottom: number, borderRadius: number, paddingRight: number, borderSize: number, offsetLeft: number, paddingTop: number, paddingLeft: number, offsetRight: number}, showRule: string, values: null, showType: string, text: {marginRight: number, size: number, color: string, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}, labels: string[]}, type: string, priceMark: {high: {textMargin: number, textSize: number, color: string, textFamily: string, show: boolean, textWeight: string}, last: {noChangeColor: string, upColor: string, line: {dashValue: number[], size: number, show: boolean, style: string}, show: boolean, text: {paddingBottom: number, size: number, color: string, paddingRight: number, show: boolean, weight: string, paddingTop: number, family: string, paddingLeft: number}, downColor: string}, low: {textMargin: number, textSize: number, color: string, textFamily: string, show: boolean, textWeight: string}, show: boolean}}}\n */\nconst defaultCandle = {\n  margin: {\n    top: 0.2,\n    bottom: 0.1\n  },\n  type: CandleType.CANDLE_SOLID,\n  bar: {\n    /**\n     * 上涨颜色\n     */\n    upColor: '#26A69A',\n    /**\n     * 下跌颜色\n     */\n    downColor: '#EF5350',\n    /**\n     * 无变化时颜色\n     */\n    noChangeColor: '#999999'\n  },\n  area: {\n    lineSize: 2,\n    lineColor: '#2196F3',\n    value: 'close',\n    backgroundColor: [{\n      offset: 0,\n      color: 'rgba(33, 150, 243, 0.01)'\n    }, {\n      offset: 1,\n      color: 'rgba(33, 150, 243, 0.2)'\n    }]\n  },\n  priceMark: {\n    show: true,\n    high: {\n      show: true,\n      color: '#76808F',\n      textMargin: 5,\n      textSize: 10,\n      textFamily: 'Helvetica Neue',\n      textWeight: 'normal'\n    },\n    low: {\n      show: true,\n      color: '#76808F',\n      textMargin: 5,\n      textSize: 10,\n      textFamily: 'Helvetica Neue',\n      textWeight: 'normal'\n    },\n    last: {\n      show: true,\n      upColor: '#26A69A',\n      downColor: '#EF5350',\n      noChangeColor: '#888888',\n      line: {\n        show: true,\n        style: LineStyle.DASH,\n        dashValue: [4, 4],\n        size: 1\n      },\n      text: {\n        show: true,\n        size: 12,\n        paddingLeft: 2,\n        paddingTop: 2,\n        paddingRight: 2,\n        paddingBottom: 2,\n        color: '#FFFFFF',\n        family: 'Helvetica Neue',\n        weight: 'normal',\n        borderRadius: 2\n      }\n    }\n  },\n  tooltip: {\n    showRule: TooltipShowRule.ALWAYS,\n    showType: TooltipShowType.STANDARD,\n    labels: ['时间: ', '开: ', '收: ', '高: ', '低: ', '成交量: '],\n    values: null,\n    defaultValue: 'n/a',\n    rect: {\n      paddingLeft: 0,\n      paddingRight: 0,\n      paddingTop: 0,\n      paddingBottom: 6,\n      offsetLeft: 8,\n      offsetTop: 8,\n      offsetRight: 8,\n      borderRadius: 4,\n      borderSize: 1,\n      borderColor: '#F2F3F5',\n      backgroundColor: '#FEFEFE'\n    },\n    text: {\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      color: '#76808F',\n      marginLeft: 8,\n      marginTop: 6,\n      marginRight: 8,\n      marginBottom: 0\n    }\n  }\n}\n\n/**\n * 默认的技术指标样式配置\n * @type {{bar: {noChangeColor: string, upColor: string, downColor: string}, line: {size: number, colors: [string, string, string, string, string]}, tooltip: {showParams: boolean, showName: boolean, showRule: string, text: {marginRight: number, size: number, color: string, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}}, circle: {noChangeColor: string, upColor: string, downColor: string}, lastValueMark: {show: boolean, text: {paddingBottom: number, color: string, size: number, paddingRight: number, show: boolean, weight: string, paddingTop: number, family: string, paddingLeft: number}}}}\n */\nconst defaultTechnicalIndicator = {\n  margin: {\n    top: 0.2,\n    bottom: 0.1\n  },\n  bar: {\n    upColor: 'rgba(38, 166, 154, .65)',\n    downColor: 'rgba(239, 83, 80, .65)',\n    noChangeColor: '#888888'\n  },\n  line: {\n    size: 1,\n    colors: ['#FF9600', '#9D65C9', '#2196F3', '#E11D74', '#01C5C4']\n  },\n  circle: {\n    upColor: 'rgba(38, 166, 154, .65)',\n    downColor: 'rgba(239, 83, 80, .65)',\n    noChangeColor: '#888888'\n  },\n  lastValueMark: {\n    show: false,\n    text: {\n      show: false,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 3,\n      paddingTop: 2,\n      paddingRight: 3,\n      paddingBottom: 2,\n      borderRadius: 2\n    }\n  },\n  tooltip: {\n    showRule: TooltipShowRule.ALWAYS,\n    showType: TooltipShowType.STANDARD,\n    showName: true,\n    showParams: true,\n    defaultValue: 'n/a',\n    text: {\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      color: '#76808F',\n      marginTop: 6,\n      marginRight: 8,\n      marginBottom: 0,\n      marginLeft: 8\n    }\n  }\n}\n\n/**\n * 默认x轴配置\n * @type {{axisLine: {color: string, size: number, show: boolean}, show: boolean, tickText: {paddingBottom: number, color: string, size: number, show: boolean, weight: string, paddingTop: number, family: string}, height: null, tickLine: {size: number, color: string, show: boolean, length: number}}}\n */\nconst defaultXAxis = {\n  /**\n   * 是否显示整个轴\n   */\n  show: true,\n  /**\n   * 高度\n   */\n  height: null,\n  /**\n   * 轴线配置\n   */\n  axisLine: {\n    show: true,\n    color: '#DDDDDD',\n    size: 1\n  },\n\n  /**\n   * tick文字\n   */\n  tickText: {\n    show: true,\n    color: '#76808F',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingTop: 3,\n    paddingBottom: 6\n  },\n  // tick线\n  tickLine: {\n    show: true,\n    size: 1,\n    length: 3,\n    color: '#DDDDDD'\n  }\n}\n\n/**\n * 默认y轴配置\n * @type {{axisLine: {color: string, size: number, show: boolean}, show: boolean, width: null, position: string, tickText: {color: string, size: number, paddingRight: number, show: boolean, weight: string, family: string, paddingLeft: number}, type: string, inside: boolean, tickLine: {size: number, color: string, show: boolean, length: number}}}\n */\nconst defaultYAxis = {\n  /**\n   * 是否显示整个轴\n   */\n  show: true,\n  /**\n   * 宽度\n   */\n  width: null,\n  /**\n   * y轴类型\n   */\n  type: YAxisType.NORMAL,\n  /**\n   * 轴位置\n   */\n  position: YAxisPosition.RIGHT,\n  /**\n   * 轴是否在内部\n   */\n  inside: false,\n  /**\n   * 轴线配置\n   */\n  axisLine: {\n    show: true,\n    color: '#DDDDDD',\n    size: 1\n  },\n\n  /**\n   * tick文字\n   */\n  tickText: {\n    show: true,\n    color: '#76808F',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 3,\n    paddingRight: 6\n  },\n  // tick线\n  tickLine: {\n    show: true,\n    size: 1,\n    length: 3,\n    color: '#DDDDDD'\n  }\n}\n\nconst defaultCrosshair = {\n  show: true,\n  horizontal: {\n    show: true,\n    line: {\n      show: true,\n      style: LineStyle.DASH,\n      dashValue: [4, 2],\n      size: 1,\n      color: '#76808F'\n    },\n    text: {\n      show: true,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 2,\n      paddingRight: 2,\n      paddingTop: 2,\n      paddingBottom: 2,\n      borderSize: 1,\n      borderColor: '#686D76',\n      borderRadius: 2,\n      backgroundColor: '#686D76'\n    }\n  },\n  vertical: {\n    show: true,\n    line: {\n      show: true,\n      style: LineStyle.DASH,\n      dashValue: [4, 2],\n      size: 1,\n      color: '#76808F'\n    },\n    text: {\n      show: true,\n      color: '#FFFFFF',\n      size: 12,\n      family: 'Helvetica Neue',\n      weight: 'normal',\n      paddingLeft: 2,\n      paddingRight: 2,\n      paddingTop: 2,\n      paddingBottom: 2,\n      borderSize: 1,\n      borderRadius: 2,\n      borderColor: '#686D76',\n      backgroundColor: '#686D76'\n    }\n  }\n}\n\n/**\n * 默认图形配置\n * @type {{arc: {style: string, color: string, size: number}, polygon: {style: string, color: string, size: number}, line: {style: string, color: string, size: number, dashValue: number[]}, text: {style: string, marginRight: number, color: string, size: number, weight: string, marginBottom: number, family: string, marginTop: number, marginLeft: number}, point: {backgroundColor: string, borderColor: string, activeBorderSize: number, activeRadius: number, activeBorderColor: string, activeBackgroundColor: string, borderSize: number, radius: number}}}\n */\nconst defaultShape = {\n  point: {\n    backgroundColor: '#2196F3',\n    borderColor: 'rgba(33, 150, 243, 0.35)',\n    borderSize: 1,\n    radius: 5,\n    activeBackgroundColor: '#2196F3',\n    activeBorderColor: 'rgba(33, 150, 243, 0.35)',\n    activeBorderSize: 3,\n    activeRadius: 5\n  },\n  line: {\n    style: LineStyle.SOLID,\n    color: '#2196F3',\n    size: 1,\n    dashValue: [2, 2]\n  },\n  polygon: {\n    style: StrokeFillStyle.STROKE,\n    stroke: {\n      style: LineStyle.SOLID,\n      size: 1,\n      color: '#2196F3',\n      dashValue: [2, 2]\n    },\n    fill: {\n      color: '#2196F3'\n    }\n  },\n  arc: {\n    style: StrokeFillStyle.STROKE,\n    stroke: {\n      style: LineStyle.SOLID,\n      size: 1,\n      color: '#2196F3',\n      dashValue: [2, 2]\n    },\n    fill: {\n      color: '#2196F3'\n    }\n  },\n  text: {\n    style: StrokeFillStyle.FILL,\n    color: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    offset: [0, 0]\n  }\n}\n\n/**\n * 默认注解信息配置\n * @type {{}}\n */\nconst defaultAnnotation = {\n  position: OverlayPosition.TOP,\n  offset: [20, 0],\n  symbol: {\n    type: AnnotationSymbolType.DIAMOND,\n    size: 8,\n    color: '#2196F3',\n    activeSize: 10,\n    activeColor: '#FF9600'\n  }\n}\n\nconst defaultTag = {\n  position: OverlayPosition.POINT,\n  offset: 0,\n  line: {\n    show: true,\n    style: LineStyle.DASH,\n    dashValue: [4, 2],\n    size: 1,\n    color: '#2196F3'\n  },\n  text: {\n    color: '#FFFFFF',\n    backgroundColor: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 2,\n    paddingRight: 2,\n    paddingTop: 2,\n    paddingBottom: 2,\n    borderRadius: 2,\n    borderSize: 1,\n    borderColor: '#2196F3'\n  },\n  mark: {\n    offset: 0,\n    color: '#FFFFFF',\n    backgroundColor: '#2196F3',\n    size: 12,\n    family: 'Helvetica Neue',\n    weight: 'normal',\n    paddingLeft: 2,\n    paddingRight: 2,\n    paddingTop: 2,\n    paddingBottom: 2,\n    borderRadius: 2,\n    borderSize: 1,\n    borderColor: '#2196F3'\n  }\n}\n\n/**\n * 图表之间默认分割配置\n * @type {{size: number, color: string}}\n */\nconst defaultSeparator = {\n  size: 1,\n  color: '#DDDDDD',\n  fill: true,\n  activeBackgroundColor: 'rgba(33, 150, 243, 0.08)'\n}\n\nexport const defaultStyleOptions = {\n  grid: defaultGrid,\n  candle: defaultCandle,\n  technicalIndicator: defaultTechnicalIndicator,\n  xAxis: defaultXAxis,\n  yAxis: defaultYAxis,\n  separator: defaultSeparator,\n  crosshair: defaultCrosshair,\n  shape: defaultShape,\n  annotation: defaultAnnotation,\n  tag: defaultTag\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isNumber, isObject, isValid } from './typeChecks'\n\n/**\n * 格式化值\n * @param data\n * @param key\n * @param defaultValue\n * @returns {string|*}\n */\nexport function formatValue (data, key, defaultValue = '--') {\n  if (isObject(data)) {\n    const value = data[key]\n    if (isValid(value)) {\n      return value\n    }\n  }\n  return defaultValue\n}\n\n/**\n * 格式化时间\n * @param dateTimeFormat\n * @param timestamp\n * @param format\n * @returns {string}\n */\nexport function formatDate (dateTimeFormat, timestamp, format = 'MM-DD hh:mm') {\n  if (isNumber(timestamp)) {\n    const dateTimeString = dateTimeFormat.format(new Date(timestamp))\n    const dateTimeStringArray = dateTimeString.split(', ')\n    const dateStringArray = dateTimeStringArray[0].split('/')\n    const date = {\n      YYYY: dateStringArray[2],\n      MM: dateStringArray[0],\n      DD: dateStringArray[1],\n      'hh:mm': dateTimeStringArray[1].match(/^[\\d]{2}/)[0] === '24'\n        ? dateTimeStringArray[1].replace(/^[\\d]{2}/, '00')\n        : dateTimeStringArray[1]\n    }\n    return format.replace(/YYYY|MM|DD|(hh:mm)/g, key => date[key])\n  }\n  return '--'\n}\n\n/**\n * 格式化精度\n */\nexport function formatPrecision (value, precision = 2) {\n  const v = +value\n  if ((v || v === 0) && isNumber(v)) {\n    return v.toFixed(precision)\n  }\n  return `${v}`\n}\n\n/**\n * 格式化大数据\n * @param value\n */\nexport function formatBigNumber (value) {\n  if (isNumber(+value)) {\n    if (value > 1000000000) {\n      return `${+((value / 1000000000).toFixed(3))}B`\n    }\n    if (value > 1000000) {\n      return `${+((value / 1000000).toFixed(3))}M`\n    }\n    if (value > 1000) {\n      return `${+((value / 1000).toFixed(3))}K`\n    }\n    return value\n  }\n  return '--'\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst DEV = '__BUILD_ENV__' === 'development'\n\n/**\n * 打印警告日志\n * @param api\n * @param invalidParam\n * @param append\n */\nexport function logWarn (api, invalidParam, append = '') {\n  if (DEV) {\n    console.log(\n      '%c😑 warning: \\n%s%s%s',\n      'color:#fcaf17;font-weight:bold',\n      api ? `Call api ${api}${invalidParam || append ? ', ' : '.'}` : '',\n      invalidParam ? `invalid parameter ${invalidParam}${append ? ', ' : '.'}` : '',\n      append ? `${append}` : ''\n    )\n  }\n}\n\n/**\n * 打印错误日志\n * @param api\n * @param invalidParam\n * @param append\n */\nexport function logError (api, invalidParam, append = '') {\n  if (DEV) {\n    console.log(\n      '%c😟 error: \\n%s%s%s',\n      'color:#ed1941;font-weight:bold',\n      api ? `Call api ${api}${invalidParam || append ? ', ' : '.'},` : '',\n      invalidParam ? `invalid parameter ${invalidParam}${append ? ', ' : '.'}` : '',\n      append ? `${append}` : ''\n    )\n  }\n}\n\n/**\n * 打印标识\n */\nexport function logTag () {\n  if (DEV) {\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 二分查找最接近的数\n * @param dataList\n * @param valueKey\n * @param targetNumber\n * @return {number}\n */\nexport function binarySearchNearest (dataList, valueKey, targetNumber) {\n  let left = 0\n  let right = 0\n  for (right = dataList.length - 1; left !== right;) {\n    const midIndex = Math.floor((right + left) / 2)\n    const mid = right - left\n    const midValue = dataList[midIndex][valueKey]\n    if (targetNumber === dataList[left][valueKey]) {\n      return left\n    }\n    if (targetNumber === dataList[right][valueKey]) {\n      return right\n    }\n    if (targetNumber === midValue) {\n      return midIndex\n    }\n\n    if (targetNumber > midValue) {\n      left = midIndex\n    } else {\n      right = midIndex\n    }\n\n    if (mid <= 2) {\n      break\n    }\n  }\n  return left\n}\n\n/**\n * 优化数字\n * @param value\n * @return {number|number}\n */\nexport function nice (value) {\n  const exponent = Math.floor(log10(value))\n  const exp10 = index10(exponent)\n  const f = value / exp10 // 1 <= f < 10\n  let nf = 0\n  if (f < 1.5) {\n    nf = 1\n  } else if (f < 2.5) {\n    nf = 2\n  } else if (f < 3.5) {\n    nf = 3\n  } else if (f < 4.5) {\n    nf = 4\n  } else if (f < 5.5) {\n    nf = 5\n  } else if (f < 6.5) {\n    nf = 6\n  } else {\n    nf = 8\n  }\n  value = nf * exp10\n  return exponent >= -20 ? +value.toFixed(exponent < 0 ? -exponent : 0) : value\n}\n\n/**\n * 四和五入\n * @param value\n * @param precision\n * @return {number}\n */\nexport function round (value, precision) {\n  if (precision == null) {\n    precision = 10\n  }\n  precision = Math.min(Math.max(0, precision), 20)\n  value = (+value).toFixed(precision)\n  return +value\n}\n\n/**\n * 获取小数位数\n * @param value\n * @return {number|number}\n */\nexport function getPrecision (value) {\n  const str = value.toString()\n  const eIndex = str.indexOf('e')\n  if (eIndex > 0) {\n    const precision = +str.slice(eIndex + 1)\n    return precision < 0 ? -precision : 0\n  } else {\n    const dotIndex = str.indexOf('.')\n    return dotIndex < 0 ? 0 : str.length - 1 - dotIndex\n  }\n}\n\n/**\n * 10为低的对数函数\n * @param value\n * @return {number}\n */\nexport function log10 (value) {\n  return Math.log(value) / Math.log(10)\n}\n\n/**\n * 10的指数函数\n * @param value\n * @return {number}\n */\nexport function index10 (value) {\n  return Math.pow(10, value)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 图表动作\n */\nconst ActionType = {\n  ZOOM: 'zoom',\n  SCROLL: 'scroll',\n  CROSSHAIR: 'crosshair',\n  TOOLTIP: 'tooltip',\n  PANE_DRAG: 'pane_drag'\n}\n\nexport function hasAction (type) {\n  return Object.values(ActionType).indexOf(type) > -1\n}\n\nexport default ActionType\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isFunction, isValid } from '../utils/typeChecks'\nimport { formatValue } from '../utils/format'\nimport { logWarn } from '../utils/logger'\nimport { binarySearchNearest } from '../utils/number'\n\nimport ActionType from '../enum/ActionType'\n\n// 最小单条数据宽度\nconst MIN_DATA_SPACE = 1\n\n// 最大单条数据宽度\nconst MAX_DATA_SPACE = 50\n\nexport default class TimeScaleStore {\n  constructor (chartStore) {\n    this._chartStore = chartStore\n    this._dateTimeFormat = new Intl.DateTimeFormat(\n      'en', {\n        hour12: false, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit'\n      }\n    )\n\n    // 是否可以缩放\n    this._zoomEnabled = true\n    // 是否可以拖拽滑动\n    this._scrollEnabled = true\n\n    // 是否在加载中\n    this._loading = true\n    // 加载更多回调\n    this._loadMoreCallback = null\n    // 还有更多\n    this._more = true\n\n    // 可见区域数据占用的空间\n    this._totalDataSpace = 0\n    // 每一条数据的空间\n    this._dataSpace = 6\n    // bar的空间\n    this._barSpace = this._calcBarSpace()\n    // 向右偏移的空间\n    this._offsetRightSpace = 50\n    // 向右偏移的数量\n    this._offsetRightBarCount = this._offsetRightSpace / this._dataSpace\n    // 左边最小可见bar的个数\n    this._leftMinVisibleBarCount = 2\n    // 右边最小可见bar的个数\n    this._rightMinVisibleBarCount = 2\n    // 开始绘制的索引\n    this._from = 0\n    // 结束的索引\n    this._to = 0\n\n    // 用来记录开始拖拽时向右偏移的数量\n    this._preOffsetRightBarCount = 0\n  }\n\n  /**\n   * 计算一条柱子的空间\n   * @returns {number}\n   * @private\n   */\n  _calcBarSpace () {\n    const rateBarSpace = Math.floor(this._dataSpace * 0.82)\n    const floorBarSpace = Math.floor(this._dataSpace)\n    const optimalBarSpace = Math.min(rateBarSpace, floorBarSpace - 1)\n    return Math.max(1, optimalBarSpace)\n  }\n\n  /**\n   * 调整绘制起点终点位置\n   * @private\n   */\n  adjustFromTo () {\n    const dataSize = this._chartStore.dataList().length\n    const barLength = this._totalDataSpace / this._dataSpace\n    const maxRightOffsetBarCount = barLength - Math.min(this._leftMinVisibleBarCount, dataSize)\n    if (this._offsetRightBarCount > maxRightOffsetBarCount) {\n      this._offsetRightBarCount = maxRightOffsetBarCount\n    }\n\n    const minRightOffsetBarCount = -dataSize + Math.min(this._rightMinVisibleBarCount, dataSize)\n\n    if (this._offsetRightBarCount < minRightOffsetBarCount) {\n      this._offsetRightBarCount = minRightOffsetBarCount\n    }\n    this._to = Math.round(this._offsetRightBarCount + dataSize + 0.5)\n    this._from = Math.round(this._to - barLength) - 1\n    if (this._to > dataSize) {\n      this._to = dataSize\n    }\n    if (this._from < 0) {\n      this._from = 0\n    }\n    this._chartStore.adjustVisibleDataList()\n    // 处理加载更多，有更多并且没有在加载则去加载更多\n    if (this._from === 0 && this._more && !this._loading && isFunction(this._loadMoreCallback)) {\n      this._loading = true\n      this._loadMoreCallback(formatValue(this._chartStore.dataList()[0], 'timestamp'))\n    }\n  }\n\n  /**\n   * 设置是否有更多\n   * @param more\n   */\n  setMore (more) {\n    this._more = more\n  }\n\n  /**\n   * 设置是否在加载\n   */\n  setLoading (loading) {\n    this._loading = loading\n  }\n\n  /**\n   * 获取时间格式化\n   * @returns {Intl.DateTimeFormat | Intl.DateTimeFormat}\n   */\n  dateTimeFormat () {\n    return this._dateTimeFormat\n  }\n\n  /**\n   * 设置时区\n   * @param timezone\n   */\n  setTimezone (timezone) {\n    let dateTimeFormat\n    try {\n      dateTimeFormat = new Intl.DateTimeFormat(\n        'en', {\n          hour12: false, timeZone: timezone, year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit'\n        }\n      )\n    } catch (e) {\n      logWarn('', '', 'Timezone is error!!!')\n    }\n    if (dateTimeFormat) {\n      this._dateTimeFormat = dateTimeFormat\n    }\n  }\n\n  /**\n   * 获取时区\n   * @returns {null}\n   */\n  timezone () {\n    return this._dateTimeFormat.resolvedOptions().timeZone\n  }\n\n  /**\n   * 获取一条数据的空间\n   * @returns {number}\n   */\n  dataSpace () {\n    return this._dataSpace\n  }\n\n  /**\n   * 获取绘制一条数据的空间（不包括bar之间的间隙）\n   * @returns {*}\n   */\n  barSpace () {\n    return this._barSpace\n  }\n\n  /**\n   * 获取绘制一条数据一半的空间（不包括bar之间的间隙）\n   * @returns\n   */\n  halfBarSpace () {\n    return this._barSpace / 2\n  }\n\n  /**\n   * 设置一条数据的空间\n   * @param dataSpace\n   * @param adjustBeforeFuc\n   */\n  setDataSpace (dataSpace, adjustBeforeFuc) {\n    if (dataSpace < MIN_DATA_SPACE || dataSpace > MAX_DATA_SPACE || this._dataSpace === dataSpace) {\n      return\n    }\n    this._dataSpace = dataSpace\n    this._barSpace = this._calcBarSpace()\n    adjustBeforeFuc && adjustBeforeFuc()\n    this.adjustFromTo()\n    this._chartStore.crosshairStore().recalculate(true)\n    this._chartStore.invalidate()\n  }\n\n  /**\n   * 设置可见区域数据占用的总空间\n   * @param totalSpace\n   */\n  setTotalDataSpace (totalSpace) {\n    if (this._totalDataSpace === totalSpace) {\n      return\n    }\n    this._totalDataSpace = totalSpace\n    this.adjustFromTo()\n    this._chartStore.crosshairStore().recalculate(true)\n  }\n\n  /**\n   * 设置右边可以偏移的空间\n   * @param space\n   * @param invalidate\n   */\n  setOffsetRightSpace (space, invalidate) {\n    this._offsetRightSpace = space\n    this._offsetRightBarCount = space / this._dataSpace\n    if (invalidate) {\n      this.adjustFromTo()\n      this._chartStore.crosshairStore().recalculate(true)\n      this._chartStore.invalidate()\n    }\n  }\n\n  /**\n   * 重置右边可以偏移的空间\n   */\n  resetOffsetRightSpace () {\n    this.setOffsetRightSpace(this._offsetRightSpace)\n  }\n\n  /**\n   * 右偏移距离\n   * @return {number}\n   */\n  offsetRightSpace () {\n    return this._offsetRightSpace\n  }\n\n  /**\n   * 右偏移bar数量\n   * @return {*|number}\n   */\n  offsetRightBarCount () {\n    return this._offsetRightBarCount\n  }\n\n  /**\n   * 设置右偏移bar数量\n   * @param barCount\n   */\n  setOffsetRightBarCount (barCount) {\n    this._offsetRightBarCount = barCount\n  }\n\n  /**\n   * 设置左边可见的最小bar数量\n   * @param barCount\n   */\n  setLeftMinVisibleBarCount (barCount) {\n    this._leftMinVisibleBarCount = barCount\n  }\n\n  /**\n   * 设置右边可见的最小bar数量\n   * @param barCount\n   */\n  setRightMinVisibleBarCount (barCount) {\n    this._rightMinVisibleBarCount = barCount\n  }\n\n  /**\n   * 获取数据绘制起点\n   * @returns {number}\n   */\n  from () {\n    return this._from\n  }\n\n  /**\n   * 获取数据绘制终点\n   * @returns {number}\n   */\n  to () {\n    return this._to\n  }\n\n  /**\n   * 开始滚动\n   */\n  startScroll () {\n    this._preOffsetRightBarCount = this._offsetRightBarCount\n  }\n\n  /**\n   * 滚动\n   * @param distance\n   * @param crosshair\n   */\n  scroll (distance, crosshair) {\n    if (!this._scrollEnabled) {\n      return\n    }\n    const distanceBarCount = distance / this._dataSpace\n    this._chartStore.actionStore().execute(ActionType.SCROLL, { barCount: distanceBarCount, distance })\n    this._offsetRightBarCount = this._preOffsetRightBarCount - distanceBarCount\n    this.adjustFromTo()\n    const cross = crosshair || this._chartStore.crosshairStore().get()\n    this._chartStore.crosshairStore().set(cross, true)\n    this._chartStore.invalidate()\n  }\n\n  /**\n   * 根据索引获取数据\n   * @param dataIndex\n   */\n  getDataByDataIndex (dataIndex) {\n    return this._chartStore.dataList()[dataIndex]\n  }\n\n  /**\n   * x转换成浮点数的位置\n   * @param x\n   * @returns {number}\n   */\n  coordinateToFloatIndex (x) {\n    const dataSize = this._chartStore.dataList().length\n    const deltaFromRight = (this._totalDataSpace - x) / this._dataSpace\n    const index = dataSize + this._offsetRightBarCount - deltaFromRight\n    return Math.round(index * 1000000) / 1000000\n  }\n\n  /**\n   * 数据索引转换成时间戳\n   * @param dataIndex\n   * @return {*}\n   */\n  dataIndexToTimestamp (dataIndex) {\n    const data = this.getDataByDataIndex(dataIndex)\n    if (data) {\n      return data.timestamp\n    }\n  }\n\n  /**\n   * 将时间戳转换成数据索引位置\n   * @param timestamp\n   * @return {number}\n   */\n  timestampToDataIndex (timestamp) {\n    if (this._chartStore.dataList().length === 0) {\n      return 0\n    }\n    return binarySearchNearest(this._chartStore.dataList(), 'timestamp', timestamp)\n  }\n\n  /**\n   * 数据索引转换成坐标\n   * @param dataIndex\n   */\n  dataIndexToCoordinate (dataIndex) {\n    const dataSize = this._chartStore.dataList().length\n    const deltaFromRight = dataSize + this._offsetRightBarCount - dataIndex\n    return this._totalDataSpace - (deltaFromRight - 0.5) * this._dataSpace\n  }\n\n  /**\n   * 坐标换成数据索引转\n   * @param pixel\n   */\n  coordinateToDataIndex (pixel) {\n    return Math.ceil(this.coordinateToFloatIndex(pixel)) - 1\n  }\n\n  /**\n   * 缩放\n   * @param scale\n   * @param coordinate\n   */\n  zoom (scale, coordinate) {\n    if (!this._zoomEnabled) {\n      return\n    }\n    if (!coordinate || !isValid(coordinate.x)) {\n      const crosshair = this._chartStore.crosshairStore().get()\n      coordinate = { x: isValid(crosshair.x) ? crosshair.x : this._totalDataSpace / 2 }\n    }\n    this._chartStore.actionStore().execute(ActionType.ZOOM, { coordinate, scale })\n    const floatIndex = this.coordinateToFloatIndex(coordinate.x)\n    const dataSpace = this._dataSpace + scale * (this._dataSpace / 10)\n    this.setDataSpace(dataSpace, () => {\n      this._offsetRightBarCount += (floatIndex - this.coordinateToFloatIndex(coordinate.x))\n    })\n  }\n\n  /**\n   * 设置是否可以缩放\n   * @param enabled\n   */\n  setZoomEnabled (enabled) {\n    this._zoomEnabled = enabled\n  }\n\n  /**\n   * 获取是否可以缩放\n   * @return {boolean}\n   */\n  zoomEnabled () {\n    return this._zoomEnabled\n  }\n\n  /**\n   * 设置是否可以拖拽滚动\n   * @param enabled\n   */\n  setScrollEnabled (enabled) {\n    this._scrollEnabled = enabled\n  }\n\n  /**\n   * 获取是否可以拖拽滚动\n   * @return {boolean}\n   */\n  scrollEnabled () {\n    return this._scrollEnabled\n  }\n\n  /**\n   * 设置加载更多\n   * @param callback\n   */\n  setLoadMoreCallback (callback) {\n    this._loadMoreCallback = callback\n  }\n\n  /**\n   * 清除数据\n   */\n  clear () {\n    this._more = true\n    this._loading = true\n    this._from = 0\n    this._to = 0\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { clone, isArray, isBoolean, isNumber, merge, isObject, isFunction, isValid } from '../../utils/typeChecks'\n\n/**\n * 绘制类型\n * @type {{BAR: string, LINE: string, CIRCLE: string}}\n */\nexport const TechnicalIndicatorPlotType = {\n  LINE: 'line',\n  BAR: 'bar',\n  CIRCLE: 'circle'\n}\n\n/**\n * 系列\n */\nexport const TechnicalIndicatorSeries = {\n  PRICE: 'price',\n  VOLUME: 'volume',\n  NORMAL: 'normal'\n}\n\n/**\n * 获取指标配置项样式\n * @param kLineDataList\n * @param techDataList\n * @param dataIndex\n * @param plot\n * @param techStyles\n * @param defaultStyle\n * @returns\n */\nexport function getTechnicalIndicatorPlotStyle (\n  kLineDataList, techDataList, dataIndex, plot, techStyles, defaultStyle\n) {\n  let color = defaultStyle.color\n  let isStroke = defaultStyle.isStroke\n  const cbData = {\n    prev: { kLineData: kLineDataList[dataIndex - 1], technicalIndicatorData: techDataList[dataIndex - 1] },\n    current: { kLineData: kLineDataList[dataIndex], technicalIndicatorData: techDataList[dataIndex] },\n    next: { kLineData: kLineDataList[dataIndex + 1], technicalIndicatorData: techDataList[dataIndex + 1] }\n  }\n  if (isValid(plot.color)) {\n    if (isFunction(plot.color)) {\n      color = plot.color(cbData, techStyles) || defaultStyle.color\n    } else {\n      color = plot.color || defaultStyle.color\n    }\n  }\n  if (isValid(plot.isStroke)) {\n    if (isFunction(plot.isStroke)) {\n      isStroke = plot.isStroke(cbData)\n    } else {\n      isStroke = plot.isStroke\n    }\n  }\n  return { color, isStroke }\n}\n\nexport default class TechnicalIndicator {\n  constructor ({\n    name, shortName, series, calcParams, plots, precision,\n    shouldCheckParamCount, shouldOhlc, shouldFormatBigNumber,\n    minValue, maxValue, styles\n  }) {\n    // 指标名\n    this.name = name || ''\n    // 指标简短名称，用于显示\n    this.shortName = shortName || name || ''\n    // 系列\n    this.series = Object.values(TechnicalIndicatorSeries).indexOf(series) !== -1 ? series : TechnicalIndicatorSeries.NORMAL\n    // 精度\n    this.precision = isNumber(precision) && precision >= 0 ? precision : 4\n    // 精度设置标识\n    this._precisionFlag = false\n    // 计算参数\n    this.calcParams = isArray(calcParams) ? calcParams : []\n    // 数据信息\n    this.plots = isArray(plots) ? plots : []\n    // 是否需要检查参数\n    this.shouldCheckParamCount = isBoolean(shouldCheckParamCount) ? shouldCheckParamCount : true\n    // 是否需要ohlc\n    this.shouldOhlc = isBoolean(shouldOhlc) ? shouldOhlc : false\n    // 是否需要格式化大数据值，从1000开始格式化，比如100000是否需要格式化100K\n    this.shouldFormatBigNumber = isBoolean(shouldFormatBigNumber) ? shouldFormatBigNumber : false\n    // 指定的最小值\n    this.minValue = minValue\n    // 指定的最大值\n    this.maxValue = maxValue\n    // 样式\n    this.styles = styles\n    // 结果\n    this.result = []\n  }\n\n  _createParams (calcParams) {\n    return calcParams.map(param => {\n      if (isObject(param)) {\n        return param.value\n      }\n      return param\n    })\n  }\n\n  /**\n   * 设置简短名称\n   * @param shortName\n   * @returns\n   */\n  setShortName (shortName) {\n    if (this.shortName !== shortName) {\n      this.shortName = shortName\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 设置精度\n   * @param precision\n   * @param flag\n   * @returns\n   */\n  setPrecision (precision, flag) {\n    if (isNumber(precision) && precision >= 0 && (!flag || (flag && !this._precisionFlag))) {\n      this.precision = parseInt(precision, 10)\n      if (!flag) {\n        this._precisionFlag = true\n      }\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 设置计算参数\n   * @param params\n   * @returns\n   */\n  setCalcParams (params) {\n    if (!isArray(params)) {\n      return false\n    }\n    if (this.shouldCheckParamCount && params.length !== this.calcParams.length) {\n      return false\n    }\n    const calcParams = []\n    for (let i = 0; i < params.length; i++) {\n      const param = params[i]\n      let v\n      let allowDecimal\n      if (isObject(param)) {\n        v = param.value\n        allowDecimal = param.allowDecimal\n      } else {\n        v = param\n        allowDecimal = false\n      }\n      const oldParam = this.calcParams[i]\n      if (isObject(oldParam) && isBoolean(oldParam.allowDecimal)) {\n        allowDecimal = oldParam.allowDecimal\n      }\n      if (\n        !isNumber(v) ||\n        v <= 0 ||\n        (!allowDecimal && parseInt(v, 10) !== v)\n      ) {\n        return false\n      }\n      calcParams.push({ allowDecimal, value: v })\n    }\n    this.calcParams = calcParams\n    const plots = this.regeneratePlots(this._createParams(calcParams))\n    if (plots && isArray(plots)) {\n      this.plots = plots\n    }\n    return true\n  }\n\n  setShouldOhlc (shouldOhlc) {\n    if (isBoolean(shouldOhlc) && this.shouldOhlc !== shouldOhlc) {\n      this.shouldOhlc = shouldOhlc\n      return true\n    }\n    return false\n  }\n\n  setShouldFormatBigNumber (shouldFormatBigNumber) {\n    if (isBoolean(shouldFormatBigNumber) && this.shouldFormatBigNumber !== shouldFormatBigNumber) {\n      this.shouldFormatBigNumber = shouldFormatBigNumber\n      return true\n    }\n    return false\n  }\n\n  setStyles (styles, defaultStyles) {\n    if (!isObject(styles)) {\n      return false\n    }\n    if (!this.styles) {\n      this.styles = {\n        margin: clone(defaultStyles.margin),\n        bar: clone(defaultStyles.bar),\n        line: clone(defaultStyles.line),\n        circle: clone(defaultStyles.circle)\n      }\n    }\n    merge(this.styles, styles)\n    return true\n  }\n\n  /**\n   * 计算\n   * @param dataList\n   * @return {*}\n   */\n  calc (dataList) {\n    this.result = this.calcTechnicalIndicator(dataList, {\n      params: this._createParams(this.calcParams),\n      plots: this.plots\n    }) || []\n  }\n\n  /**\n   * 计算技术指标\n   */\n  calcTechnicalIndicator (dataList, options) {}\n\n  /**\n   * 重新生成各项数据\n   * @param params\n   */\n  regeneratePlots (params) {}\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport extension from './extension'\n\nimport { isFunction, isValid } from '../utils/typeChecks'\nimport { logWarn } from '../utils/logger'\n\nimport TechnicalIndicator, { TechnicalIndicatorSeries } from '../component/technicalindicator/TechnicalIndicator'\n\nexport default class TechnicalIndicatorStore {\n  constructor (chartStore) {\n    this._chartStore = chartStore\n    // 指标模板\n    this._templates = this._createTemplates()\n    this._instances = new Map()\n  }\n\n  /**\n   * 获取指标信息\n   * @param tech\n   * @return {{ calcParams, series, precision, name, shortName, shouldCheckParamCount, shouldOhlc, shouldFormatBigNumber, styles }}\n   */\n  _createTechInfo (tech) {\n    return {\n      name: tech.name,\n      shortName: tech.shortName,\n      series: tech.series,\n      calcParams: tech.calcParams,\n      shouldCheckParamCount: tech.shouldCheckParamCount,\n      shouldOhlc: tech.shouldOhlc,\n      shouldFormatBigNumber: tech.shouldFormatBigNumber,\n      precision: tech.precision,\n      styles: tech.styles,\n      plots: tech.plots,\n      result: tech.result || []\n    }\n  }\n\n  /**\n   * 创建技术指标模板\n   * @return {{}}\n   */\n  _createTemplates () {\n    const mapping = {}\n    const extensions = extension.technicalIndicatorExtensions\n    for (const name in extensions) {\n      const templateInstance = this._createTemplateInstance(extensions[name])\n      if (templateInstance) {\n        mapping[name] = templateInstance\n      }\n    }\n    return mapping\n  }\n\n  /**\n   * 创建一个新的技术指标\n   * @param name\n   * @param shortName\n   * @param series\n   * @param calcParams\n   * @param plots\n   * @param precision\n   * @param shouldCheckParamCount\n   * @param shouldOhlc\n   * @param shouldFormatBigNumber\n   * @param minValue\n   * @param maxValue\n   * @param styles\n   * @param calcTechnicalIndicator\n   * @param regeneratePlots\n   * @param render\n   * @returns {templateInstance|null}\n   */\n  _createTemplateInstance ({\n    name, shortName, series, calcParams, plots, precision,\n    shouldCheckParamCount, shouldOhlc, shouldFormatBigNumber,\n    minValue, maxValue, styles,\n    calcTechnicalIndicator, regeneratePlots, render\n  }) {\n    if (!name || !isFunction(calcTechnicalIndicator)) {\n      logWarn('', '', 'The required attribute \"name\" and method \"calcTechnicalIndicator\" are missing, and new technical indicator cannot be generated!!!')\n      return null\n    }\n    class Template extends TechnicalIndicator {\n      constructor () {\n        super(\n          {\n            name,\n            shortName,\n            series,\n            calcParams,\n            plots,\n            precision,\n            shouldCheckParamCount,\n            shouldOhlc,\n            shouldFormatBigNumber,\n            minValue,\n            maxValue,\n            styles\n          }\n        )\n      }\n    }\n    Template.prototype.calcTechnicalIndicator = calcTechnicalIndicator\n    if (isFunction(regeneratePlots)) {\n      Template.prototype.regeneratePlots = regeneratePlots\n    }\n    if (isFunction(render)) {\n      Template.prototype.render = render\n    }\n    return new Template()\n  }\n\n  /**\n   * 添加指标模板\n   * @param templates\n   */\n  addTemplate (templates) {\n    templates.forEach(tmp => {\n      const instance = this._createTemplateInstance(tmp || {})\n      if (instance) {\n        // 将生成的新的指标类放入集合\n        this._templates[instance.name] = instance\n      }\n    })\n  }\n\n  /**\n   * 模板是否存在\n   * @param {*} name\n   * @returns\n   */\n  hasTemplate (name) {\n    return !!this._templates[name]\n  }\n\n  /**\n   * 获取技术指标模板信息\n   * @param name\n   * @return {{}|{calcParams: *, precision: *, name: *}}\n   */\n  getTemplateInfo (name) {\n    if (isValid(name)) {\n      const template = this._templates[name]\n      if (template) {\n        return this._createTechInfo(template)\n      }\n    } else {\n      const templateInfos = {}\n      for (const name in this._templates) {\n        const template = this._templates[name]\n        templateInfos[name] = this._createTechInfo(template)\n      }\n      return templateInfos\n    }\n    return {}\n  }\n\n  /**\n   * 添加技术指标实例\n   * @param paneId\n   * @param tech\n   * @param isStack\n   * @returns\n   */\n  addInstance (paneId, tech, isStack) {\n    if (tech) {\n      const { name, calcParams, precision, shouldOhlc, shouldFormatBigNumber, styles } = tech\n      let paneInstances = this._instances.get(paneId)\n      if (paneInstances && paneInstances.has(name)) {\n        return false\n      }\n      if (!paneInstances) {\n        paneInstances = new Map()\n        this._instances.set(paneId, paneInstances)\n      }\n      const template = this._templates[name]\n      let instance\n      if (template) {\n        instance = Object.create(Object.getPrototypeOf(template))\n        for (const key in template) {\n          if (Object.prototype.hasOwnProperty.call(template, key)) {\n            instance[key] = template[key]\n          }\n        }\n      }\n      if (instance) {\n        instance.setCalcParams(calcParams)\n        instance.setPrecision(precision)\n        instance.setShouldOhlc(shouldOhlc)\n        instance.setShouldFormatBigNumber(shouldFormatBigNumber)\n        instance.setStyles(styles, this._chartStore.styleOptions().technicalIndicator)\n        if (!isStack) {\n          paneInstances.clear()\n        }\n        paneInstances.set(name, instance)\n        instance.calc(this._chartStore.dataList())\n        return true\n      }\n    }\n    return false\n  }\n\n  /**\n   * 获取实例\n   * @param {*} paneId\n   * @returns\n   */\n  instances (paneId) {\n    return this._instances.get(paneId) || new Map()\n  }\n\n  /**\n   * 移除技术指标\n   * @param paneId\n   * @param name\n   * @return {boolean}\n   */\n  removeInstance (paneId, name) {\n    let removed = false\n    if (this._instances.has(paneId)) {\n      const paneInstances = this._instances.get(paneId)\n      if (isValid(name)) {\n        if (paneInstances.has(name)) {\n          paneInstances.delete(name)\n          removed = true\n        }\n      } else {\n        paneInstances.clear()\n        removed = true\n      }\n      if (paneInstances.size === 0) {\n        this._instances.delete(paneId)\n      }\n    }\n    return removed\n  }\n\n  /**\n   * 是否有实例\n   * @param paneId\n   * @returns\n   */\n  hasInstance (paneId) {\n    return this._instances.has(paneId)\n  }\n\n  /**\n   * 实例计算\n   * @param paneId\n   * @param name\n   */\n  calcInstance (name, paneId) {\n    if (isValid(name)) {\n      if (isValid(paneId)) {\n        const paneInstances = this._instances.get(paneId)\n        if (paneInstances && paneInstances.has(name)) {\n          paneInstances.get(name).calc(this._chartStore.dataList())\n        }\n      } else {\n        this._instances.forEach(paneInstances => {\n          if (paneInstances.has(name)) {\n            paneInstances.get(name).calc(this._chartStore.dataList())\n          }\n        })\n      }\n    } else {\n      this._instances.forEach(paneInstances => {\n        paneInstances.forEach(instance => {\n          instance.calc(this._chartStore.dataList())\n        })\n      })\n    }\n  }\n\n  /**\n   * 获取实例信息\n   * @param paneId\n   * @param name\n   * @returns\n   */\n  getInstanceInfo (paneId, name) {\n    const info = (paneInstances) => {\n      const instanceInfos = []\n      for (const entry of paneInstances) {\n        const instance = entry[1]\n        if (instance) {\n          const instanceInfo = this._createTechInfo(instance)\n          if (instance.name === name) {\n            return instanceInfo\n          }\n          instanceInfos.push(instanceInfo)\n        }\n      }\n      return instanceInfos\n    }\n\n    if (isValid(paneId)) {\n      if (this._instances.has(paneId)) {\n        return info(this._instances.get(paneId))\n      }\n    } else {\n      const infos = {}\n      this._instances.forEach((paneInstance, paneId) => {\n        infos[paneId] = info(paneInstance)\n      })\n      return infos\n    }\n    return {}\n  }\n\n  /**\n   * 设置系列精度\n   * @param pricePrecision\n   * @param volumePrecision\n   */\n  setSeriesPrecision (pricePrecision, volumePrecision) {\n    const setPrecision = (tech) => {\n      if (tech.series === TechnicalIndicatorSeries.PRICE) {\n        tech.setPrecision(pricePrecision, true)\n      }\n      if (tech.series === TechnicalIndicatorSeries.VOLUME) {\n        tech.setPrecision(volumePrecision, true)\n      }\n    }\n    for (const key in this._templates) {\n      setPrecision(this._templates[key])\n    }\n    this._instances.forEach(paneInstances => {\n      paneInstances.forEach(instance => {\n        setPrecision(instance)\n      })\n    })\n  }\n\n  /**\n   * 覆盖\n   * @param techOverride\n   * @param paneId\n   * @returns\n   */\n  override (techOverride, paneId) {\n    const { name, shortName, calcParams, precision, shouldOhlc, shouldFormatBigNumber, styles } = techOverride\n    const defaultTechStyleOptions = this._chartStore.styleOptions().technicalIndicator\n    let instances = new Map()\n    if (isValid(paneId)) {\n      if (this._instances.has(paneId)) {\n        instances.set(paneId, this._instances.get(paneId))\n      }\n    } else {\n      instances = this._instances\n      const template = this._templates[name]\n      if (template) {\n        template.setCalcParams(calcParams)\n        template.setShortName(shortName)\n        template.setPrecision(precision)\n        template.setShouldOhlc(shouldOhlc)\n        template.setShouldFormatBigNumber(shouldFormatBigNumber)\n        template.setStyles(styles, defaultTechStyleOptions)\n      }\n    }\n    let overiderSuccss = false\n    const tasks = []\n    instances.forEach(paneInstances => {\n      if (paneInstances.has(name)) {\n        const tech = paneInstances.get(name)\n        const shortNameSuccess = tech.setShortName(shortName)\n        const calcParamsSuccess = tech.setCalcParams(calcParams)\n        const precisionSuccess = tech.setPrecision(precision)\n        const shouldOhlcSuccess = tech.setShouldOhlc(shouldOhlc)\n        const shouldFormatBigNumberSuccess = tech.setShouldFormatBigNumber(shouldFormatBigNumber)\n        const styleSuccess = tech.setStyles(styles, defaultTechStyleOptions)\n        if (shortNameSuccess || calcParamsSuccess || precisionSuccess || shouldOhlcSuccess || shouldFormatBigNumberSuccess || styleSuccess) {\n          overiderSuccss = true\n        }\n        if (calcParamsSuccess) {\n          tasks.push(\n            Promise.resolve(tech.calc(this._chartStore.dataList()))\n          )\n        }\n      }\n    })\n    if (overiderSuccss) {\n      return Promise.all(tasks)\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isFunction, isObject, clone, merge } from '../../utils/typeChecks'\n\n/**\n * 完善覆盖物实例\n * @param overlay 覆盖物实例\n * @param options 参数\n */\nexport function perfectOverlayFunc (overlay, funcs) {\n  funcs.forEach(({ key, fn }) => {\n    if (isFunction(fn)) {\n      overlay[key] = fn\n    }\n  })\n}\n\n/**\n * 覆盖物\n */\nexport default class Overlay {\n  constructor ({\n    id, chartStore, xAxis, yAxis\n  }) {\n    this._id = id\n    this._chartStore = chartStore\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._styles = null\n  }\n\n  /**\n   * 绘制\n   * @param ctx\n   */\n  draw (ctx) {}\n\n  /**\n   * 设置样式\n   * @param styles\n   * @param defaultStyles\n   */\n  setStyles (styles, defaultStyles) {\n    if (!isObject(styles)) {\n      return false\n    }\n    if (!this._styles) {\n      this._styles = clone(defaultStyles)\n    }\n    merge(this._styles, styles)\n    return true\n  }\n\n  /**\n   * 获取id\n   * @return {*}\n   */\n  id () {\n    return this._id\n  }\n\n  /**\n   * 获取样式\n   * @return {null}\n   */\n  styles () {\n    return this._styles\n  }\n\n  /**\n   * 设置y轴\n   * @param yAxis\n   */\n  setYAxis (yAxis) {\n    if (yAxis) {\n      this._yAxis = yAxis\n    }\n  }\n\n  /**\n   * 检查鼠标点是否在图形上\n   * @param coordinate\n   */\n  checkEventCoordinateOn (coordinate) {}\n\n  // -------------------- 事件开始 -------------------\n\n  /**\n   * 点击事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onClick ({ id, points, event }) {}\n\n  /**\n   * 右击事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onRightClick ({ id, points, event }) {}\n\n  /**\n   * 鼠标进入事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onMouseEnter ({ id, points, event }) {}\n\n  /**\n   * 鼠标离开事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onMouseLeave ({ id, points, event }) {}\n\n  // -------------------- 事件结束 -------------------\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制边框圆\n * @param ctx\n * @param borderColor\n * @param borderSize\n * @param circleCoordinate\n * @param radius\n */\nexport function renderStrokeCircle (ctx, borderColor, borderSize, circleCoordinate, radius) {\n  ctx.lineWidth = borderSize\n  ctx.strokeStyle = borderColor\n  ctx.beginPath()\n  ctx.arc(circleCoordinate.x, circleCoordinate.y, radius, 0, Math.PI * 2)\n  ctx.closePath()\n  ctx.stroke()\n}\n\n/**\n * 绘制实心圆\n * @param ctx\n * @param fillColor\n * @param circleCoordinate\n * @param radius\n */\nexport function renderFillCircle (ctx, fillColor, circleCoordinate, radius) {\n  ctx.fillStyle = fillColor\n  ctx.beginPath()\n  ctx.arc(circleCoordinate.x, circleCoordinate.y, radius, 0, Math.PI * 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const DEVIATION = 2\n\n/**\n * 获取两点之间的距离\n * @param coordinate\n * @param coordinate2\n * @return {number}\n */\nexport function getDistance (coordinate1, coordinate2) {\n  const xDif = coordinate1.x - coordinate2.x\n  const yDif = coordinate1.y - coordinate2.y\n  return Math.sqrt(xDif * xDif + yDif * yDif)\n}\n\n/**\n * 根据三角形三个点获取三角形面积\n * @param coordinate1\n * @param coordinate2\n * @param coordinate3\n * @return {number}\n */\nexport function getTriangleSquare (coordinate1, coordinate2, coordinate3) {\n  const x1 = Math.abs(coordinate2.x - coordinate1.x)\n  const y1 = Math.abs(coordinate2.y - coordinate1.y)\n  const x2 = Math.abs(coordinate3.x - coordinate1.x)\n  const y2 = Math.abs(coordinate3.y - coordinate1.y)\n  return Math.abs(x1 * y2 - x2 * y1) / 2\n}\n\n/**\n * 获取一点绕另一点旋转一定角度后新的点坐标\n * @param coordinate 旋转点\n * @param targetCoordinate 参照点\n * @param angle 角度\n * @return {{x: *, y: *}}\n */\nexport function getRotateCoordinate (coordinate, targetCoordinate, angle) {\n  const x = (coordinate.x - targetCoordinate.x) * Math.cos(angle) - (coordinate.y - targetCoordinate.y) * Math.sin(angle) + targetCoordinate.x\n  const y = (coordinate.x - targetCoordinate.x) * Math.sin(angle) + (coordinate.y - targetCoordinate.y) * Math.cos(angle) + targetCoordinate.y\n  return { x, y }\n}\n\n/**\n * 获取一次函数斜率和截距，即 y = kx + b 中的k值和b值\n * @param coordinate1\n * @param coordinate2\n */\nexport function getLinearSlopeIntercept (coordinate1, coordinate2) {\n  const difX = (coordinate1.x - coordinate2.x)\n  if (difX !== 0) {\n    const k = (coordinate1.y - coordinate2.y) / difX\n    const b = coordinate1.y - k * coordinate1.x\n    return { k, b }\n  }\n}\n\n/**\n * 获取点在两点决定的一次函数上的y值\n * @param coordinate1\n * @param coordinate2\n * @param targetCoordinate\n */\nexport function getLinearYFromCoordinates (coordinate1, coordinate2, targetCoordinate) {\n  const kb = getLinearSlopeIntercept(coordinate1, coordinate2)\n  return getLinearYFromSlopeIntercept(kb, targetCoordinate)\n}\n\n/**\n * 获取点在斜率和截距确定的线上的y值\n * @param kb\n * @param targetCoordinate\n */\nexport function getLinearYFromSlopeIntercept (kb, targetCoordinate) {\n  if (kb) {\n    return targetCoordinate.x * kb.k + kb.b\n  }\n  return targetCoordinate.y\n}\n\n/**\n * 点是否在线上\n * @param coordinate1\n * @param coordinate2\n * @param targetCoordinate\n */\nexport function checkCoordinateOnStraightLine (coordinate1, coordinate2, targetCoordinate) {\n  if (!targetCoordinate || !coordinate1 || !coordinate2) {\n    return false\n  }\n  if (coordinate1.x === coordinate2.x) {\n    return Math.abs(targetCoordinate.x - coordinate1.x) < DEVIATION\n  }\n  const kb = getLinearSlopeIntercept(coordinate1, coordinate2)\n  const y = getLinearYFromSlopeIntercept(kb, targetCoordinate)\n  const yDif = Math.abs(y - targetCoordinate.y)\n  return yDif * yDif / (kb.k * kb.k + 1) < DEVIATION * DEVIATION\n}\n\n/**\n * 点是否在线段上\n * @param coordinate1\n * @param coordinate2\n * @param targetCoordinate\n * @returns {boolean}\n */\nexport function checkCoordinateOnRayLine (coordinate1, coordinate2, targetCoordinate) {\n  if (checkCoordinateOnStraightLine(coordinate1, coordinate2, targetCoordinate)) {\n    if (coordinate1.x === coordinate2.x) {\n      if (coordinate1.y < coordinate2.y) {\n        return coordinate1.y - targetCoordinate.y < DEVIATION\n      } else {\n        return targetCoordinate.y - coordinate1.y < DEVIATION\n      }\n    }\n    if (coordinate1.x < coordinate2.x) {\n      return coordinate1.x - targetCoordinate.x < DEVIATION\n    } else {\n      return targetCoordinate.x - coordinate1.x < DEVIATION\n    }\n  }\n  return false\n}\n\n/**\n * 判断点是否在线段上面\n * @param coordinate1\n * @param coordinate2\n * @param targetCoordinate\n */\nexport function checkCoordinateOnSegment (coordinate1, coordinate2, targetCoordinate) {\n  if (checkCoordinateOnStraightLine(coordinate1, coordinate2, targetCoordinate)) {\n    if (coordinate1.x === coordinate2.x) {\n      return Math.abs(coordinate1.y - targetCoordinate.y) + Math.abs(coordinate2.y - targetCoordinate.y) - Math.abs(coordinate1.y - coordinate2.y) < DEVIATION * 2\n    }\n    return Math.abs(coordinate1.x - targetCoordinate.x) + Math.abs(coordinate2.x - targetCoordinate.x) - Math.abs(coordinate1.x - coordinate2.x) < DEVIATION * 2\n  }\n  return false\n}\n\n/**\n * 点是否在圆内\n * @param circleCenterCoordinate\n * @param radius\n * @param targetCoordinate\n * @returns {boolean}\n */\nexport function checkCoordinateInCircle (circleCenterCoordinate, radius, targetCoordinate) {\n  if (!targetCoordinate) {\n    return false\n  }\n  const difX = targetCoordinate.x - circleCenterCoordinate.x\n  const difY = targetCoordinate.y - circleCenterCoordinate.y\n  return !(difX * difX + difY * difY > radius * radius)\n}\n\n/**\n * 点是否在圆上\n * @param circleCenterCoordinate\n * @param radius\n * @param targetCoordinate\n * @return {boolean}\n */\nexport function checkCoordinateOnCircle (circleCenterCoordinate, radius, targetCoordinate) {\n  if (!targetCoordinate) {\n    return false\n  }\n  return Math.abs(getDistance(targetCoordinate, circleCenterCoordinate) - radius) < DEVIATION\n}\n\n/**\n * 检查点是否在圆弧上\n * @param circleCenterCoordinate\n * @param radius\n * @param startAngle\n * @param endAngle\n * @param targetCoordinate\n * @return {boolean}\n */\nexport function checkCoordinateOnArc (circleCenterCoordinate, radius, startAngle, endAngle, targetCoordinate) {\n  if (checkCoordinateOnCircle(circleCenterCoordinate, radius, targetCoordinate)) {\n    const startCoordinateX = radius * Math.cos(startAngle) + circleCenterCoordinate.x\n    const startCoordinateY = radius * Math.sin(startAngle) + circleCenterCoordinate.y\n    const endCoordinateX = radius * Math.cos(endAngle) + circleCenterCoordinate.x\n    const endCoordinateY = radius * Math.sin(endAngle) + circleCenterCoordinate.y\n    return (\n      targetCoordinate.x <= Math.max(startCoordinateX, endCoordinateX) + DEVIATION &&\n      targetCoordinate.x >= Math.min(startCoordinateX, endCoordinateX) - DEVIATION &&\n      targetCoordinate.y <= Math.max(startCoordinateY, endCoordinateY) + DEVIATION &&\n      targetCoordinate.y >= Math.min(startCoordinateY, endCoordinateY) - DEVIATION\n    )\n  }\n}\n\n/**\n * 检查点是否在三角形内部\n * @param triangleCoordinates\n * @param targetCoordinate\n * @return {boolean}\n */\nexport function checkCoordinateInTriangle (triangleCoordinates, targetCoordinate) {\n  const square = getTriangleSquare(triangleCoordinates[0], triangleCoordinates[1], triangleCoordinates[2])\n  const compareSquare =\n    getTriangleSquare(triangleCoordinates[0], triangleCoordinates[1], targetCoordinate) +\n    getTriangleSquare(triangleCoordinates[0], triangleCoordinates[2], targetCoordinate) +\n    getTriangleSquare(triangleCoordinates[1], triangleCoordinates[2], targetCoordinate)\n  return Math.abs(square - compareSquare) < DEVIATION\n}\n\n/**\n * 检查点是否在三角形菱形内部\n * @param centerCoordinate\n * @param width\n * @param height\n * @param targetCoordinate\n * @return {boolean}\n */\nexport function checkCoordinateInDiamond (centerCoordinate, width, height, targetCoordinate) {\n  const xDis = Math.abs(centerCoordinate.x - targetCoordinate.x)\n  const yDis = Math.abs(centerCoordinate.y - targetCoordinate.y)\n  return xDis * height + yDis * width < width * height / 2 + DEVIATION\n}\n\n/**\n * 检查点是否在矩形内部\n * @param coordinate1\n * @param coordinate2\n * @param targetCoordinate\n * @return {boolean}\n */\nexport function checkCoordinateInRect (coordinate1, coordinate2, targetCoordinate) {\n  return targetCoordinate.x >= coordinate1.x && targetCoordinate.x <= coordinate2.x && targetCoordinate.y >= coordinate1.y && targetCoordinate.y <= coordinate2.y\n}\n\n/**\n * 根据两点获取一条射线\n * @param coordinate1\n * @param coordinate2\n * @param xyMax\n * @return {(*|{x: *, y: *})[]|*[]}\n */\nexport function getRayLine (coordinate1, coordinate2, xyMax) {\n  if (coordinate1 && coordinate2) {\n    let coordinate\n    if (coordinate1.x === coordinate2.x && coordinate1.y !== coordinate2.y) {\n      if (coordinate1.y < coordinate2.y) {\n        coordinate = {\n          x: coordinate1.x,\n          y: xyMax.y\n        }\n      } else {\n        coordinate = {\n          x: coordinate1.x,\n          y: 0\n        }\n      }\n    } else if (coordinate1.x > coordinate2.x) {\n      coordinate = {\n        x: 0,\n        y: getLinearYFromCoordinates(coordinate1, coordinate2, { x: 0, y: coordinate1.y })\n      }\n    } else {\n      coordinate = {\n        x: xyMax.x,\n        y: getLinearYFromCoordinates(coordinate1, coordinate2, { x: xyMax.x, y: coordinate1.y })\n      }\n    }\n    return [coordinate1, coordinate]\n  }\n  return []\n}\n\n/**\n * 获取平行线\n * @param coordinates\n * @param xyMax\n * @param extendParallelLineCount\n * @returns {Array}\n */\nexport function getParallelLines (coordinates, xyMax, extendParallelLineCount = 0) {\n  const lines = []\n  if (coordinates.length > 1) {\n    if (coordinates[0].x === coordinates[1].x) {\n      const startY = 0\n      const endY = xyMax.y\n      lines.push([{ x: coordinates[0].x, y: startY }, { x: coordinates[0].x, y: endY }])\n      if (coordinates.length > 2) {\n        lines.push([{ x: coordinates[2].x, y: startY }, { x: coordinates[2].x, y: endY }])\n        const distance = coordinates[0].x - coordinates[2].x\n        for (let i = 0; i < extendParallelLineCount; i++) {\n          const d = distance * (i + 1)\n          lines.push([{ x: coordinates[0].x + d, y: startY }, { x: coordinates[0].x + d, y: endY }])\n        }\n      }\n    } else {\n      const startX = 0\n      const endX = xyMax.x\n      const kb = getLinearSlopeIntercept(coordinates[0], coordinates[1])\n      const k = kb.k\n      const b = kb.b\n      lines.push([{ x: startX, y: startX * k + b }, { x: endX, y: endX * k + b }])\n      if (coordinates.length > 2) {\n        const b1 = coordinates[2].y - k * coordinates[2].x\n        lines.push([{ x: startX, y: startX * k + b1 }, { x: endX, y: endX * k + b1 }])\n        const distance = b - b1\n        for (let i = 0; i < extendParallelLineCount; i++) {\n          const b2 = b + distance * (i + 1)\n          lines.push([{ x: startX, y: startX * k + b2 }, { x: endX, y: endX * k + b2 }])\n        }\n      }\n    }\n  }\n  return lines\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制路径\n * @param ctx\n * @param coordinates\n * @param strokeFill\n */\nfunction renderPath (ctx, coordinates, strokeFill) {\n  ctx.save()\n  if (ctx.lineWidth % 2) {\n    ctx.translate(0.5, 0.5)\n  }\n  ctx.beginPath()\n  let move = true\n  coordinates.forEach(coordinate => {\n    if (coordinate) {\n      if (move) {\n        ctx.moveTo(coordinate.x, coordinate.y)\n        move = false\n      } else {\n        ctx.lineTo(coordinate.x, coordinate.y)\n      }\n    }\n  })\n  strokeFill()\n  ctx.restore()\n}\n\n/**\n * 渲染边框路径\n * @param ctx\n * @param coordinates\n */\nexport function renderStrokePath (ctx, coordinates) {\n  renderPath(ctx, coordinates, () => {\n    ctx.stroke()\n    ctx.closePath()\n  })\n}\n\n/**\n * 渲染填充路径\n * @param ctx\n * @param coordinates\n */\nexport function renderFillPath (ctx, coordinates) {\n  renderPath(ctx, coordinates, () => {\n    ctx.closePath()\n    ctx.fill()\n  })\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { renderStrokePath } from './path'\n\n/**\n * 绘制水平直线\n * @param ctx\n * @param y\n * @param left\n * @param right\n */\nexport function renderHorizontalLine (ctx, y, left, right) {\n  ctx.beginPath()\n  const correction = (ctx.lineWidth % 2) ? 0.5 : 0\n  ctx.moveTo(left, y + correction)\n  ctx.lineTo(right, y + correction)\n  ctx.stroke()\n  ctx.closePath()\n}\n\n/**\n * 绘制垂直直线\n * @param ctx\n * @param x\n * @param top\n * @param bottom\n */\nexport function renderVerticalLine (ctx, x, top, bottom) {\n  ctx.beginPath()\n  const correction = (ctx.lineWidth % 2) ? 0.5 : 0\n  ctx.moveTo(x + correction, top)\n  ctx.lineTo(x + correction, bottom)\n  ctx.stroke()\n  ctx.closePath()\n}\n\n/**\n * 绘制线\n * @param ctx\n * @param coordinates\n */\nexport function renderLine (ctx, coordinates) {\n  renderStrokePath(ctx, coordinates)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 获取屏幕比\n * @param canvas\n * @returns {number}\n */\nexport function getPixelRatio (canvas) {\n  return (canvas.ownerDocument && canvas.ownerDocument.defaultView && canvas.ownerDocument.defaultView.devicePixelRatio) || 2\n}\n\n/**\n * 测量文字的宽度\n * @param ctx\n * @param text\n * @returns {number}\n */\nexport function calcTextWidth (ctx, text) {\n  return Math.round(ctx.measureText(text).width)\n}\n\n/**\n * 创建字体\n * @param fontSize\n * @param fontFamily\n * @param fontWeight\n * @returns {string}\n */\nexport function createFont (fontSize = 12, fontWeight = 'normal', fontFamily = 'Helvetica Neue') {\n  return `${fontWeight} ${fontSize}px ${fontFamily}`\n}\n\n/**\n * 获取文字框宽度\n * @param ctx\n * @param text\n * @param options\n * @returns {number}\n */\nexport function getTextRectWidth (ctx, text, options) {\n  ctx.font = createFont(options.size, options.weight, options.family)\n  const textWidth = calcTextWidth(ctx, text)\n  return options.paddingLeft + options.paddingRight + textWidth + (options.borderSize || 0) * 2\n}\n\n/**\n * 获取文字框高度\n * @param options\n * @returns {number}\n */\nexport function getTextRectHeight (options) {\n  return options.paddingTop + options.paddingBottom + options.size + (options.borderSize || 0) * 2\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from './Overlay'\n\nimport { renderFillCircle } from '../../renderer/circle'\nimport { checkCoordinateInCircle } from '../../extension/shape/shapeHelper'\nimport { renderHorizontalLine, renderLine, renderVerticalLine } from '../../renderer/line'\nimport { renderStrokePath, renderFillPath } from '../../renderer/path'\nimport { isArray, isValid, clone } from '../../utils/typeChecks'\nimport { createFont } from '../../utils/canvas'\n\nimport { StrokeFillStyle, LineStyle } from '../../options/styleOptions'\n\n// 标记图形绘制步骤开始\nconst SHAPE_DRAW_STEP_START = 1\n\n// 标记图形绘制步骤结束\nconst SHAPE_DRAW_STEP_FINISHED = -1\n\n/**\n * 图形标记鼠标操作元素类型\n * @type {{OTHER: string, POINT: string, NONE: string}}\n */\nexport const ShapeMouseOperateElement = {\n  OTHER: 'other',\n  POINT: 'point',\n  NONE: 'none'\n}\n\n/**\n * 绘制类型\n * @type {{ARC: string, POLYGON: string, LINE: string, CONTINUOUS_LINE: string, TEXT: string}}\n */\nconst ShapeElementType = {\n  LINE: 'line',\n  TEXT: 'text',\n  CONTINUOUS_LINE: 'continuous_line',\n  POLYGON: 'polygon',\n  ARC: 'arc'\n}\n\n/**\n * 线类型\n * @type {{VERTICAL: number, COMMON: number, HORIZONTAL: number}}\n */\nconst LineType = {\n  COMMON: 0,\n  HORIZONTAL: 1,\n  VERTICAL: 2\n}\n\n/**\n * 图形模式\n */\nconst ShapeMode = {\n  NORMAL: 'normal',\n  WEAK_MAGNET: 'weak_magnet',\n  STRONG_MAGNET: 'strong_magnet'\n}\n\n/**\n * 获取绘制线类型\n * @param coordinate1\n * @param coordinate2\n * @private\n */\nfunction getLineType (coordinate1, coordinate2) {\n  if (coordinate1.x === coordinate2.x) {\n    return LineType.VERTICAL\n  }\n  if (coordinate1.y === coordinate2.y) {\n    return LineType.HORIZONTAL\n  }\n  return LineType.COMMON\n}\n\n/**\n * 标记图形\n */\nexport default class Shape extends Overlay {\n  constructor ({\n    id, name, totalStep,\n    chartStore, xAxis, yAxis,\n    points, styles, lock, data\n  }) {\n    super({ id, chartStore, xAxis, yAxis })\n    this._name = name\n    this._totalStep = totalStep\n    this._lock = lock\n    this._mode = ShapeMode.NORMAL\n    this._data = data\n    this._drawStep = SHAPE_DRAW_STEP_START\n    this._points = []\n    this.setPoints(points)\n    this.setStyles(styles, chartStore.styleOptions().shape)\n    this._prevPressPoint = null\n    this._prevPoints = null\n    this._coordinates = []\n  }\n\n  /**\n   * 加载点\n   * @param points\n   */\n  setPoints (points) {\n    if (isArray(points) && points.length > 0) {\n      let repeatTotalStep\n      if (points.length >= this._totalStep - 1) {\n        this._drawStep = SHAPE_DRAW_STEP_FINISHED\n        this._points = points.slice(0, this._totalStep - 1)\n        repeatTotalStep = this._totalStep - 1\n      } else {\n        this._drawStep = points.length + 1\n        this._points = clone(points)\n        repeatTotalStep = points.length\n      }\n      // 重新演练绘制一遍，防止因为点不对而绘制出错误的图形\n      for (let i = 0; i < repeatTotalStep; i++) {\n        this.performEventMoveForDrawing({\n          step: i + 2,\n          mode: this._mode,\n          points: this._points,\n          movePoint: this._points[i],\n          xAxis: this._xAxis,\n          yAxis: this._yAxis\n        })\n      }\n      if (this._drawStep === SHAPE_DRAW_STEP_FINISHED) {\n        this.performEventPressedMove({\n          mode: this._mode,\n          points: this._points,\n          pressPointIndex: this._points.length - 1,\n          pressPoint: this._points[this._points.length - 1],\n          xAxis: this._xAxis,\n          yAxis: this._yAxis\n        })\n      }\n    }\n  }\n\n  /**\n   * 时间戳转换成x轴上点的位置\n   * @param point\n   * @return {*|number}\n   * @private\n   */\n  _timestampOrDataIndexToCoordinateX ({ timestamp, dataIndex }) {\n    if (timestamp) {\n      dataIndex = this._chartStore.timeScaleStore().timestampToDataIndex(timestamp)\n    }\n    return this._xAxis.convertToPixel(dataIndex)\n  }\n\n  /**\n   * 绘制线\n   * @param ctx\n   * @param lines\n   * @param styles\n   * @param defaultStyles\n   * @private\n   */\n  _drawLines (ctx, lines, styles, defaultStyles) {\n    ctx.save()\n    ctx.strokeStyle = styles.color || defaultStyles.color\n    ctx.lineWidth = styles.size || defaultStyles.size\n    if (styles.style === LineStyle.DASH) {\n      ctx.setLineDash(styles.dashValue || defaultStyles.dashValue)\n    }\n    lines.forEach(coordinates => {\n      if (coordinates.length > 1) {\n        const lineType = getLineType(coordinates[0], coordinates[1])\n        switch (lineType) {\n          case LineType.COMMON: {\n            renderLine(ctx, coordinates)\n            break\n          }\n          case LineType.HORIZONTAL: {\n            renderHorizontalLine(ctx, coordinates[0].y, coordinates[0].x, coordinates[1].x)\n            break\n          }\n          case LineType.VERTICAL: {\n            renderVerticalLine(ctx, coordinates[0].x, coordinates[0].y, coordinates[1].y)\n            break\n          }\n          default: { break }\n        }\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制连续线\n   * @param ctx\n   * @param continuousLines\n   * @param styles\n   * @param styles\n   * @private\n   */\n  _drawContinuousLines (ctx, continuousLines, styles, defaultStyles) {\n    ctx.save()\n    ctx.strokeStyle = styles.color || defaultStyles.color\n    ctx.lineWidth = styles.size || defaultStyles.size\n    if (styles.style === LineStyle.DASH) {\n      ctx.setLineDash(styles.dashValue || defaultStyles.dashValue)\n    }\n    continuousLines.forEach(coordinates => {\n      if (coordinates.length > 0) {\n        renderLine(ctx, coordinates)\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制多边形\n   * @param ctx\n   * @param polygons\n   * @param styles\n   * @param defaultStyles\n   * @private\n   */\n  _drawPolygons (ctx, polygons, styles, defaultStyles) {\n    ctx.save()\n    let strokeFill\n    if (styles.style === StrokeFillStyle.FILL) {\n      ctx.fillStyle = (styles.fill || defaultStyles.fill).color\n      strokeFill = renderFillPath\n    } else {\n      const strokeStyles = styles.stroke || defaultStyles.stroke\n      if (strokeStyles.style === LineStyle.DASH) {\n        ctx.setLineDash(strokeStyles.dashValue)\n      }\n      ctx.lineWidth = strokeStyles.size\n      ctx.strokeStyle = strokeStyles.color\n      strokeFill = renderStrokePath\n    }\n    polygons.forEach(coordinates => {\n      if (coordinates.length > 0) {\n        strokeFill(ctx, coordinates)\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 画圆弧\n   * @param ctx\n   * @param arcs\n   * @param styles\n   * @param defaultStyles\n   * @private\n   */\n  _drawArcs (ctx, arcs, styles, defaultStyles) {\n    ctx.save()\n    if (styles.style === StrokeFillStyle.FILL) {\n      ctx.fillStyle = (styles.fill || defaultStyles.fill).color\n    } else {\n      const strokeStyles = styles.stroke || defaultStyles.stroke\n      if (strokeStyles.style === LineStyle.DASH) {\n        ctx.setLineDash(strokeStyles.dashValue)\n      }\n      ctx.lineWidth = strokeStyles.size\n      ctx.strokeStyle = strokeStyles.color\n    }\n    arcs.forEach(({ x, y, radius, startAngle, endAngle }) => {\n      ctx.beginPath()\n      ctx.arc(x, y, radius, startAngle, endAngle)\n      if (styles.style === StrokeFillStyle.FILL) {\n        ctx.closePath()\n        ctx.fill()\n      } else {\n        ctx.stroke()\n        ctx.closePath()\n      }\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制文字\n   * @param ctx\n   * @param texts\n   * @param styles\n   * @param defaultStyles\n   * @private\n   */\n  _drawText (ctx, texts, styles, defaultStyles) {\n    ctx.save()\n    let fillStroke\n    if (styles.style === StrokeFillStyle.STROKE) {\n      ctx.strokeStyle = styles.color || defaultStyles.color\n      fillStroke = ctx.strokeText\n    } else {\n      ctx.fillStyle = styles.color || defaultStyles.color\n      fillStroke = ctx.fillText\n    }\n    ctx.font = createFont(\n      styles.size || defaultStyles.size,\n      styles.family || defaultStyles.family,\n      styles.weight || defaultStyles.weight\n    )\n    const offset = styles.offset || defaultStyles.offset || [0, 0]\n    texts.forEach(({ x, y, text }) => {\n      fillStroke.call(\n        ctx,\n        text,\n        x + offset[1],\n        y + offset[0]\n      )\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制\n   * @param ctx\n   */\n  draw (ctx) {\n    this._coordinates = this._points.map(({ timestamp, value, dataIndex }) => {\n      return {\n        x: this._timestampOrDataIndexToCoordinateX({ timestamp, dataIndex }),\n        y: this._yAxis.convertToPixel(value)\n      }\n    })\n    const shapeOptions = this._styles || this._chartStore.styleOptions().shape\n    if (this._drawStep !== SHAPE_DRAW_STEP_START && this._coordinates.length > 0) {\n      const viewport = { width: this._xAxis.width(), height: this._yAxis.height() }\n      const precision = { price: this._chartStore.pricePrecision(), volume: this._chartStore.volumePrecision() }\n      this._shapeDataSources = this.createShapeDataSource({\n        step: this._drawStep,\n        mode: this._mode,\n        points: this._points,\n        coordinates: this._coordinates,\n        viewport: { width: this._xAxis.width(), height: this._yAxis.height() },\n        precision: { price: this._chartStore.pricePrecision(), volume: this._chartStore.volumePrecision() },\n        styles: shapeOptions,\n        xAxis: this._xAxis,\n        yAxis: this._yAxis,\n        data: this._data\n      }) || []\n      this._shapeDataSources.forEach(({ type, isDraw, styles, dataSource = [] }) => {\n        if (isDraw) {\n          switch (type) {\n            case ShapeElementType.LINE: {\n              this._drawLines(ctx, dataSource, styles || shapeOptions.line, shapeOptions.line)\n              break\n            }\n            case ShapeElementType.CONTINUOUS_LINE: {\n              this._drawContinuousLines(ctx, dataSource, styles || shapeOptions.line, shapeOptions.line)\n              break\n            }\n            case ShapeElementType.POLYGON: {\n              this._drawPolygons(ctx, dataSource, styles || shapeOptions.polygon, shapeOptions.polygon)\n              break\n            }\n            case ShapeElementType.ARC: {\n              this._drawArcs(ctx, dataSource, styles || shapeOptions.arc, shapeOptions.arc)\n              break\n            }\n            case ShapeElementType.TEXT: {\n              this._drawText(ctx, dataSource, styles || shapeOptions.text, shapeOptions.text)\n              break\n            }\n            default: { break }\n          }\n        }\n      })\n      if (this.drawExtend) {\n        ctx.save()\n        this.drawExtend({\n          ctx,\n          dataSource: this._shapeDataSources,\n          styles: shapeOptions,\n          viewport,\n          precision,\n          mode: this._mode,\n          xAxis: this._xAxis,\n          yAxis: this._yAxis,\n          data: this._data\n        })\n        ctx.restore()\n      }\n    }\n    const shapeMouseOperate = this._chartStore.shapeStore().mouseOperate()\n    if (\n      (shapeMouseOperate.hover.id === this._id && shapeMouseOperate.hover.element !== ShapeMouseOperateElement.NONE) ||\n      (shapeMouseOperate.click.id === this._id && shapeMouseOperate.click.element !== ShapeMouseOperateElement.NONE) ||\n      this.isDrawing()\n    ) {\n      this._coordinates.forEach(({ x, y }, index) => {\n        let radius = shapeOptions.point.radius\n        let color = shapeOptions.point.backgroundColor\n        let borderColor = shapeOptions.point.borderColor\n        let borderSize = shapeOptions.point.borderSize\n        if (\n          shapeMouseOperate.hover.id === this._id &&\n          shapeMouseOperate.hover.element === ShapeMouseOperateElement.POINT &&\n          index === shapeMouseOperate.hover.elementIndex\n        ) {\n          radius = shapeOptions.point.activeRadius\n          color = shapeOptions.point.activeBackgroundColor\n          borderColor = shapeOptions.point.activeBorderColor\n          borderSize = shapeOptions.point.activeBorderSize\n        }\n        renderFillCircle(ctx, borderColor, { x, y }, radius + borderSize)\n        renderFillCircle(ctx, color, { x, y }, radius)\n      })\n    }\n  }\n\n  /**\n   * 设置是否锁定\n   * @param lock\n   */\n  setLock (lock) {\n    this._lock = lock\n  }\n\n  /**\n   * 获取名字\n   * @return {*}\n   */\n  name () {\n    return this._name\n  }\n\n  /**\n   * 是否锁定\n   * @return {*}\n   */\n  lock () {\n    return this._lock\n  }\n\n  /**\n   * 总步骤数\n   * @return {*}\n   */\n  totalStep () {\n    return this._totalStep\n  }\n\n  /**\n   * 获取模式类型\n   * @returns\n   */\n  mode () {\n    return this._mode\n  }\n\n  /**\n   * 设置模式\n   * @param mode\n   */\n  setMode (mode) {\n    if (Object.values(ShapeMode).indexOf > -1) {\n      this._mode = mode\n    }\n  }\n\n  /**\n   * 设置数据\n   * @param data\n   */\n  setData (data) {\n    if (data !== this._data) {\n      this._data = data\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 获取数据\n   * @returns\n   */\n  data () {\n    return this._data\n  }\n\n  /**\n   * 获取点\n   * @return {[]}\n   */\n  points () {\n    return this._points\n  }\n\n  /**\n   * 是否在绘制中\n   * @return {boolean}\n   */\n  isDrawing () {\n    return this._drawStep !== SHAPE_DRAW_STEP_FINISHED\n  }\n\n  /**\n   * 是否开始\n   * @returns\n   */\n  isStart () {\n    return this._drawStep === SHAPE_DRAW_STEP_START\n  }\n\n  /**\n   * 检查鼠标点是否在图形上\n   * @param mouseCoordinate\n   * @return {{id: *, elementIndex: number, element: string}}\n   */\n  checkEventCoordinateOn (eventCoordinate) {\n    const shapeOptions = this._styles || this._chartStore.styleOptions().shape\n    // 检查鼠标点是否在图形的点上\n    const start = this._coordinates.length - 1\n    for (let i = start; i > -1; i--) {\n      if (checkCoordinateInCircle(this._coordinates[i], shapeOptions.point.radius, eventCoordinate)) {\n        return {\n          id: this._id,\n          element: ShapeMouseOperateElement.POINT,\n          elementIndex: i,\n          instance: this\n        }\n      }\n    }\n    // 检查鼠标点是否在点构成的其它图形上\n    if (this._shapeDataSources) {\n      for (const { key, type, isCheck, dataSource = [] } of this._shapeDataSources) {\n        if (isCheck) {\n          for (let i = 0; i < dataSource.length; i++) {\n            const sources = dataSource[i]\n            if (this.checkEventCoordinateOnShape({ key, type, dataSource: sources, eventCoordinate })) {\n              return {\n                id: this._id,\n                element: ShapeMouseOperateElement.OTHER,\n                elementIndex: i,\n                instance: this\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * 不同的模式下处理值\n   * @param value\n   * @param dataIndex\n   * @param paneId\n   */\n  _performValue (y, dataIndex, paneId) {\n    const value = this._yAxis.convertFromPixel(y)\n    if (this._mode === ShapeMode.NORMAL || paneId !== 'candle_pane') {\n      return value\n    }\n    const kLineData = this._chartStore.timeScaleStore().getDataByDataIndex(dataIndex)\n    if (!kLineData) {\n      return value\n    }\n    if (value > kLineData.high) {\n      if (this._mode === ShapeMode.WEAK_MAGNET) {\n        const highY = this._yAxis.convertToPixel(kLineData.high)\n        const buffValue = this._yAxis.convertFromPixel(highY - 8)\n        if (value < buffValue) {\n          return kLineData.high\n        }\n        return value\n      }\n      return kLineData.high\n    }\n    if (value < kLineData.low) {\n      if (this._mode === ShapeMode.WEAK_MAGNET) {\n        const lowY = this._yAxis.convertToPixel(kLineData.low)\n        const buffValue = this._yAxis.convertFromPixel(lowY - 8)\n        if (value > buffValue) {\n          return kLineData.low\n        }\n        return value\n      }\n      return kLineData.low\n    }\n    const max = Math.max(kLineData.open, kLineData.close)\n    if (value > max) {\n      if (value - max < kLineData.high - value) {\n        return max\n      }\n      return kLineData.high\n    }\n    const min = Math.min(kLineData.open, kLineData.close)\n    if (value < min) {\n      if (value - kLineData.low < min - value) {\n        return kLineData.low\n      }\n      return min\n    }\n    if (max - value < value - min) {\n      return max\n    }\n    return min\n  }\n\n  /**\n   * 绘制过程中鼠标移动事件\n   * @param coordinate\n   * @param event\n   */\n  mouseMoveForDrawing (coordinate, event) {\n    const dataIndex = this._xAxis.convertFromPixel(coordinate.x)\n    const timestamp = this._chartStore.timeScaleStore().dataIndexToTimestamp(dataIndex)\n    const value = this._performValue(coordinate.y, dataIndex, event.paneId)\n    this._points[this._drawStep - 1] = { timestamp, value, dataIndex }\n    this.performEventMoveForDrawing({\n      step: this._drawStep,\n      mode: this._mode,\n      points: this._points,\n      movePoint: { timestamp, value, dataIndex },\n      xAxis: this._xAxis,\n      yAxis: this._yAxis\n    })\n    this.onDrawing({ id: this._id, step: this._drawStep, points: this._points })\n  }\n\n  /**\n   * 鼠标左边按钮点击事件\n   */\n  mouseLeftButtonDownForDrawing () {\n    if (this._drawStep === this._totalStep - 1) {\n      this._drawStep = SHAPE_DRAW_STEP_FINISHED\n      this._chartStore.shapeStore().progressInstanceComplete()\n      this.onDrawEnd({ id: this._id, points: this._points })\n    } else {\n      this._drawStep++\n    }\n  }\n\n  /**\n   * 鼠标按住移动方法\n   * @param coordinate\n   * @param event\n   */\n  mousePressedPointMove (coordinate, event) {\n    const shapeMouseOperate = this._chartStore.shapeStore().mouseOperate()\n    const elementIndex = shapeMouseOperate.click.elementIndex\n    if (\n      !this._lock &&\n      shapeMouseOperate.click.id === this._id &&\n      shapeMouseOperate.click.element === ShapeMouseOperateElement.POINT &&\n      elementIndex !== -1\n    ) {\n      const dataIndex = this._xAxis.convertFromPixel(coordinate.x)\n      const timestamp = this._chartStore.timeScaleStore().dataIndexToTimestamp(dataIndex)\n      const value = this._performValue(coordinate.y, dataIndex, event.paneId)\n      this._points[elementIndex].timestamp = timestamp\n      this._points[elementIndex].dataIndex = dataIndex\n      this._points[elementIndex].value = value\n      this.performEventPressedMove({\n        points: this._points,\n        mode: this._mode,\n        pressPointIndex: elementIndex,\n        pressPoint: { dataIndex, timestamp, value },\n        xAxis: this._xAxis,\n        yAxis: this._yAxis\n      })\n      this.onPressedMove({\n        id: this._id,\n        element: ShapeMouseOperateElement.POINT,\n        points: this._points,\n        event\n      })\n    }\n  }\n\n  /**\n   * 按住非点拖动开始事件\n   * @param coordinate\n   */\n  startPressedOtherMove (coordinate) {\n    const dataIndex = this._xAxis.convertFromPixel(coordinate.x)\n    const value = this._yAxis.convertFromPixel(coordinate.y)\n    this._prevPressPoint = { dataIndex, value }\n    this._prevPoints = clone(this._points)\n  }\n\n  /**\n   * 按住非点拖动时事件\n   * @param coordinate\n   */\n  mousePressedOtherMove (coordinate, event) {\n    if (this._prevPressPoint) {\n      const dataIndex = this._xAxis.convertFromPixel(coordinate.x)\n      const value = this._yAxis.convertFromPixel(coordinate.y)\n      const difDataIndex = dataIndex - this._prevPressPoint.dataIndex\n      const difValue = value - this._prevPressPoint.value\n      this._points = this._prevPoints.map(point => {\n        // 防止因为创建时传入进来的point没有dataIndex，导致无法计算时间戳问题\n        if (!isValid(point.dataIndex)) {\n          point.dataIndex = this._chartStore.timeScaleStore().timestampToDataIndex(point.timestamp)\n        }\n        const dataIndex = point.dataIndex + difDataIndex\n        const value = point.value + difValue\n        return {\n          dataIndex,\n          value,\n          timestamp: this._chartStore.timeScaleStore().dataIndexToTimestamp(dataIndex)\n        }\n      })\n      this.onPressedMove({\n        id: this._id,\n        element: ShapeMouseOperateElement.OTHER,\n        points: this._points,\n        event\n      })\n    }\n  }\n\n  // -------------------- 事件开始 -------------------\n\n  /**\n   * 开始绘制事件回调\n   * @param id\n   */\n  onDrawStart ({ id }) {}\n\n  /**\n   * 绘制过程中事件回调\n   * @param id\n   * @param step\n   * @param points\n   */\n  onDrawing ({ id, step, points }) {}\n\n  /**\n   * 绘制结束事件回调\n   * @param id\n   * @param points\n   */\n  onDrawEnd ({ id, points }) {}\n\n  /**\n   * 按住移动事件\n   * @param id\n   * @param points\n   * @param event\n   */\n  onPressedMove ({ id, points, event }) {}\n\n  /**\n   * 移除事件回调\n   * @param id\n   */\n  onRemove ({ id }) {}\n\n  // -------------------- 事件结束 -------------------\n\n  // --------------------- 自定义时需要实现的一些方法开始 ----------------------\n\n  /**\n   * 检查事件坐标是否在图形上\n   * @param key\n   * @param type\n   * @param points\n   * @param mousePoint\n   */\n  checkEventCoordinateOnShape ({ key, type, dataSource, eventCoordinate }) {}\n\n  /**\n   * 创建图形配置\n   * @param step\n   * @param points\n   * @param coordinates\n   * @param viewport\n   * @param precision\n   * @param xAxis\n   * @param yAxis\n   */\n  createShapeDataSource ({ step, mode, points, coordinates, viewport, precision, styles, xAxis, yAxis, data }) {}\n\n  /**\n   * 处理绘制过程中鼠标移动\n   * @param step\n   * @param mode\n   * @param points\n   * @param point\n   * @param xAxis\n   * @param yAxis\n   */\n  performEventMoveForDrawing ({ step, mode, points, movePoint, xAxis, yAxis }) {}\n\n  /**\n   * 处理鼠标按住移动\n   * @param mode\n   * @param points\n   * @param pressPointIndex\n   * @param point\n   * @param xAxis\n   * @param yAxis\n   */\n  performEventPressedMove ({ mode, points, pressPointIndex, pressPoint, xAxis, yAxis }) {}\n\n  // --------------------- 自定义时需要实现的一些方法结束 ----------------------\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 刷新层级\n * @type {{OVERLAY: number, MAIN: number, NONE: number, FULL: number}}\n */\nconst InvalidateLevel = {\n  NONE: 0,\n  OVERLAY: 1,\n  MAIN: 2,\n  FULL: 3\n}\n\nexport default InvalidateLevel\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport extension from './extension'\n\nimport { isNumber, isFunction, isValid } from '../utils/typeChecks'\nimport { logWarn } from '../utils/logger'\n\nimport Shape, { ShapeMouseOperateElement } from '../component/overlay/Shape'\n\nimport InvalidateLevel from '../enum/InvalidateLevel'\n\nexport default class ShapeStore {\n  constructor (chartStore) {\n    this._chartStore = chartStore\n    // 图形标记映射\n    this._templates = this._createTemplates()\n    // 图形标记鼠标操作信息\n    this._mouseOperate = {\n      click: {\n        id: '',\n        element: ShapeMouseOperateElement.NONE,\n        elementIndex: -1\n      },\n      hover: {\n        id: '',\n        element: ShapeMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    }\n    // 进行中的实例\n    this._progressInstance = null\n    // 事件按住的示例\n    this._pressedInstance = null\n    // 图形实例\n    this._instances = new Map()\n  }\n\n  /**\n   * 创建模板\n   * @returns\n   */\n  _createTemplates () {\n    const templates = {}\n    const extensions = extension.shapeExtensions\n    for (const name in extensions) {\n      const TemplateClass = this._createTemplateClass(extensions[name])\n      if (TemplateClass) {\n        templates[name] = TemplateClass\n      }\n    }\n    return templates\n  }\n\n  /**\n   * 创建模板类\n   * @param name\n   * @param totalStep\n   * @param checkEventCoordinateOnShape\n   * @param createShapeDataSource\n   * @param performEventPressedMove\n   * @param performEventMoveForDrawing\n   * @param drawExtend\n   * @return\n   */\n  _createTemplateClass ({\n    name, totalStep,\n    checkEventCoordinateOnShape,\n    createShapeDataSource,\n    performEventPressedMove,\n    performEventMoveForDrawing,\n    drawExtend\n  }) {\n    if (\n      !name ||\n      !isNumber(totalStep) ||\n      !isFunction(checkEventCoordinateOnShape) ||\n      !isFunction(createShapeDataSource)\n    ) {\n      logWarn('', '', 'Required attribute \"name\" and \"totalStep\", method \"checkEventCoordinateOnShape\" and \"createShapeDataSource\", new shape cannot be generated!!!')\n      return null\n    }\n    class Template extends Shape {\n      constructor ({\n        id, chartStore, xAxis, yAxis, points, styles, lock, data\n      }) {\n        super({\n          id, name, totalStep, chartStore, xAxis, yAxis, points, styles, lock, data\n        })\n      }\n    }\n    Template.prototype.checkEventCoordinateOnShape = checkEventCoordinateOnShape\n    Template.prototype.createShapeDataSource = createShapeDataSource\n    if (isFunction(performEventPressedMove)) {\n      Template.prototype.performEventPressedMove = performEventPressedMove\n    }\n    if (isFunction(performEventMoveForDrawing)) {\n      Template.prototype.performEventMoveForDrawing = performEventMoveForDrawing\n    }\n    if (isFunction(drawExtend)) {\n      Template.prototype.drawExtend = drawExtend\n    }\n    return Template\n  }\n\n  /**\n   * 添加自定义标记图形\n   * @param templates\n   */\n  addTemplate (templates) {\n    templates.forEach(tmp => {\n      const Template = this._createTemplateClass(tmp)\n      if (Template) {\n        this._templates[tmp.name] = Template\n      }\n    })\n  }\n\n  /**\n   * 获取图形标记模板类\n   * @param name\n   * @return {*}\n   */\n  getTemplate (name) {\n    return this._templates[name]\n  }\n\n  /**\n   * 获取实例\n   * @param shapeId\n   * @returns\n   */\n  getInstance (shapeId) {\n    for (const entry of this._instances) {\n      const shape = (entry[1] || []).find(s => s.id() === shapeId)\n      if (shape) {\n        return shape\n      }\n    }\n    return null\n  }\n\n  /**\n   * 是否有实例\n   * @param shapeId\n   * @returns\n   */\n  hasInstance (shapeId) {\n    return !!this.getInstance(shapeId)\n  }\n\n  /**\n   * 添加标记实例\n   * @param instance\n   * @param paneId\n   */\n  addInstance (instance, paneId) {\n    if (instance.isDrawing()) {\n      this._progressInstance = { paneId, instance, fixed: isValid(paneId) }\n    } else {\n      if (!this._instances.has(paneId)) {\n        this._instances.set(paneId, [])\n      }\n      this._instances.get(paneId).push(instance)\n    }\n    this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n  }\n\n  /**\n   * 获取进行中的实例\n   * @returns\n   */\n  progressInstance () {\n    return this._progressInstance || {}\n  }\n\n  /**\n   * 进行中的实例完成\n   */\n  progressInstanceComplete () {\n    const { instance, paneId } = this.progressInstance()\n    if (instance && !instance.isDrawing()) {\n      if (!this._instances.has(paneId)) {\n        this._instances.set(paneId, [])\n      }\n      this._instances.get(paneId).push(instance)\n      this._progressInstance = null\n    }\n  }\n\n  /**\n   * 更新进行中的实例\n   * @param yAxis\n   * @param paneId\n   */\n  updateProgressInstance (yAxis, paneId) {\n    const { instance, fixed } = this.progressInstance()\n    if (instance && !fixed) {\n      instance.setYAxis(yAxis)\n      this._progressInstance.paneId = paneId\n    }\n  }\n\n  /**\n   * 获取按住的实例\n   * @returns\n   */\n  pressedInstance () {\n    return this._pressedInstance || {}\n  }\n\n  /**\n   * 更新事件按住的实例\n   * @param instance\n   * @param paneId\n   * @param element\n   */\n  updatePressedInstance (instance, paneId, element) {\n    if (instance) {\n      this._pressedInstance = { instance, paneId, element }\n    } else {\n      this._pressedInstance = null\n    }\n  }\n\n  /**\n   * 获取图形标记的数据\n   * @param paneId\n   * @returns {{}}\n   */\n  instances (paneId) {\n    return this._instances.get(paneId) || []\n  }\n\n  /**\n   * 设置图形标记实例配置\n   * @param options\n   */\n  setInstanceOptions (options = {}) {\n    const { id, styles, lock, mode, data } = options\n    const defaultStyles = this._chartStore.styleOptions().shape\n    let shouldInvalidate = false\n    if (isValid(id)) {\n      const instance = this.getInstance(id)\n      if (instance) {\n        instance.setLock(lock)\n        instance.setMode(mode)\n        if (instance.setStyles(styles, defaultStyles) || instance.setData(data)) {\n          shouldInvalidate = true\n        }\n      }\n    } else {\n      this._instances.forEach(shapes => {\n        shapes.forEach(instance => {\n          instance.setLock(lock)\n          instance.setMode(mode)\n          if (instance.setStyles(styles, defaultStyles) || instance.setData(data)) {\n            shouldInvalidate = true\n          }\n        })\n      })\n    }\n    if (shouldInvalidate) {\n      this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 获取图形标记信息\n   * @param id\n   * @return {{name, lock: *, styles, id, points: (*|*[])}[]|{name, lock: *, styles, id, points: (*|*[])}}\n   */\n  getInstanceInfo (shapeId) {\n    const create = (instance) => {\n      return {\n        name: instance.name(),\n        id: instance.id(),\n        totalStep: instance.totalStep(),\n        lock: instance.lock(),\n        mode: instance.mode(),\n        points: instance.points(),\n        styles: instance.styles(),\n        data: instance.data()\n      }\n    }\n    const progressInstance = this.progressInstance()\n    if (isValid(shapeId)) {\n      if (progressInstance.instance && progressInstance.instance.id() === shapeId) {\n        return create(progressInstance.instance)\n      }\n      const shape = this.getInstance(shapeId)\n      if (shape) {\n        return create(shape)\n      }\n    } else {\n      const infos = {}\n      this._instances.forEach((shapes, paneId) => {\n        infos[paneId] = shapes.map(shape => create(shape))\n        if (progressInstance.paneId === paneId && progressInstance.instance) {\n          infos[paneId].push(create(progressInstance.instance))\n        }\n      })\n      return infos\n    }\n    return null\n  }\n\n  /**\n   * 移除图形实例\n   * @param shapeId 参数\n   * @param isProgress\n   */\n  removeInstance (shapeId) {\n    let shouldInvalidate = false\n    const progressInstance = this.progressInstance().instance\n    if (progressInstance && (!isValid(shapeId) || progressInstance.id() === shapeId)) {\n      progressInstance.onRemove({ id: progressInstance.id() })\n      this._progressInstance = null\n      shouldInvalidate = true\n    }\n    if (isValid(shapeId)) {\n      for (const entry of this._instances) {\n        const shapes = entry[1] || []\n        const removeIndex = shapes.findIndex(shape => shape.id() === shapeId)\n        if (removeIndex > -1) {\n          shapes[removeIndex].onRemove({ id: shapes[removeIndex].id() })\n          shapes.splice(removeIndex, 1)\n          if (shapes.length === 0) {\n            this._instances.delete(entry[0])\n          }\n          shouldInvalidate = true\n          break\n        }\n      }\n    } else {\n      this._instances.forEach(shapes => {\n        if (shapes.length > 0) {\n          shapes.forEach(shape => {\n            shape.onRemove({ id: shape.id() })\n          })\n        }\n      })\n      this._instances.clear()\n      shouldInvalidate = true\n    }\n    if (shouldInvalidate) {\n      this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 获取图形标记鼠标操作信息\n   * @return {{hover: {id: string, elementIndex: number, element: string}, click: {id: string, elementIndex: number, element: string}}}\n   */\n  mouseOperate () {\n    return this._mouseOperate\n  }\n\n  /**\n   * 设置鼠标操作信息\n   * @param mouseOperate\n   * @return\n   */\n  setMouseOperate (mouseOperate) {\n    const { hover, click } = this._mouseOperate\n    if (mouseOperate.hover &&\n      (hover.id !== mouseOperate.hover.id || hover.element !== mouseOperate.hover.element || hover.elementIndex !== mouseOperate.hover.elementIndex)\n    ) {\n      this._mouseOperate.hover = { ...mouseOperate.hover }\n    }\n    if (mouseOperate.click &&\n      (click.id !== mouseOperate.click.id || click.element !== mouseOperate.click.element || click.elementIndex !== mouseOperate.click.elementIndex)\n    ) {\n      this._mouseOperate.click = { ...mouseOperate.click }\n    }\n  }\n\n  /**\n   * 是否为空\n   * @returns\n   */\n  isEmpty () {\n    return this._instances.size === 0 && !this.progressInstance().instance\n  }\n\n  /**\n   * 是否正在绘制\n   * @return\n   */\n  isDrawing () {\n    const instance = this.progressInstance().instance\n    return instance && instance.isDrawing()\n  }\n\n  /**\n   * 是否按住\n   * @returns\n   */\n  isPressed () {\n    return !!this.pressedInstance().instance\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isValid } from '../utils/typeChecks'\n\nimport InvalidateLevel from '../enum/InvalidateLevel'\n\nexport default class AnnotationStore {\n  constructor (chartStore) {\n    this._chartStore = chartStore\n    // 注解标记\n    this._annotations = new Map()\n    // 注解标记\n    this._visibleAnnotations = new Map()\n    // 注解鼠标操作信息\n    this._mouseOperate = { id: '' }\n  }\n\n  /**\n   * 获取注解鼠标操作信息\n   * @return {null}\n   */\n  mouseOperate () {\n    return this._mouseOperate\n  }\n\n  /**\n   * 设置鼠标操作\n   * @param operate\n   */\n  setMouseOperate (operate) {\n    const { id } = this._mouseOperate\n    if (operate && id !== operate.id) {\n      this._mouseOperate = { ...operate }\n    }\n  }\n\n  /**\n   * 创建可见的注解数据\n   */\n  createVisibleAnnotations () {\n    this._visibleAnnotations.clear()\n    if (this._annotations.size > 0) {\n      this._chartStore.visibleDataList().forEach(({ data, x }) => {\n        this._annotations.forEach((annotations, paneId) => {\n          if (annotations.size > 0) {\n            const annotation = annotations.get(data.timestamp) || []\n            if (annotation.length > 0) {\n              for (const an of annotation) {\n                an.createSymbolCoordinate(x)\n                if (this._visibleAnnotations.has(paneId)) {\n                  this._visibleAnnotations.get(paneId).push(an)\n                } else {\n                  this._visibleAnnotations.set(paneId, [an])\n                }\n              }\n            }\n          }\n        })\n      })\n    }\n  }\n\n  /**\n   * 创建注解\n   * @param annotations\n   * @param paneId\n   */\n  add (annotations, paneId) {\n    if (!this._annotations.has(paneId)) {\n      this._annotations.set(paneId, new Map())\n    }\n    annotations.forEach(annotation => {\n      const idAnnotations = this._annotations.get(paneId)\n      if (idAnnotations.has(annotation.id())) {\n        idAnnotations.get(annotation.id()).push(annotation)\n      } else {\n        idAnnotations.set(annotation.id(), [annotation])\n      }\n    })\n    this.createVisibleAnnotations()\n    this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n  }\n\n  /**\n   * 获取注解\n   * @param paneId\n   * @returns\n   */\n  get (paneId) {\n    return this._visibleAnnotations.get(paneId)\n  }\n\n  /**\n   * 移除注解\n   * @param paneId\n   * @param point\n   */\n  remove (paneId, point) {\n    let shouldAdjust = false\n    if (isValid(paneId)) {\n      if (this._annotations.has(paneId)) {\n        if (isValid(point)) {\n          const paneAnnotations = this._annotations.get(paneId)\n          const points = [].concat(point)\n          points.forEach(({ timestamp }) => {\n            if (paneAnnotations.has(timestamp)) {\n              shouldAdjust = true\n              paneAnnotations.delete(timestamp)\n            }\n          })\n          if (paneAnnotations.size === 0) {\n            this._annotations.delete(paneId)\n          }\n          if (shouldAdjust) {\n            this.createVisibleAnnotations()\n          }\n        } else {\n          shouldAdjust = true\n          this._annotations.delete(paneId)\n          this._visibleAnnotations.delete(paneId)\n        }\n      }\n    } else {\n      shouldAdjust = true\n      this._annotations.clear()\n      this._visibleAnnotations.clear()\n    }\n    if (shouldAdjust) {\n      this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 是否为空\n   * @returns\n   */\n  isEmpty () {\n    return this._visibleAnnotations.size === 0\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isValid } from '../utils/typeChecks'\n\nimport InvalidateLevel from '../enum/InvalidateLevel'\n\nexport default class TagStore {\n  constructor (chartStore) {\n    // 刷新回调\n    this._chartStore = chartStore\n    // 标签\n    this._tags = new Map()\n  }\n\n  /**\n   * 根据id获取tag实例\n   * @param id\n   * @param paneId\n   * @returns\n   */\n  _getById (id, paneId) {\n    const tags = this.get(paneId)\n    if (tags) {\n      return tags.get(id)\n    }\n    return null\n  }\n\n  /**\n   * 是否包含某一个标签\n   * @param id\n   * @param paneId\n   * @returns\n   */\n  has (id, paneId) {\n    return !!this._getById(id, paneId)\n  }\n\n  /**\n   * 更新tag\n   * @param id\n   * @param paneId\n   * @param options\n   */\n  update (id, paneId, options) {\n    const tag = this._getById(id, paneId)\n    if (tag) {\n      return tag.update(options)\n    }\n    return false\n  }\n\n  /**\n  * 根据id获取标签实例\n  * @param tagId\n  * @param paneId\n  * @return\n  */\n  get (paneId) {\n    return this._tags.get(paneId)\n  }\n\n  /**\n  * 添加标签\n  * @param tags\n  * @param paneId\n  */\n  add (tags, paneId) {\n    if (!this._tags.has(paneId)) {\n      this._tags.set(paneId, new Map())\n    }\n    const idTags = this._tags.get(paneId)\n    tags.forEach(tag => {\n      idTags.set(tag.id(), tag)\n    })\n    this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n  }\n\n  /**\n  * 移除标签\n  * @param paneId\n  * @param tagId\n  */\n  remove (paneId, tagId) {\n    let shouldInvalidate = false\n    if (isValid(paneId)) {\n      if (this._tags.has(paneId)) {\n        if (isValid(tagId)) {\n          const paneTags = this._tags.get(paneId)\n          const ids = [].concat(tagId)\n          ids.forEach(id => {\n            if (paneTags.has(id)) {\n              shouldInvalidate = true\n              paneTags.delete(id)\n            }\n          })\n          if (paneTags.size === 0) {\n            this._tags.delete(paneId)\n          }\n        } else {\n          shouldInvalidate = true\n          this._tags.delete(paneId)\n        }\n      }\n    } else {\n      shouldInvalidate = true\n      this._tags.clear()\n    }\n    if (shouldInvalidate) {\n      this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isValid } from '../utils/typeChecks'\n\nimport InvalidateLevel from '../enum/InvalidateLevel'\n\nexport default class CrosshairStore {\n  constructor (chartStore) {\n    this._chartStore = chartStore\n    // 十字光标信息\n    this._crosshair = {}\n  }\n\n  /**\n     * 设置十字光标点信息\n     * @param crosshair\n     * @param notInvalidate\n     */\n  set (crosshair, notInvalidate) {\n    const dataList = this._chartStore.dataList()\n    const cr = crosshair || {}\n    let realDataIndex\n    let dataIndex\n    if (isValid(cr.x)) {\n      realDataIndex = this._chartStore.timeScaleStore().coordinateToDataIndex(cr.x)\n      if (realDataIndex < 0) {\n        dataIndex = 0\n      } else if (realDataIndex > dataList.length - 1) {\n        dataIndex = dataList.length - 1\n      } else {\n        dataIndex = realDataIndex\n      }\n    } else {\n      realDataIndex = dataList.length - 1\n      dataIndex = realDataIndex\n    }\n    const kLineData = dataList[dataIndex]\n    const realX = this._chartStore.timeScaleStore().dataIndexToCoordinate(realDataIndex)\n    const prevCrosshair = { x: this._crosshair.x, y: this._crosshair.y, paneId: this._crosshair.paneId }\n    this._crosshair = { ...cr, realX, kLineData, realDataIndex, dataIndex }\n    if (kLineData) {\n      this._chartStore.crosshairChange({\n        crosshair: cr,\n        realDataIndex,\n        dataIndex,\n        kLineData,\n        x: cr.x,\n        y: cr.y\n      })\n    }\n    if (\n      (prevCrosshair.x !== cr.x || prevCrosshair.y !== cr.y || prevCrosshair.paneId !== cr.paneId) && !notInvalidate\n    ) {\n      this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  /**\n   * 重新计算十字光标\n   * @param notInvalidate\n   */\n  recalculate (notInvalidate) {\n    this.set(this._crosshair, notInvalidate)\n  }\n\n  /**\n   * 获取crosshair信息\n   * @returns\n   */\n  get () {\n    return this._crosshair\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { hasAction } from '../enum/ActionType'\n\nclass Delegate {\n  constructor () {\n    this._observers = []\n  }\n\n  subscribe (observer) {\n    if (this._observers.indexOf(observer) < 0) {\n      this._observers.push(observer)\n    }\n  }\n\n  unsubscribe (observer) {\n    const index = this._observers.indexOf(observer)\n    if (index > -1) {\n      this._observers.splice(index, 1)\n    } else {\n      this._observers = []\n    }\n  }\n\n  execute (data) {\n    this._observers.forEach(observer => {\n      observer(data)\n    })\n  }\n\n  hasObservers () {\n    return this._observers.length > 0\n  }\n}\n\nexport default class ActionStore {\n  constructor () {\n    // 事件代理\n    this._delegates = new Map()\n  }\n\n  /**\n   * 事件执行\n   * @param type\n   * @param data\n   */\n  execute (type, data) {\n    if (this.has(type)) {\n      this._delegates.get(type).execute(data)\n    }\n  }\n\n  /**\n   * 是否有事件监听\n   * @param type\n   * @return {boolean}\n   */\n  has (type) {\n    return this._delegates.has(type) && this._delegates.get(type).hasObservers()\n  }\n\n  /**\n   * 订阅事件\n   * @param type\n   * @param callback\n   * @return {boolean}\n   */\n  subscribe (type, callback) {\n    if (hasAction(type)) {\n      if (!this._delegates.has(type)) {\n        this._delegates.set(type, new Delegate())\n      }\n      this._delegates.get(type).subscribe(callback)\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 取消事件订阅\n   * @param type\n   * @param callback\n   * @return {boolean}\n   */\n  unsubscribe (type, callback) {\n    if (hasAction(type)) {\n      const delegate = this._delegates.get(type)\n      delegate.unsubscribe(callback)\n      if (!delegate.hasObservers()) {\n        this._delegates.delete(type)\n      }\n      return true\n    }\n    return false\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { isArray, isObject, isBoolean, merge, clone } from '../utils/typeChecks'\nimport { defaultStyleOptions } from '../options/styleOptions'\n\nimport TimeScaleStore from './TimeScaleStore'\nimport TechnicalIndicatorStore from './TechnicalIndicatorStore'\nimport ShapeStore from './ShapeStore'\nimport AnnotationStore from './AnnotationStore'\nimport TagStore from './TagStore'\nimport CrosshairStore from './CrosshairStore'\nimport ActionStore from './ActionStore'\n\nexport default class ChartStore {\n  constructor (styleOptions, handler) {\n    // 持有者\n    this._handler = handler\n    // 样式配置\n    this._styleOptions = clone(defaultStyleOptions)\n    merge(this._styleOptions, styleOptions)\n\n    // 价格精度\n    this._pricePrecision = 2\n    // 数量精度\n    this._volumePrecision = 0\n\n    // 数据源\n    this._dataList = []\n    // 可见的数据(需要绘制的数据)\n    this._visibleDataList = []\n\n    // 调整pane标记\n    this._dragPaneFlag = false\n\n    // 时间轴缩放数据存储\n    this._timeScaleStore = new TimeScaleStore(this)\n    // 技术指标数据存储\n    this._technicalIndicatorStore = new TechnicalIndicatorStore(this)\n    // 图形数据存储\n    this._shapeStore = new ShapeStore(this)\n    // 注解数据存储\n    this._annotationStore = new AnnotationStore(this)\n    // 标签数据存储\n    this._tagStore = new TagStore(this)\n    // 十字光标数据存储\n    this._crosshairStore = new CrosshairStore(this)\n    // 事件存储\n    this._actionStore = new ActionStore()\n  }\n\n  /**\n   * 调整可见数据\n   */\n  adjustVisibleDataList () {\n    // 处理需要绘制的数据\n    this._visibleDataList = []\n    const from = this._timeScaleStore.from()\n    const to = this._timeScaleStore.to()\n    for (let i = from; i < to; i++) {\n      const kLineData = this._dataList[i]\n      const x = this._timeScaleStore.dataIndexToCoordinate(i)\n      this._visibleDataList.push({\n        index: i,\n        x,\n        data: kLineData\n      })\n    }\n    this._annotationStore.createVisibleAnnotations()\n  }\n\n  /**\n   * 获取样式配置\n   * @return {{}}\n   */\n  styleOptions () {\n    return this._styleOptions\n  }\n\n  /**\n   * 设置样式配置\n   * @param options\n   */\n  applyStyleOptions (options) {\n    merge(this._styleOptions, options)\n  }\n\n  /**\n   * 价格精度\n   * @returns {number}\n   */\n  pricePrecision () {\n    return this._pricePrecision\n  }\n\n  /**\n   * 数量精度\n   * @returns {number}\n   */\n  volumePrecision () {\n    return this._volumePrecision\n  }\n\n  /**\n   * 设置价格和数量精度\n   * @param pricePrecision\n   * @param volumePrecision\n   */\n  setPriceVolumePrecision (pricePrecision, volumePrecision) {\n    this._pricePrecision = pricePrecision\n    this._volumePrecision = volumePrecision\n    this._technicalIndicatorStore.setSeriesPrecision(pricePrecision, volumePrecision)\n  }\n\n  /**\n   * 获取数据源\n   * @returns {[]|*[]}\n   */\n  dataList () {\n    return this._dataList\n  }\n\n  /**\n   * 获取可见数据源\n   * @returns {[]|*[]}\n   */\n  visibleDataList () {\n    return this._visibleDataList\n  }\n\n  /**\n   * 添加数据\n   * @param data\n   * @param pos\n   * @param more\n   */\n  addData (data, pos, more) {\n    if (isObject(data)) {\n      if (isArray(data)) {\n        this._timeScaleStore.setLoading(false)\n        this._timeScaleStore.setMore(isBoolean(more) ? more : true)\n        const isFirstAdd = this._dataList.length === 0\n        this._dataList = data.concat(this._dataList)\n        if (isFirstAdd) {\n          this._timeScaleStore.resetOffsetRightSpace()\n        }\n        this._timeScaleStore.adjustFromTo()\n      } else {\n        const dataSize = this._dataList.length\n        if (pos >= dataSize) {\n          this._dataList.push(data)\n          let offsetRightBarCount = this._timeScaleStore.offsetRightBarCount()\n          if (offsetRightBarCount < 0) {\n            this._timeScaleStore.setOffsetRightBarCount(--offsetRightBarCount)\n          }\n          this._timeScaleStore.adjustFromTo()\n        } else {\n          this._dataList[pos] = data\n          this.adjustVisibleDataList()\n        }\n      }\n      this._crosshairStore.recalculate(true)\n    }\n  }\n\n  /**\n   * 清空数据源\n   */\n  clearDataList () {\n    this._dataList = []\n    this._visibleDataList = []\n    this._timeScaleStore.clear()\n  }\n\n  /**\n   * 获取时间缩放存储\n   * @returns\n   */\n  timeScaleStore () {\n    return this._timeScaleStore\n  }\n\n  /**\n   * 获取技术指标存储\n   * @returns\n   */\n  technicalIndicatorStore () {\n    return this._technicalIndicatorStore\n  }\n\n  /**\n   * 获取图形存储\n   * @returns\n   */\n  shapeStore () {\n    return this._shapeStore\n  }\n\n  /**\n   * 获取注解存储\n   * @returns\n   */\n  annotationStore () {\n    return this._annotationStore\n  }\n\n  /**\n   * 获取标签数据存储\n   * @returns\n   */\n  tagStore () {\n    return this._tagStore\n  }\n\n  /**\n   * 获取十字光标数据存储\n   * @returns\n   */\n  crosshairStore () {\n    return this._crosshairStore\n  }\n\n  /**\n   * 获取事件数据存储\n   * @returns\n   */\n  actionStore () {\n    return this._actionStore\n  }\n\n  /**\n   * 刷新\n   * @param invalidateLevel\n   */\n  invalidate (invalidateLevel) {\n    this._handler.invalidate(invalidateLevel)\n  }\n\n  /**\n   * 十字光标变化\n   * @param data\n   */\n  crosshairChange (data) {\n    this._handler.crosshair(data)\n  }\n\n  /**\n   * 获取拖拽Pane标记\n   * @return {boolean}\n   */\n  dragPaneFlag () {\n    return this._dragPaneFlag\n  }\n\n  /**\n   * 设置拖拽Pane标记\n   * @param flag\n   */\n  setDragPaneFlag (flag) {\n    this._dragPaneFlag = flag\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 创建一个元素\n * @param name\n * @param styles\n * @return {*}\n */\nexport function createElement (name, styles = {}) {\n  const element = document.createElement(name)\n  for (const key in styles) {\n    if (Object.prototype.hasOwnProperty.call(styles, key)) {\n      (element.style)[key] = styles[key]\n    }\n  }\n  return element\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../utils/canvas'\nimport { createElement } from '../utils/element'\n\nexport default class Pane {\n  constructor (props) {\n    this._height = -1\n    this._container = props.container\n    this._chartStore = props.chartStore\n    this._initBefore(props)\n    this._initElement()\n    this._mainWidget = this._createMainWidget(this._element, props)\n    this._yAxisWidget = this._createYAxisWidget(this._element, props)\n  }\n\n  _initBefore (props) {}\n\n  _initElement () {\n    this._element = createElement('div', {\n      width: '100%',\n      margin: '0',\n      padding: '0',\n      position: 'relative',\n      overflow: 'hidden',\n      boxSizing: 'border-box'\n    })\n    const lastElement = this._container.lastChild\n    if (lastElement) {\n      this._container.insertBefore(this._element, lastElement)\n    } else {\n      this._container.appendChild(this._element)\n    }\n  }\n\n  /**\n   * 创建主组件\n   * @param container\n   * @param props\n   * @private\n   */\n  _createMainWidget (container, props) {}\n\n  /**\n   * 创建y轴组件\n   * @param container\n   * @param props\n   * @private\n   */\n  _createYAxisWidget (container, props) {}\n\n  /**\n   * 获取宽度\n   * @returns {number}\n   */\n  width () {\n    return this._element.offsetWidth\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    this._mainWidget.setWidth(mainWidgetWidth)\n    this._yAxisWidget && this._yAxisWidget.setWidth(yAxisWidgetWidth)\n  }\n\n  /**\n   * 获取高度\n   */\n  height () {\n    return this._height\n  }\n\n  /**\n   * 设置临时高度\n   * @param height\n   */\n  setHeight (height) {\n    this._height = height\n    this._mainWidget.setHeight(height)\n    this._yAxisWidget && this._yAxisWidget.setHeight(height)\n  }\n\n  setOffsetLeft (mainWidgetOffsetLeft, yAxisWidgetOffsetLeft) {\n    this._mainWidget.setOffsetLeft(mainWidgetOffsetLeft)\n    this._yAxisWidget && this._yAxisWidget.setOffsetLeft(yAxisWidgetOffsetLeft)\n  }\n\n  layout () {\n    if (this._element.offsetHeight !== this._height) {\n      this._element.style.height = `${this._height}px`\n    }\n    this._mainWidget.layout()\n    this._yAxisWidget && this._yAxisWidget.layout()\n  }\n\n  /**\n   * 刷新\n   * @param level\n   */\n  invalidate (level) {\n    this._yAxisWidget && this._yAxisWidget.invalidate(level)\n    this._mainWidget.invalidate(level)\n  }\n\n  /**\n   * 创建html元素\n   */\n  createHtml ({ id, content, style, position }) {\n    let htmlId\n    if (position === 'yAxis') {\n      htmlId = this._yAxisWidget && this._yAxisWidget.createHtml({ id, content, style })\n    } else {\n      htmlId = this._mainWidget.createHtml({ id, content, style })\n    }\n    return htmlId\n  }\n\n  /**\n   * 移除html元素\n   * @param id\n   */\n  removeHtml (id) {\n    this._yAxisWidget && this._yAxisWidget.removeHtml(id)\n    this._mainWidget.removeHtml(id)\n  }\n\n  /**\n   * 将canvas转换成图片\n   * @param includeOverlay\n   * @return {HTMLCanvasElement}\n   */\n  getImage (includeOverlay) {\n    const width = this._element.offsetWidth\n    const height = this._element.offsetHeight\n    const canvas = createElement('canvas', {\n      width: `${width}px`,\n      height: `${height}px`,\n      boxSizing: 'border-box'\n    })\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    const mainWidgetElement = this._mainWidget.getElement()\n    const mainWidgetWidth = mainWidgetElement.offsetWidth\n    const mainWidgetHeight = mainWidgetElement.offsetHeight\n    const mainWidgetOffsetLeft = parseInt(mainWidgetElement.style.left, 10)\n\n    ctx.drawImage(\n      this._mainWidget.getImage(includeOverlay),\n      mainWidgetOffsetLeft, 0,\n      mainWidgetWidth, mainWidgetHeight\n    )\n    if (this._yAxisWidget) {\n      const yAxisWidgetElement = this._yAxisWidget.getElement()\n      const yAxisWidgetWidth = yAxisWidgetElement.offsetWidth\n      const yAxisWidgetHeight = yAxisWidgetElement.offsetHeight\n      const yAxisWidgetOffsetLeft = parseInt(yAxisWidgetElement.style.left, 10)\n      ctx.drawImage(\n        this._yAxisWidget.getImage(includeOverlay),\n        yAxisWidgetOffsetLeft, 0,\n        yAxisWidgetWidth, yAxisWidgetHeight\n      )\n    }\n    return canvas\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    this._container.removeChild(this._element)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport InvalidateLevel from '../enum/InvalidateLevel'\nimport { getPixelRatio } from '../utils/canvas'\nimport { createElement } from '../utils/element'\nimport { isString } from '../utils/typeChecks'\n\nexport default class Widget {\n  constructor (props) {\n    this._width = 0\n    this._height = 0\n    this._initElement(props.container)\n    this._mainView = this._createMainView(this._element, props)\n    this._overlayView = this._createOverlayView(this._element, props)\n    this._htmlBaseId = 0\n    this._htmls = new Map()\n  }\n\n  /**\n   * 初始化element\n   * @param container\n   * @private\n   */\n  _initElement (container) {\n    this._element = createElement('div', {\n      margin: '0',\n      padding: '0',\n      position: 'absolute',\n      top: '0',\n      overflow: 'hidden',\n      boxSizing: 'border-box'\n    })\n    container.appendChild(this._element)\n  }\n\n  /**\n   * 创建主view\n   * @param container\n   * @param props\n   * @private\n   */\n  _createMainView (container, props) {}\n\n  /**\n   * 创建浮层view\n   * @param container\n   * @param props\n   * @private\n   */\n  _createOverlayView (container, props) {}\n\n  /**\n   * 创建html元素\n   * @param id 标识\n   * @param content 内容\n   * @param style 样式\n   */\n  createHtml ({ id, content, style = {} }) {\n    const html = createElement('div', { boxSizing: 'border-box', position: 'absolute', zIndex: 12, ...style })\n    if (isString(content)) {\n      const str = content.replace(/(^\\s*)|(\\s*$)/g, '')\n      html.innerHTML = str\n    } else {\n      html.appendChild(content)\n    }\n    const htmlId = id || `html_${++this._htmlBaseId}`\n    if (this._htmls.has(htmlId)) {\n      this._element.replaceChild(html, this._htmls.get(htmlId))\n    } else {\n      this._element.appendChild(html)\n    }\n    this._htmls.set(htmlId, html)\n    return htmlId\n  }\n\n  /**\n   * 移除html元素\n   * @param id\n   */\n  removeHtml (id) {\n    if (id) {\n      const ids = [].concat(id)\n      ids.forEach(htmlId => {\n        const html = this._htmls.get(htmlId)\n        if (html) {\n          this._element.removeChild(html)\n          this._htmls.delete(htmlId)\n        }\n      })\n    } else {\n      this._htmls.forEach(html => {\n        this._element.removeChild(html)\n      })\n      this._htmls.clear()\n    }\n  }\n\n  getElement () {\n    return this._element\n  }\n\n  setWidth (width) {\n    this._width = width\n    this._mainView.setWidth(width)\n    this._overlayView.setWidth(width)\n  }\n\n  setHeight (height) {\n    this._height = height\n    this._mainView.setHeight(height)\n    this._overlayView.setHeight(height)\n  }\n\n  setOffsetLeft (offsetLeft) {\n    this._element.style.left = `${offsetLeft}px`\n  }\n\n  layout () {\n    if (this._element.offsetWidth !== this._width) {\n      this._element.style.width = `${this._width}px`\n    }\n    if (this._element.offsetHeight !== this._height) {\n      this._element.style.height = `${this._height}px`\n    }\n    this._mainView.layout()\n    this._overlayView.layout()\n  }\n\n  /**\n   * 更新\n   * @param level\n   */\n  invalidate (level) {\n    switch (level) {\n      case InvalidateLevel.OVERLAY: {\n        this._overlayView.flush()\n        break\n      }\n      case InvalidateLevel.MAIN:\n      case InvalidateLevel.FULL: {\n        this._mainView.flush()\n        this._overlayView.flush()\n        break\n      }\n      default: {\n        break\n      }\n    }\n  }\n\n  /**\n   * 将widget转换成图片\n   * @param includeOverlay\n   * @returns {HTMLCanvasElement}\n   */\n  getImage (includeOverlay) {\n    const canvas = createElement('canvas', {\n      width: `${this._width}px`,\n      height: `${this._height}px`,\n      boxSizing: 'border-box'\n    })\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    canvas.width = this._width * pixelRatio\n    canvas.height = this._height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    ctx.drawImage(this._mainView.getImage(), 0, 0, this._width, this._height)\n\n    if (includeOverlay && this._overlayView) {\n      ctx.drawImage(this._overlayView.getImage(), 0, 0, this._width, this._height)\n    }\n    return canvas\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * requestAnimationFrame兼容\n * @param fn\n */\nexport function requestAnimationFrame (fn) {\n  if (!window.requestAnimationFrame) {\n    return window.setTimeout(fn, 20)\n  }\n  return window.requestAnimationFrame(fn)\n}\n\n/**\n * cancelAnimationFrame兼容\n * @param id\n */\nexport function cancelAnimationFrame (id) {\n  if (!window.cancelAnimationFrame) {\n    clearTimeout(id)\n  }\n  window.cancelAnimationFrame(id)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../utils/canvas'\nimport { createElement } from '../utils/element'\nimport { cancelAnimationFrame, requestAnimationFrame } from '../utils/compatible'\n\nclass View {\n  constructor (container, chartStore) {\n    this._chartStore = chartStore\n    this._initCanvas(container)\n  }\n\n  /**\n   * 初始化画布\n   * @param container\n   * @private\n   */\n  _initCanvas (container) {\n    this._canvas = createElement('canvas', {\n      position: 'absolute',\n      top: '0',\n      left: '0',\n      zIndex: '2',\n      boxSizing: 'border-box'\n    })\n    this._ctx = this._canvas.getContext('2d')\n    container.appendChild(this._canvas)\n  }\n\n  /**\n   * 重新绘制\n   * @param extendFun\n   * @private\n   */\n  _redraw (extendFun) {\n    this._ctx.clearRect(0, 0, this._canvas.offsetWidth, this._canvas.offsetHeight)\n    extendFun && extendFun()\n    this._draw()\n  }\n\n  /**\n   * 绘制\n   */\n  _draw () {\n  }\n\n  setWidth (width) {\n    this._width = width\n  }\n\n  setHeight (height) {\n    this._height = height\n  }\n\n  layout () {\n    if (this._height !== this._canvas.offsetHeight || this._width !== this._canvas.offsetWidth) {\n      this._redraw(() => {\n        const pixelRatio = getPixelRatio(this._canvas)\n        this._canvas.style.width = `${this._width}px`\n        this._canvas.style.height = `${this._height}px`\n        this._canvas.width = Math.floor(this._width * pixelRatio)\n        this._canvas.height = Math.floor(this._height * pixelRatio)\n        this._ctx.scale(pixelRatio, pixelRatio)\n      })\n    } else {\n      this.flush()\n    }\n  }\n\n  /**\n   * 刷新\n   */\n  flush () {\n    if (this.requestAnimationId) {\n      cancelAnimationFrame(this.requestAnimationId)\n      this.requestAnimationId = null\n    }\n    this.requestAnimationId = requestAnimationFrame(() => {\n      this._redraw()\n    })\n  }\n\n  /**\n   * 获取图片\n   * @returns {HTMLCanvasElement}\n   */\n  getImage () {\n    return this._canvas\n  }\n}\n\nexport default View\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\n\nimport { CandleType, LineStyle } from '../options/styleOptions'\nimport { TechnicalIndicatorPlotType, getTechnicalIndicatorPlotStyle } from '../component/technicalindicator/TechnicalIndicator'\nimport { renderHorizontalLine, renderVerticalLine, renderLine } from '../renderer/line'\nimport { isValid } from '../utils/typeChecks'\n\nexport default class TechnicalIndicatorView extends View {\n  constructor (container, chartStore, xAxis, yAxis, paneId) {\n    super(container, chartStore)\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._paneId = paneId\n  }\n\n  _draw () {\n    this._ctx.globalCompositeOperation = 'destination-over'\n    this._drawContent()\n  }\n\n  _drawContent () {\n    this._drawTechs()\n    this._drawGrid()\n  }\n\n  /**\n   * 绘制网格\n   */\n  _drawGrid () {\n    const gridOptions = this._chartStore.styleOptions().grid\n    if (!gridOptions.show) {\n      return\n    }\n    const gridHorizontalOptions = gridOptions.horizontal\n    this._ctx.save()\n    if (gridHorizontalOptions.show) {\n      this._ctx.strokeStyle = gridHorizontalOptions.color\n      this._ctx.lineWidth = gridHorizontalOptions.size\n      if (gridHorizontalOptions.style === LineStyle.DASH) {\n        this._ctx.setLineDash(gridHorizontalOptions.dashValue)\n      } else {\n        this._ctx.setLineDash([])\n      }\n      this._yAxis.ticks().forEach(tick => {\n        renderHorizontalLine(this._ctx, tick.y, 0, this._width)\n      })\n    }\n\n    const gridVerticalOptions = gridOptions.vertical\n    if (gridVerticalOptions.show) {\n      this._ctx.strokeStyle = gridVerticalOptions.color\n      this._ctx.lineWidth = gridVerticalOptions.size\n      if (gridVerticalOptions.style === LineStyle.DASH) {\n        this._ctx.setLineDash(gridVerticalOptions.dashValue)\n      } else {\n        this._ctx.setLineDash([])\n      }\n      this._xAxis.ticks().forEach(tick => {\n        renderVerticalLine(this._ctx, tick.x, 0, this._height)\n      })\n    }\n    this._ctx.restore()\n  }\n\n  /**\n   * 绘制指标\n   */\n  _drawTechs () {\n    this._ctx.globalCompositeOperation = 'source-over'\n    const techOptions = this._chartStore.styleOptions().technicalIndicator\n    const techs = this._chartStore.technicalIndicatorStore().instances(this._paneId)\n    techs.forEach(tech => {\n      const plots = tech.plots\n      const lines = []\n      const dataList = this._chartStore.dataList()\n      const techResult = tech.result\n      const styles = tech.styles || techOptions\n      // 技术指标自定义绘制\n      if (tech.render) {\n        this._ctx.save()\n        tech.render({\n          ctx: this._ctx,\n          dataSource: {\n            from: this._chartStore.timeScaleStore().from(),\n            to: this._chartStore.timeScaleStore().to(),\n            kLineDataList: this._chartStore.dataList(),\n            technicalIndicatorDataList: techResult\n          },\n          viewport: {\n            width: this._width,\n            height: this._height,\n            dataSpace: this._chartStore.timeScaleStore().dataSpace(),\n            barSpace: this._chartStore.timeScaleStore().barSpace()\n          },\n          styles,\n          xAxis: this._xAxis,\n          yAxis: this._yAxis\n        })\n        this._ctx.restore()\n      }\n      const lineColors = techOptions.line.colors || []\n      const lineColorSize = lineColors.length\n      const isCandleYAxis = this._yAxis.isCandleYAxis()\n      this._ctx.lineWidth = 1\n      this._drawGraphics(\n        (x, i, kLineData, halfBarSpace, barSpace) => {\n          const techData = techResult[i] || {}\n          let lineCount = 0\n          if (tech.shouldOhlc && !isCandleYAxis) {\n            this._drawCandleBar(x, halfBarSpace, barSpace, i, kLineData, styles.bar, CandleType.OHLC)\n          }\n          plots.forEach(plot => {\n            const value = techData[plot.key]\n            const valueY = this._yAxis.convertToPixel(value)\n            switch (plot.type) {\n              case TechnicalIndicatorPlotType.CIRCLE: {\n                if (isValid(value)) {\n                  const plotStyle = getTechnicalIndicatorPlotStyle(\n                    dataList, techResult, i, plot, styles, { color: styles.circle.noChangeColor, isStroke: true }\n                  )\n                  this._drawCircle({\n                    x,\n                    y: valueY,\n                    radius: halfBarSpace,\n                    color: plotStyle.color,\n                    isStroke: plotStyle.isStroke\n                  })\n                }\n                break\n              }\n              case TechnicalIndicatorPlotType.BAR: {\n                if (isValid(value)) {\n                  let baseValue\n                  if (isValid(plot.baseValue)) {\n                    baseValue = plot.baseValue\n                  } else {\n                    baseValue = this._yAxis.min()\n                  }\n                  const baseValueY = this._yAxis.convertToPixel(baseValue)\n                  const height = Math.abs(baseValueY - valueY)\n                  const bar = {\n                    x: x - halfBarSpace,\n                    width: halfBarSpace * 2,\n                    height: Math.max(1, height)\n                  }\n                  if (valueY > baseValueY) {\n                    bar.y = baseValueY\n                  } else {\n                    bar.y = height < 1 ? baseValueY - 1 : valueY\n                  }\n                  const plotStyle = getTechnicalIndicatorPlotStyle(\n                    dataList, techResult, i, plot, styles, { color: styles.bar.noChangeColor }\n                  )\n                  bar.color = plotStyle.color\n                  bar.isStroke = plotStyle.isStroke\n                  this._drawBar(bar)\n                }\n                break\n              }\n              case TechnicalIndicatorPlotType.LINE: {\n                let coordinate = null\n                if (isValid(value)) {\n                  coordinate = { x: x, y: valueY }\n                }\n                if (lines[lineCount]) {\n                  lines[lineCount].coordinates.push(coordinate)\n                } else {\n                  const plotStyle = getTechnicalIndicatorPlotStyle(\n                    dataList, techResult, i, plot, styles, { color: lineColors[lineCount % lineColorSize] }\n                  )\n                  lines[lineCount] = { color: plotStyle.color, coordinates: [coordinate] }\n                }\n                lineCount++\n                break\n              }\n              default: { break }\n            }\n          })\n        },\n        () => {\n          this._drawLines(lines, styles)\n        }\n      )\n    })\n    this._ctx.globalCompositeOperation = 'destination-over'\n  }\n\n  /**\n   * 绘制图形\n   * @param onDrawing\n   * @param onDrawEnd\n   */\n  _drawGraphics (onDrawing, onDrawEnd) {\n    const visibleDataList = this._chartStore.visibleDataList()\n    const barSpace = this._chartStore.timeScaleStore().barSpace()\n    const halfBarSpace = this._chartStore.timeScaleStore().halfBarSpace()\n    visibleDataList.forEach(({ x, index, data }, n) => {\n      onDrawing(x, index, data, halfBarSpace, barSpace, n)\n    })\n    onDrawEnd && onDrawEnd()\n  }\n\n  /**\n   * 绘制线\n   * @param lines\n   * @param techOptions\n   */\n  _drawLines (lines, techOptions) {\n    this._ctx.lineWidth = techOptions.line.size\n    lines.forEach(line => {\n      this._ctx.strokeStyle = line.color\n      renderLine(this._ctx, line.coordinates)\n    })\n  }\n\n  /**\n   * 绘制柱\n   */\n  _drawBar (bar) {\n    if (bar.isStroke) {\n      this._ctx.strokeStyle = bar.color\n      this._ctx.strokeRect(bar.x + 0.5, bar.y, bar.width - 1, bar.height)\n    } else {\n      this._ctx.fillStyle = bar.color\n      this._ctx.fillRect(bar.x, bar.y, bar.width, bar.height)\n    }\n  }\n\n  /**\n   * 绘制圆点\n   * @param circle\n   * @private\n   */\n  _drawCircle (circle) {\n    this._ctx.strokeStyle = circle.color\n    this._ctx.fillStyle = circle.color\n    this._ctx.beginPath()\n    this._ctx.arc(circle.x, circle.y, circle.radius, Math.PI * 2, 0, true)\n    if (circle.isStroke) {\n      this._ctx.stroke()\n    } else {\n      this._ctx.fill()\n    }\n    this._ctx.closePath()\n  }\n\n  /**\n   * 绘制蜡烛柱\n   * @param x\n   * @param halfBarSpace\n   * @param barSpace\n   * @param dataIndex\n   * @param kLineData\n   * @param barOptions\n   * @param barStyle\n   */\n  _drawCandleBar (x, halfBarSpace, barSpace, dataIndex, kLineData, barOptions, barStyle) {\n    const { open, close, high, low } = kLineData\n    if (close > open) {\n      this._ctx.strokeStyle = barOptions.upColor\n      this._ctx.fillStyle = barOptions.upColor\n    } else if (close < open) {\n      this._ctx.strokeStyle = barOptions.downColor\n      this._ctx.fillStyle = barOptions.downColor\n    } else {\n      this._ctx.strokeStyle = barOptions.noChangeColor\n      this._ctx.fillStyle = barOptions.noChangeColor\n    }\n    const openY = this._yAxis.convertToPixel(open)\n    const closeY = this._yAxis.convertToPixel(close)\n    const highY = this._yAxis.convertToPixel(high)\n    const lowY = this._yAxis.convertToPixel(low)\n\n    const highEndY = Math.min(openY, closeY)\n    const lowStartY = Math.max(openY, closeY)\n    this._ctx.fillRect(x - 0.5, highY, 1, highEndY - highY)\n    this._ctx.fillRect(x - 0.5, lowStartY, 1, lowY - lowStartY)\n\n    const barHeight = Math.max(1, lowStartY - highEndY)\n    switch (barStyle) {\n      case CandleType.CANDLE_SOLID: {\n        this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        break\n      }\n      case CandleType.CANDLE_STROKE: {\n        this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        break\n      }\n      case CandleType.CANDLE_UP_STROKE: {\n        if (close > open) {\n          this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        } else {\n          this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        }\n        break\n      }\n      case CandleType.CANDLE_DOWN_STROKE: {\n        if (close > open) {\n          this._ctx.fillRect(x - halfBarSpace, highEndY, barSpace, barHeight)\n        } else {\n          this._ctx.strokeRect(x - halfBarSpace + 0.5, highEndY, barSpace - 1, barHeight)\n        }\n        break\n      }\n      default: {\n        this._ctx.fillRect(x - 0.5, highY, 1, lowY - highY)\n        this._ctx.fillRect(x - halfBarSpace, openY - 0.5, halfBarSpace, 1)\n        this._ctx.fillRect(x, closeY - 0.5, halfBarSpace, 1)\n        break\n      }\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制文字\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param text\n */\nexport function renderText (ctx, color, x, y, text) {\n  ctx.fillStyle = color\n  ctx.fillText(text, x, y)\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { TooltipShowRule, LineStyle } from '../options/styleOptions'\nimport { TechnicalIndicatorPlotType, getTechnicalIndicatorPlotStyle } from '../component/technicalindicator/TechnicalIndicator'\nimport { isValid, isObject } from '../utils/typeChecks'\nimport { formatPrecision, formatBigNumber } from '../utils/format'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { renderText } from '../renderer/text'\n\nexport default class TechnicalIndicatorOverlayView extends View {\n  constructor (container, chartStore, xAxis, yAxis, paneId) {\n    super(container, chartStore)\n    this._xAxis = xAxis\n    this._yAxis = yAxis\n    this._paneId = paneId\n  }\n\n  _draw () {\n    this._ctx.textBaseline = 'alphabetic'\n    this._drawTag()\n    this._drawShape()\n    this._drawAnnotation()\n    const crosshair = this._chartStore.crosshairStore().get()\n    if (crosshair.kLineData) {\n      const styleOptions = this._chartStore.styleOptions()\n      const crosshairOptions = styleOptions.crosshair\n      if (crosshair.paneId === this._paneId) {\n        // 绘制十字光标水平线\n        this._drawCrosshairLine(crosshairOptions, 'horizontal', crosshair.y, 0, this._width, renderHorizontalLine)\n      }\n      if (crosshair.paneId) {\n        // 绘制十字光标垂直线\n        this._drawCrosshairLine(crosshairOptions, 'vertical', crosshair.realX, 0, this._height, renderVerticalLine)\n      }\n      this._drawTooltip(crosshair, this._chartStore.technicalIndicatorStore().instances(this._paneId))\n    }\n  }\n\n  /**\n   * 绘制注解\n   */\n  _drawAnnotation () {\n    const annotations = this._chartStore.annotationStore().get(this._paneId)\n    if (annotations) {\n      annotations.forEach(annotation => {\n        annotation.draw(this._ctx)\n      })\n    }\n  }\n\n  /**\n   * 绘制标签\n   */\n  _drawTag () {\n    const tags = this._chartStore.tagStore().get(this._paneId)\n    if (tags) {\n      tags.forEach(tag => {\n        tag.drawMarkLine(this._ctx)\n      })\n    }\n  }\n\n  /**\n   * 绘制图形标记\n   * @private\n   */\n  _drawShape () {\n    this._chartStore.shapeStore().instances(this._paneId).forEach(shape => {\n      shape.draw(this._ctx)\n    })\n    const progressShape = this._chartStore.shapeStore().progressInstance()\n    if (progressShape.paneId === this._paneId) {\n      progressShape.instance.draw(this._ctx)\n    }\n  }\n\n  /**\n   * 绘制图例\n   * @param crosshair\n   * @param techs\n   * @private\n   */\n  _drawTooltip (crosshair, techs) {\n    const techOptions = this._chartStore.styleOptions().technicalIndicator\n    this._drawBatchTechToolTip(\n      crosshair,\n      techs,\n      techOptions,\n      0,\n      this._shouldDrawTooltip(crosshair, techOptions.tooltip)\n    )\n  }\n\n  /**\n   * 绘制十字光标线\n   * @param crosshairOptions\n   * @param optionsKey\n   * @param fixed\n   * @param start\n   * @param end\n   * @param drawLine\n   * @private\n   */\n  _drawCrosshairLine (crosshairOptions, optionsKey, fixed, start, end, drawLine) {\n    const crosshairDirectionOptions = crosshairOptions[optionsKey]\n    const crosshairLineOptions = crosshairDirectionOptions.line\n    if (!crosshairOptions.show || !crosshairDirectionOptions.show || !crosshairLineOptions.show) {\n      return\n    }\n    this._ctx.save()\n    this._ctx.lineWidth = crosshairLineOptions.size\n    this._ctx.strokeStyle = crosshairLineOptions.color\n\n    if (crosshairLineOptions.style === LineStyle.DASH) {\n      this._ctx.setLineDash(crosshairLineOptions.dashValue)\n    }\n    drawLine(this._ctx, fixed, start, end)\n    this._ctx.restore()\n  }\n\n  /**\n   * 批量绘制技术指标提示\n   * @param crosshair\n   * @param techs\n   * @param techOptions\n   * @param offsetTop\n   * @param isDrawTechTooltip\n   */\n  _drawBatchTechToolTip (crosshair, techs, techOptions, offsetTop = 0, isDrawTechTooltip) {\n    if (!isDrawTechTooltip) {\n      return\n    }\n    const techTooltipOptions = techOptions.tooltip\n    let top = offsetTop\n    techs.forEach(tech => {\n      this._drawTechTooltip(crosshair, tech, techOptions, top)\n      top += (\n        techTooltipOptions.text.marginTop +\n        techTooltipOptions.text.size +\n        techTooltipOptions.text.marginBottom\n      )\n    })\n  }\n\n  /**\n   * 绘制指标图例\n   * @param crosshair\n   * @param tech\n   * @param techOptions\n   * @param offsetTop\n   * @private\n   */\n  _drawTechTooltip (crosshair, tech, techOptions, offsetTop = 0) {\n    const techTooltipOptions = techOptions.tooltip\n    const techTooltipTextOptions = techTooltipOptions.text\n    const textMarginLeft = techTooltipTextOptions.marginLeft\n    const textMarginRight = techTooltipTextOptions.marginRight\n    const textSize = techTooltipTextOptions.size\n    const textColor = techTooltipTextOptions.color\n    let labelX = 0\n    const labelY = techTooltipTextOptions.marginTop + offsetTop\n    const tooltipData = this._getTechTooltipData(crosshair, tech, techOptions)\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(textSize, techTooltipTextOptions.weight, techTooltipTextOptions.family)\n    if (techTooltipOptions.showName) {\n      const nameText = tooltipData.name\n      const nameTextWidth = calcTextWidth(this._ctx, nameText)\n      labelX += textMarginLeft\n      renderText(this._ctx, textColor, labelX, labelY, nameText)\n      labelX += nameTextWidth\n      if (!techTooltipOptions.showParams) {\n        labelX += textMarginRight\n      }\n    }\n    if (techTooltipOptions.showParams) {\n      const calcParamText = tooltipData.calcParamText\n      const calcParamTextWidth = calcTextWidth(this._ctx, calcParamText)\n      if (!techTooltipOptions.showName) {\n        labelX += textMarginLeft\n      }\n      renderText(this._ctx, textColor, labelX, labelY, calcParamText)\n      labelX += (calcParamTextWidth + textMarginRight)\n    }\n    tooltipData.values.forEach(v => {\n      labelX += textMarginLeft\n      const text = `${v.title}${v.value}`\n      const textWidth = calcTextWidth(this._ctx, text)\n      renderText(this._ctx, v.color, labelX, labelY, text)\n      labelX += (textWidth + textMarginRight)\n    })\n  }\n\n  /**\n   * 是否需要绘制图例\n   * @param crosshair\n   * @param tooltipOptions\n   * @return {boolean|boolean|*}\n   */\n  _shouldDrawTooltip (crosshair, tooltipOptions) {\n    const showRule = tooltipOptions.showRule\n    return showRule === TooltipShowRule.ALWAYS ||\n      (showRule === TooltipShowRule.FOLLOW_CROSS && (!!crosshair.paneId))\n  }\n\n  /**\n   * 获取技术指标提示数据\n   * @param techData\n   * @param tech\n   * @returns\n   */\n  _getTechTooltipData (crosshair, tech, techOptions) {\n    const dataIndex = crosshair.dataIndex\n    const styles = tech.styles || techOptions\n    const techResult = tech.result\n    const techData = techResult[dataIndex]\n    const dataList = this._chartStore.dataList()\n\n    const calcParams = tech.calcParams\n    const plots = tech.plots\n    const precision = tech.precision\n    const shouldFormatBigNumber = tech.shouldFormatBigNumber\n\n    let name = ''\n    let calcParamText = ''\n    if (plots.length > 0) {\n      name = tech.shortName || tech.name\n    }\n    if (calcParams.length > 0) {\n      const params = calcParams.map(param => {\n        if (isObject(param)) {\n          return param.value\n        }\n        return param\n      })\n      calcParamText = `(${params.join(',')})`\n    }\n    const lineColors = styles.line.colors || []\n    const colorSize = lineColors.length\n    let lineCount = 0\n    const values = []\n    plots.forEach(plot => {\n      let defaultStyle = {}\n      switch (plot.type) {\n        case TechnicalIndicatorPlotType.CIRCLE: {\n          defaultStyle = { color: styles.circle.noChangeColor }\n          break\n        }\n        case TechnicalIndicatorPlotType.BAR: {\n          defaultStyle = { color: styles.bar.noChangeColor }\n          break\n        }\n        case TechnicalIndicatorPlotType.LINE: {\n          defaultStyle = { color: lineColors[lineCount % colorSize] || techOptions.tooltip.text.color }\n          lineCount++\n          break\n        }\n        default: { break }\n      }\n      const plotStyle = getTechnicalIndicatorPlotStyle(\n        dataList, techResult, crosshair.dataIndex, plot, styles, defaultStyle\n      )\n      const data = {}\n      if (isValid(plot.title)) {\n        let value = (techData || {})[plot.key]\n        if (isValid(value)) {\n          value = formatPrecision(value, precision)\n          if (shouldFormatBigNumber) {\n            value = formatBigNumber(value)\n          }\n        }\n        data.title = plot.title\n        data.value = value || techOptions.tooltip.defaultValue\n        data.color = plotStyle.color\n      }\n      values.push(data)\n    })\n    return { values, name, calcParamText }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport TechnicalIndicatorView from '../view/TechnicalIndicatorView'\nimport TechnicalIndicatorOverlayView from '../view/TechnicalIndicatorOverlayView'\n\nexport default class TechnicalIndicatorWidget extends Widget {\n  _createMainView (container, props) {\n    return new TechnicalIndicatorView(container, props.chartStore, props.xAxis, props.yAxis, props.paneId)\n  }\n\n  _createOverlayView (container, props) {\n    return new TechnicalIndicatorOverlayView(container, props.chartStore, props.xAxis, props.yAxis, props.paneId)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 绘制带边框的圆角填充矩形\n * @param ctx\n * @param fillColor\n * @param borderColor\n * @param borderSize\n * @param x\n * @param y\n * @param width\n * @param height\n * @param borderRadius\n */\nexport function renderStrokeFillRoundRect (\n  ctx, fillColor, borderColor, borderSize,\n  x, y, width, height, borderRadius\n) {\n  renderFillRoundRect(ctx, fillColor, x, y, width, height, borderRadius)\n  renderStrokeRoundRect(ctx, borderColor, borderSize, x, y, width, height, borderRadius)\n}\n\n/**\n * 绘制填充的矩形\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param width\n * @param height\n */\nexport function renderFillRect (ctx, color, x, y, width, height) {\n  ctx.fillStyle = color\n  ctx.fillRect(x, y, width, height)\n}\n\n/**\n * 绘制圆角空心矩形\n * @param ctx\n * @param borderColor\n * @param borderSize\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderStrokeRoundRect (ctx, borderColor, borderSize, x, y, w, h, r) {\n  ctx.lineWidth = borderSize\n  ctx.strokeStyle = borderColor\n  renderRoundRect(ctx, x, y, w, h, r)\n  ctx.stroke()\n}\n\n/**\n * 绘制填充圆角矩形\n * @param ctx\n * @param color\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderFillRoundRect (ctx, color, x, y, w, h, r) {\n  ctx.fillStyle = color\n  renderRoundRect(ctx, x, y, w, h, r)\n  ctx.fill()\n}\n\n/**\n * 绘制圆角矩形\n * @param ctx\n * @param x\n * @param y\n * @param w\n * @param h\n * @param r\n */\nexport function renderRoundRect (ctx, x, y, w, h, r) {\n  ctx.beginPath()\n  ctx.moveTo(x + r, y)\n  ctx.arcTo(x + w, y, x + w, y + h, r)\n  ctx.arcTo(x + w, y + h, x, y + h, r)\n  ctx.arcTo(x, y + h, x, y, r)\n  ctx.arcTo(x, y, x + w, y, r)\n  ctx.closePath()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { YAxisType } from '../options/styleOptions'\nimport { TechnicalIndicatorPlotType } from '../component/technicalindicator/TechnicalIndicator'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { formatBigNumber, formatPrecision } from '../utils/format'\nimport { isValid } from '../utils/typeChecks'\nimport { renderFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class YAxisView extends View {\n  constructor (container, chartStore, yAxis, paneId) {\n    super(container, chartStore)\n    this._yAxis = yAxis\n    this._paneId = paneId\n  }\n\n  _draw () {\n    const yAxisOptions = this._chartStore.styleOptions().yAxis\n    if (yAxisOptions.show) {\n      this._drawAxisLine(yAxisOptions)\n      this._drawTickLines(yAxisOptions)\n      this._drawTickLabels(yAxisOptions)\n      this._drawTechLastValue()\n      this._drawLastPriceLabel()\n    }\n  }\n\n  _drawAxisLine (yAxisOptions) {\n    const axisLine = yAxisOptions.axisLine\n    if (!axisLine.show) {\n      return\n    }\n    this._ctx.strokeStyle = axisLine.color\n    this._ctx.lineWidth = axisLine.size\n    let x\n    if (this._yAxis.isFromYAxisZero()) {\n      x = 0\n    } else {\n      x = this._width - 1\n    }\n    renderVerticalLine(this._ctx, x, 0, this._height)\n  }\n\n  _drawTickLines (yAxisOptions) {\n    const tickLine = yAxisOptions.tickLine\n    if (!tickLine.show) {\n      return\n    }\n    this._ctx.lineWidth = tickLine.size\n    this._ctx.strokeStyle = tickLine.color\n\n    const tickLineLength = tickLine.length\n\n    let startX\n    let endX\n    if (this._yAxis.isFromYAxisZero()) {\n      startX = 0\n      if (yAxisOptions.axisLine.show) {\n        startX += yAxisOptions.axisLine.size\n      }\n      endX = startX + tickLineLength\n    } else {\n      startX = this._width\n      if (yAxisOptions.axisLine.show) {\n        startX -= yAxisOptions.axisLine.size\n      }\n      endX = startX - tickLineLength\n    }\n    this._yAxis.ticks().forEach(tick => {\n      renderHorizontalLine(this._ctx, tick.y, startX, endX)\n    })\n  }\n\n  _drawTickLabels (yAxisOptions) {\n    const tickText = yAxisOptions.tickText\n    if (!tickText.show) {\n      return\n    }\n    const tickLine = yAxisOptions.tickLine\n    const tickLineShow = tickLine.show\n    const tickLineLength = tickLine.length\n    let labelX\n    if (this._yAxis.isFromYAxisZero()) {\n      labelX = tickText.paddingLeft\n      if (yAxisOptions.axisLine.show) {\n        labelX += yAxisOptions.axisLine.size\n      }\n      if (tickLineShow) {\n        labelX += tickLineLength\n      }\n      this._ctx.textAlign = 'left'\n    } else {\n      labelX = this._width - tickText.paddingRight\n      if (yAxisOptions.axisLine.show) {\n        labelX -= yAxisOptions.axisLine.size\n      }\n      if (tickLineShow) {\n        labelX -= tickLineLength\n      }\n      this._ctx.textAlign = 'right'\n    }\n    this._ctx.textBaseline = 'middle'\n    this._ctx.font = createFont(tickText.size, tickText.weight, tickText.family)\n    this._ctx.fillStyle = tickText.color\n    this._yAxis.ticks().forEach(tick => {\n      this._ctx.fillText(tick.v, labelX, tick.y)\n    })\n    this._ctx.textAlign = 'left'\n  }\n\n  /**\n   * 绘制技术指标最后值\n   * @private\n   */\n  _drawTechLastValue () {\n    const techOptions = this._chartStore.styleOptions().technicalIndicator\n    const lastValueMarkOptions = techOptions.lastValueMark\n    if (!lastValueMarkOptions.show || !lastValueMarkOptions.text.show) {\n      return\n    }\n    const techs = this._chartStore.technicalIndicatorStore().instances(this._paneId)\n    const dataList = this._chartStore.dataList()\n    techs.forEach(tech => {\n      const techResult = tech.result || []\n      const dataSize = techResult.length\n      const techData = techResult[dataSize - 1] || {}\n      const plots = tech.plots\n      const cbData = {\n        prev: { kLineData: dataList[dataSize - 2], technicalIndicatorData: techResult[dataSize - 2] },\n        current: { kLineData: dataList[dataSize - 1], technicalIndicatorData: techData },\n        next: { kLineData: null, technicalIndicatorData: null }\n      }\n      const precision = tech.precision\n      const styles = tech.styles || techOptions\n      const colors = styles.line.colors || []\n      const colorSize = colors.length\n      let lineCount = 0\n      plots.forEach(plot => {\n        const value = techData[plot.key]\n        let backgroundColor\n        switch (plot.type) {\n          case TechnicalIndicatorPlotType.CIRCLE: {\n            backgroundColor = (plot.color && plot.color(cbData, styles)) || styles.circle.noChangeColor\n            break\n          }\n          case TechnicalIndicatorPlotType.BAR: {\n            backgroundColor = (plot.color && plot.color(cbData, styles)) || styles.bar.noChangeColor\n            break\n          }\n          case TechnicalIndicatorPlotType.LINE: {\n            backgroundColor = colors[lineCount % colorSize]\n            lineCount++\n            break\n          }\n          default: { break }\n        }\n        if (isValid(value)) {\n          this._drawMarkLabel(\n            value, precision, tech.shouldFormatBigNumber,\n            {\n              ...lastValueMarkOptions.text, backgroundColor\n            }\n          )\n        }\n      })\n    })\n  }\n\n  /**\n   * 绘制最新价文字\n   * @private\n   */\n  _drawLastPriceLabel () {\n    if (!this._yAxis.isCandleYAxis()) {\n      return\n    }\n    const priceMarkOptions = this._chartStore.styleOptions().candle.priceMark\n    const lastPriceMarkOptions = priceMarkOptions.last\n    if (!priceMarkOptions.show || !lastPriceMarkOptions.show || !lastPriceMarkOptions.text.show) {\n      return\n    }\n    const dataList = this._chartStore.dataList()\n    const kLineData = dataList[dataList.length - 1]\n    if (!kLineData) {\n      return\n    }\n    const close = kLineData.close\n    const open = kLineData.open\n    let backgroundColor\n    if (close > open) {\n      backgroundColor = lastPriceMarkOptions.upColor\n    } else if (close < open) {\n      backgroundColor = lastPriceMarkOptions.downColor\n    } else {\n      backgroundColor = lastPriceMarkOptions.noChangeColor\n    }\n    this._drawMarkLabel(\n      close, this._chartStore.pricePrecision(), false,\n      {\n        ...lastPriceMarkOptions.text, backgroundColor\n      }\n    )\n  }\n\n  /**\n   * 绘制标记label\n   * @param value\n   * @param precision\n   * @param shouldFormatBigNumber\n   * @param size\n   * @param weight\n   * @param family\n   * @param color\n   * @param backgroundColor\n   * @param borderRadius\n   * @param paddingLeft\n   * @param paddingTop\n   * @param paddingRight\n   * @param paddingBottom\n   * @private\n   */\n  _drawMarkLabel (\n    value, precision, shouldFormatBigNumber,\n    {\n      size, weight, family, color, backgroundColor, borderRadius,\n      paddingLeft, paddingTop, paddingRight, paddingBottom\n    }\n  ) {\n    const valueY = this._yAxis.convertToNicePixel(value)\n    let text\n    if (this._yAxis.yAxisType() === YAxisType.PERCENTAGE) {\n      const fromData = (this._chartStore.visibleDataList()[0] || {}).data || {}\n      const fromClose = fromData.close\n      text = `${((value - fromClose) / fromClose * 100).toFixed(2)}%`\n    } else {\n      text = formatPrecision(value, precision)\n      if (shouldFormatBigNumber) {\n        text = formatBigNumber(text)\n      }\n    }\n    this._ctx.font = createFont(size, weight, family)\n    const rectWidth = calcTextWidth(this._ctx, text) + paddingLeft + paddingRight\n    const rectHeight = paddingTop + size + paddingBottom\n    let rectStartX\n    if (this._yAxis.isFromYAxisZero()) {\n      rectStartX = 0\n    } else {\n      rectStartX = this._width - rectWidth\n    }\n    renderFillRoundRect(\n      this._ctx, backgroundColor,\n      rectStartX, valueY - paddingTop - size / 2, rectWidth, rectHeight, borderRadius\n    )\n    this._ctx.textBaseline = 'middle'\n    renderText(this._ctx, color, rectStartX + paddingLeft, valueY, text)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { getTextRectWidth, getTextRectHeight } from '../utils/canvas'\nimport { formatBigNumber, formatPrecision } from '../utils/format'\nimport { YAxisType } from '../options/styleOptions'\nimport { renderStrokeFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class YAxisOverlayView extends View {\n  constructor (container, chartStore, yAxis, paneId) {\n    super(container, chartStore)\n    this._yAxis = yAxis\n    this._paneId = paneId\n  }\n\n  _draw () {\n    this._ctx.textBaseline = 'middle'\n    this._drawTag()\n    this._drawCrossHairLabel()\n  }\n\n  /**\n   * 绘制标签\n   * @private\n   */\n  _drawTag () {\n    const tags = this._chartStore.tagStore().get(this._paneId)\n    if (tags) {\n      tags.forEach(tag => {\n        tag.drawText(this._ctx)\n      })\n    }\n  }\n\n  _drawCrossHairLabel () {\n    const crosshair = this._chartStore.crosshairStore().get()\n    if (crosshair.paneId !== this._paneId || this._chartStore.dataList().length === 0) {\n      return\n    }\n    const styleOptions = this._chartStore.styleOptions()\n    const crosshairOptions = styleOptions.crosshair\n    const crosshairHorizontalOptions = crosshairOptions.horizontal\n    const crosshairHorizontalTextOptions = crosshairHorizontalOptions.text\n    if (!crosshairOptions.show || !crosshairHorizontalOptions.show || !crosshairHorizontalTextOptions.show) {\n      return\n    }\n    const value = this._yAxis.convertFromPixel(crosshair.y)\n    let text\n    if (this._yAxis.yAxisType() === YAxisType.PERCENTAGE) {\n      const fromData = (this._chartStore.visibleDataList()[0] || {}).data || {}\n      text = `${((value - fromData.close) / fromData.close * 100).toFixed(2)}%`\n    } else {\n      const techs = this._chartStore.technicalIndicatorStore().instances(this._paneId)\n      let precision = 0\n      let shouldFormatBigNumber = false\n      if (this._yAxis.isCandleYAxis()) {\n        precision = this._chartStore.pricePrecision()\n      } else {\n        techs.forEach(tech => {\n          precision = Math.max(tech.precision, precision)\n          if (!shouldFormatBigNumber) {\n            shouldFormatBigNumber = tech.shouldFormatBigNumber\n          }\n        })\n      }\n      text = formatPrecision(value, precision)\n      if (shouldFormatBigNumber) {\n        text = formatBigNumber(text)\n      }\n    }\n    let rectStartX\n    const borderSize = crosshairHorizontalTextOptions.borderSize\n\n    const rectWidth = getTextRectWidth(this._ctx, text, crosshairHorizontalTextOptions)\n    const rectHeight = getTextRectHeight(crosshairHorizontalTextOptions)\n    if (this._yAxis.isFromYAxisZero()) {\n      rectStartX = 0\n    } else {\n      rectStartX = this._width - rectWidth\n    }\n\n    const rectY = crosshair.y - borderSize - crosshairHorizontalTextOptions.paddingTop - crosshairHorizontalTextOptions.size / 2\n    // 绘制y轴文字外的边框\n    renderStrokeFillRoundRect(\n      this._ctx,\n      crosshairHorizontalTextOptions.backgroundColor,\n      crosshairHorizontalTextOptions.borderColor,\n      borderSize,\n      rectStartX,\n      rectY,\n      rectWidth,\n      rectHeight,\n      crosshairHorizontalTextOptions.borderRadius\n    )\n    renderText(\n      this._ctx,\n      crosshairHorizontalTextOptions.color,\n      rectStartX + borderSize + crosshairHorizontalTextOptions.paddingLeft,\n      crosshair.y,\n      text\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport YAxisView from '../view/YAxisView'\nimport YAxisOverlayView from '../view/YAxisOverlayView'\n\nexport default class YAxisWidget extends Widget {\n  _createMainView (container, props) {\n    return new YAxisView(container, props.chartStore, props.yAxis, props.paneId)\n  }\n\n  _createOverlayView (container, props) {\n    return new YAxisOverlayView(container, props.chartStore, props.yAxis, props.paneId)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPixelRatio } from '../../utils/canvas'\nimport { getPrecision, nice, round } from '../../utils/number'\nimport { createElement } from '../../utils/element'\n\nexport default class Axis {\n  constructor (chartStore) {\n    this._chartStore = chartStore\n    this._width = 0\n    this._height = 0\n    this._cacheMinValue = 0\n    this._cacheMaxValue = 0\n    this._minValue = 0\n    this._maxValue = 0\n    this._range = 0\n    this._ticks = []\n    this._initMeasureCanvas()\n  }\n\n  _initMeasureCanvas () {\n    const measureCanvas = createElement('canvas')\n    const pixelRatio = getPixelRatio(measureCanvas)\n    this._measureCtx = measureCanvas.getContext('2d')\n    this._measureCtx.scale(pixelRatio, pixelRatio)\n  }\n\n  min () {\n    return this._minValue\n  }\n\n  max () {\n    return this._maxValue\n  }\n\n  width () {\n    return this._width\n  }\n\n  height () {\n    return this._height\n  }\n\n  setWidth (width) {\n    this._width = width\n  }\n\n  setHeight (height) {\n    this._height = height\n  }\n\n  /**\n   * 获取ticks\n   * @returns {[]|*[]}\n   */\n  ticks () {\n    return this._ticks\n  }\n\n  /**\n   * 计算轴\n   * @param forceCompute\n   */\n  computeAxis (forceCompute) {\n    const minMax = this._optimalMinMax(this._computeMinMax())\n    this._minValue = minMax.min\n    this._maxValue = minMax.max\n    this._range = minMax.range\n    if (this._cacheMinValue !== minMax.min || this._cacheMaxValue !== minMax.max || forceCompute) {\n      this._cacheMinValue = minMax.min\n      this._cacheMaxValue = minMax.max\n      this._ticks = this._optimalTicks(this._computeTicks())\n      return true\n    }\n    return false\n  }\n\n  /**\n   * 计算最大最小值\n   * @private\n   */\n  _computeMinMax () {}\n\n  /**\n   * 优化最大最小值\n   * @param minMax\n   * @private\n   */\n  _optimalMinMax (minMax) {}\n\n  /**\n   * 计算轴上的tick值\n   */\n  _computeTicks () {\n    const ticks = []\n    if (this._range >= 0) {\n      const intervalPrecision = this._computeInterval(this._range)\n      const interval = intervalPrecision.interval\n      const precision = intervalPrecision.precision\n      const first = round(Math.ceil(this._minValue / interval) * interval, precision)\n      const last = round(Math.floor(this._maxValue / interval) * interval, precision)\n      let n = 0\n      let f = first\n\n      if (interval !== 0) {\n        while (f <= last) {\n          ticks[n] = { v: f.toFixed(precision) }\n          ++n\n          f += interval\n        }\n      }\n    }\n    return ticks\n  }\n\n  /**\n   * 计算最佳的tick\n   * @param ticks\n   */\n  _optimalTicks (ticks) {}\n\n  /**\n   * 计算间隔\n   * @private\n   */\n  _computeInterval (range) {\n    const interval = nice(range / 8.0)\n    const precision = getPrecision(interval)\n    return {\n      interval, precision\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Axis from './Axis'\nimport { CandleType, YAxisPosition, YAxisType } from '../../options/styleOptions'\nimport { isNumber, isValid } from '../../utils/typeChecks'\nimport { calcTextWidth, createFont } from '../../utils/canvas'\nimport { formatBigNumber, formatPrecision } from '../../utils/format'\nimport { round, log10, index10 } from '../../utils/number'\n\nexport default class YAxis extends Axis {\n  constructor (chartStore, isCandleYAxis, paneId) {\n    super(chartStore)\n    this._realRange = 0\n    this._isCandleYAxis = isCandleYAxis\n    this._paneId = paneId\n  }\n\n  _computeMinMax () {\n    const minMaxArray = [Number.MAX_SAFE_INTEGER, Number.MIN_SAFE_INTEGER]\n    const plotsResult = []\n    let shouldOhlc = false\n    let minValue = Number.MAX_SAFE_INTEGER\n    let maxValue = Number.MIN_SAFE_INTEGER\n    let techPrecision = Number.MAX_SAFE_INTEGER\n    const techs = this._chartStore.technicalIndicatorStore().instances(this._paneId)\n    let techGap\n    techs.forEach(tech => {\n      if (!shouldOhlc) {\n        shouldOhlc = tech.shouldOhlc\n      }\n      techPrecision = Math.min(techPrecision, tech.precision)\n      if (isNumber(tech.minValue)) {\n        minValue = Math.min(minValue, tech.minValue)\n      }\n      if (isNumber(tech.maxValue)) {\n        maxValue = Math.max(maxValue, tech.maxValue)\n      }\n      if (tech.styles) {\n        if (!techGap) {\n          techGap = { top: 0, bottom: 0 }\n        }\n        const margin = tech.styles.margin\n        if (isNumber(margin.top)) {\n          if (margin.top < 1) {\n            techGap.top = Math.max(margin.top, techGap.top)\n          } else {\n            techGap.top = Math.max(margin.top / this._height, techGap.top)\n          }\n        }\n        if (isNumber(margin.bottom)) {\n          if (margin.bottom < 1) {\n            techGap.bottom = Math.max(margin.bottom, techGap.bottom)\n          } else {\n            techGap.bottom = Math.max(margin.bottom / this._height, techGap.bottom)\n          }\n        }\n      }\n      plotsResult.push({\n        plots: tech.plots,\n        result: tech.result\n      })\n    })\n\n    let precision = 4\n    if (this._isCandleYAxis) {\n      const pricePrecision = this._chartStore.pricePrecision()\n      if (techPrecision !== Number.MAX_SAFE_INTEGER) {\n        precision = Math.min(techPrecision, pricePrecision)\n      } else {\n        precision = pricePrecision\n      }\n    } else {\n      if (techPrecision !== Number.MAX_SAFE_INTEGER) {\n        precision = techPrecision\n      }\n    }\n    const visibleDataList = this._chartStore.visibleDataList()\n    const candleOptions = this._chartStore.styleOptions().candle\n    const isArea = candleOptions.type === CandleType.AREA\n    const areaValueKey = candleOptions.area.value\n    const shouldCompareHighLow = (this._isCandleYAxis && !isArea) || (!this._isCandleYAxis && shouldOhlc)\n    visibleDataList.forEach(({ index, data }) => {\n      if (shouldCompareHighLow) {\n        minMaxArray[0] = Math.min(minMaxArray[0], data.low)\n        minMaxArray[1] = Math.max(minMaxArray[1], data.high)\n      }\n      if (this._isCandleYAxis && isArea) {\n        minMaxArray[0] = Math.min(minMaxArray[0], data[areaValueKey])\n        minMaxArray[1] = Math.max(minMaxArray[1], data[areaValueKey])\n      }\n      plotsResult.forEach(({ plots, result }) => {\n        const techData = result[index] || {}\n        plots.forEach(plot => {\n          const value = techData[plot.key]\n          if (isValid(value)) {\n            minMaxArray[0] = Math.min(minMaxArray[0], value)\n            minMaxArray[1] = Math.max(minMaxArray[1], value)\n          }\n        })\n      })\n    })\n    if (minMaxArray[0] !== Number.MAX_SAFE_INTEGER && minMaxArray[1] !== Number.MIN_SAFE_INTEGER) {\n      minMaxArray[0] = Math.min(minValue, minMaxArray[0])\n      minMaxArray[1] = Math.max(maxValue, minMaxArray[1])\n    } else {\n      minMaxArray[0] = 0\n      minMaxArray[1] = 10\n    }\n    return { min: minMaxArray[0], max: minMaxArray[1], precision, specifyMin: minValue, specifyMax: maxValue, techGap }\n  }\n\n  _optimalMinMax ({ min, max, precision, specifyMin, specifyMax, techGap }) {\n    let minValue = min\n    let maxValue = max\n    const yAxisType = this.yAxisType()\n    let dif\n    switch (yAxisType) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartStore.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          minValue = (minValue - fromData.close) / fromData.close * 100\n          maxValue = (maxValue - fromData.close) / fromData.close * 100\n        }\n        dif = Math.pow(10, -2)\n        break\n      }\n      case YAxisType.LOG: {\n        minValue = log10(minValue)\n        maxValue = log10(maxValue)\n        dif = 0.05 * index10(-precision)\n        break\n      }\n      default: {\n        dif = index10(-precision)\n      }\n    }\n    if (\n      minValue === maxValue ||\n      Math.abs(minValue - maxValue) < dif\n    ) {\n      const minCheck = specifyMin === minValue\n      const maxCheck = specifyMax === maxValue\n      minValue = minCheck ? minValue : (maxCheck ? minValue - 8 * dif : minValue - 4 * dif)\n      maxValue = maxCheck ? maxValue : (minCheck ? maxValue + 8 * dif : maxValue + 4 * dif)\n    }\n    let marginOptions\n    if (this._isCandleYAxis) {\n      marginOptions = this._chartStore.styleOptions().candle.margin\n    } else {\n      // 如果是副图，直接取指标的样式配置\n      marginOptions = techGap ? { top: 0, bottom: 0 } : this._chartStore.styleOptions().technicalIndicator.margin\n    }\n    let topRate = 0.2\n    if (isNumber(marginOptions.top)) {\n      let rate\n      if (marginOptions.top < 1) {\n        rate = marginOptions.top\n      } else {\n        rate = marginOptions.top / this._height\n      }\n      topRate = techGap ? Math.max(techGap.top, rate) : rate\n    }\n    let bottomRate = 0.1\n    if (isNumber(marginOptions.bottom)) {\n      let rate\n      if (marginOptions.bottom < 1) {\n        rate = marginOptions.bottom\n      } else {\n        rate = marginOptions.bottom / this._height\n      }\n      bottomRate = techGap ? Math.max(techGap.bottom, rate) : rate\n    }\n    let range = Math.abs(maxValue - minValue)\n    // 保证每次图形绘制上下都留间隙\n    minValue = minValue - range * bottomRate\n    maxValue = maxValue + range * topRate\n\n    range = Math.abs(maxValue - minValue)\n    if (yAxisType === YAxisType.LOG) {\n      this._realRange = Math.abs(index10(maxValue) - index10(minValue))\n    } else {\n      this._realRange = range\n    }\n    return {\n      min: minValue,\n      max: maxValue,\n      range\n    }\n  }\n\n  _optimalTicks (ticks) {\n    const optimalTicks = []\n    const yAxisType = this.yAxisType()\n    const techs = this._chartStore.technicalIndicatorStore().instances(this._paneId)\n    let precision = 0\n    let shouldFormatBigNumber = false\n    if (this._isCandleYAxis) {\n      precision = this._chartStore.pricePrecision()\n    } else {\n      techs.forEach(tech => {\n        precision = Math.max(precision, tech.precision)\n        if (!shouldFormatBigNumber) {\n          shouldFormatBigNumber = tech.shouldFormatBigNumber\n        }\n      })\n    }\n    const textHeight = this._chartStore.styleOptions().xAxis.tickText.size\n    let intervalPrecision\n    if (yAxisType === YAxisType.LOG) {\n      intervalPrecision = this._computeInterval(this._realRange)\n    }\n    let validY\n    ticks.forEach(({ v }) => {\n      let value\n      let y = this._innerConvertToPixel(+v)\n      switch (yAxisType) {\n        case YAxisType.PERCENTAGE: {\n          value = `${formatPrecision(v, 2)}%`\n          break\n        }\n        case YAxisType.LOG: {\n          value = round(index10(v), intervalPrecision.precision)\n          y = this._innerConvertToPixel(log10(value))\n          value = formatPrecision(value, precision)\n          break\n        }\n        default: {\n          value = formatPrecision(v, precision)\n          if (shouldFormatBigNumber) {\n            value = formatBigNumber(value)\n          }\n          break\n        }\n      }\n      if (y > textHeight && y < this._height - textHeight && ((validY && (validY - y > textHeight * 2)) || !validY)) {\n        optimalTicks.push({ v: value, y })\n        validY = y\n      }\n    })\n    return optimalTicks\n  }\n\n  /**\n   * 内部值转换成坐标\n   * @param value\n   * @return {number}\n   * @private\n   */\n  _innerConvertToPixel (value) {\n    return Math.round((1.0 - (value - this._minValue) / this._range) * this._height)\n  }\n\n  /**\n   * 是否是蜡烛图轴\n   * @return {*}\n   */\n  isCandleYAxis () {\n    return this._isCandleYAxis\n  }\n\n  /**\n   * y轴类型\n   * @return {string|*}\n   */\n  yAxisType () {\n    if (this._isCandleYAxis) {\n      return this._chartStore.styleOptions().yAxis.type\n    }\n    return YAxisType.NORMAL\n  }\n\n  /**\n   * 是否从y轴0开始\n   * @return {boolean|*|boolean}\n   */\n  isFromYAxisZero () {\n    const yAxisOptions = this._chartStore.styleOptions().yAxis\n    return (\n      (yAxisOptions.position === YAxisPosition.LEFT && yAxisOptions.inside) ||\n      (yAxisOptions.position === YAxisPosition.RIGHT && !yAxisOptions.inside)\n    )\n  }\n\n  /**\n   * 获取自身宽度\n   * @return {number}\n   */\n  getSelfWidth () {\n    const styleOptions = this._chartStore.styleOptions()\n    const yAxisOptions = styleOptions.yAxis\n    const width = yAxisOptions.width\n    if (isNumber(width)) {\n      return width\n    }\n    let yAxisWidth = 0\n    if (yAxisOptions.show) {\n      if (yAxisOptions.axisLine.show) {\n        yAxisWidth += yAxisOptions.axisLine.size\n      }\n      if (yAxisOptions.tickLine.show) {\n        yAxisWidth += yAxisOptions.tickLine.length\n      }\n      if (yAxisOptions.tickText.show) {\n        let textWidth = 0\n        this._measureCtx.font = createFont(yAxisOptions.tickText.size, yAxisOptions.tickText.weight, yAxisOptions.tickText.family)\n        this._ticks.forEach(tick => {\n          textWidth = Math.max(textWidth, calcTextWidth(this._measureCtx, tick.v))\n        })\n        yAxisWidth += (yAxisOptions.tickText.paddingLeft + yAxisOptions.tickText.paddingRight + textWidth)\n      }\n    }\n    const crosshairOptions = styleOptions.crosshair\n    let crosshairVerticalTextWidth = 0\n    if (\n      crosshairOptions.show &&\n      crosshairOptions.horizontal.show &&\n      crosshairOptions.horizontal.text.show\n    ) {\n      const techs = this._chartStore.technicalIndicatorStore().instances(this._paneId)\n      let techPrecision = 0\n      let shouldFormatBigNumber = false\n      techs.forEach(tech => {\n        techPrecision = Math.max(tech.precision, techPrecision)\n        if (!shouldFormatBigNumber) {\n          shouldFormatBigNumber = tech.shouldFormatBigNumber\n        }\n      })\n      this._measureCtx.font = createFont(\n        crosshairOptions.horizontal.text.size,\n        crosshairOptions.horizontal.text.weight,\n        crosshairOptions.horizontal.text.family\n      )\n      let precision = 2\n      if (this.yAxisType() !== YAxisType.PERCENTAGE) {\n        if (this._isCandleYAxis) {\n          const pricePrecision = this._chartStore.pricePrecision()\n          const lastValueMarkOptions = styleOptions.technicalIndicator.lastValueMark\n          if (lastValueMarkOptions.show && lastValueMarkOptions.text.show) {\n            precision = Math.max(techPrecision, pricePrecision)\n          } else {\n            precision = pricePrecision\n          }\n        } else {\n          precision = techPrecision\n        }\n      }\n      let valueText = formatPrecision(this._maxValue, precision)\n      if (shouldFormatBigNumber) {\n        valueText = formatBigNumber(valueText)\n      }\n      crosshairVerticalTextWidth += (\n        crosshairOptions.horizontal.text.paddingLeft +\n        crosshairOptions.horizontal.text.paddingRight +\n        crosshairOptions.horizontal.text.borderSize * 2 +\n        calcTextWidth(this._measureCtx, valueText)\n      )\n    }\n    return Math.max(yAxisWidth, crosshairVerticalTextWidth)\n  }\n\n  convertFromPixel (pixel) {\n    const value = (1.0 - pixel / this._height) * this._range + this._minValue\n    switch (this.yAxisType()) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartStore.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          return fromData.close * value / 100 + fromData.close\n        }\n        break\n      }\n      case YAxisType.LOG: {\n        return index10(value)\n      }\n      default: {\n        return value\n      }\n    }\n  }\n\n  convertToPixel (value) {\n    let v\n    switch (this.yAxisType()) {\n      case YAxisType.PERCENTAGE: {\n        const fromData = (this._chartStore.visibleDataList()[0] || {}).data || {}\n        if (isNumber(fromData.close)) {\n          v = (value - fromData.close) / fromData.close * 100\n        }\n        break\n      }\n      case YAxisType.LOG: {\n        v = log10(value)\n        break\n      }\n      default: {\n        v = value\n      }\n    }\n    return this._innerConvertToPixel(v)\n  }\n\n  /**\n   * 将值转换成坐标，即使坐标不在范围内，也会显示在顶部或者底部\n   * @param value\n   * @return {number}\n   */\n  convertToNicePixel (value) {\n    const y = this.convertToPixel(value)\n    return Math.round(Math.max(this._height * 0.05, Math.min(y, this._height * 0.98)))\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Pane from './Pane'\nimport TechnicalIndicatorWidget from '../widget/TechnicalIndicatorWidget'\nimport YAxisWidget from '../widget/YAxisWidget'\nimport YAxis from '../component/axis/YAxis'\n\nexport default class TechnicalIndicatorPane extends Pane {\n  constructor (props) {\n    super(props)\n    if ('height' in props) {\n      this.setHeight(props.height)\n    }\n  }\n\n  _initBefore (props) {\n    this._id = props.id\n    this._yAxis = this._createYAxis(props)\n  }\n\n  _createYAxis (props) {\n    return new YAxis(\n      props.chartStore,\n      false,\n      props.id\n    )\n  }\n\n  _createMainWidget (container, props) {\n    return new TechnicalIndicatorWidget({\n      container,\n      chartStore: props.chartStore,\n      xAxis: props.xAxis,\n      yAxis: this._yAxis,\n      paneId: props.id\n    })\n  }\n\n  _createYAxisWidget (container, props) {\n    return new YAxisWidget({\n      container,\n      chartStore: props.chartStore,\n      yAxis: this._yAxis,\n      paneId: props.id\n    })\n  }\n\n  setHeight (height) {\n    super.setHeight(height)\n    this._yAxis.setHeight(height)\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    super.setWidth(mainWidgetWidth, yAxisWidgetWidth)\n    this._yAxis.setWidth(yAxisWidgetWidth)\n  }\n\n  /**\n   * 获取id\n   * @returns {string}\n   */\n  id () {\n    return this._id\n  }\n\n  yAxis () {\n    return this._yAxis\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorView from './TechnicalIndicatorView'\nimport { CandleType, LineStyle } from '../options/styleOptions'\nimport { renderHorizontalLine, renderLine } from '../renderer/line'\nimport { renderFillPath } from '../renderer/path'\nimport { createFont } from '../utils/canvas'\nimport { formatPrecision, formatValue } from '../utils/format'\nimport { isArray, isNumber } from '../utils/typeChecks'\n\nexport default class CandleView extends TechnicalIndicatorView {\n  _drawContent () {\n    const candleOptions = this._chartStore.styleOptions().candle\n    this._drawLastPriceLine(candleOptions.priceMark)\n    if (candleOptions.type === CandleType.AREA) {\n      this._drawArea(candleOptions)\n    } else {\n      this._drawLowHighPrice(\n        candleOptions.priceMark,\n        'high',\n        'high',\n        Number.MIN_SAFE_INTEGER,\n        [-2, -5],\n        (price, comparePrice) => {\n          if (price > comparePrice) {\n            return price\n          }\n        }\n      )\n      this._drawLowHighPrice(\n        candleOptions.priceMark,\n        'low',\n        'low',\n        Number.MAX_SAFE_INTEGER,\n        [2, 5],\n        (price, comparePrice) => {\n          if (price < comparePrice) {\n            return price\n          }\n        }\n      )\n      this._drawCandle(candleOptions)\n    }\n    this._drawTechs()\n    this._drawGrid()\n  }\n\n  /**\n   * 绘制面积图\n   * @param candleOptions\n   * @private\n   */\n  _drawArea (candleOptions) {\n    const lineCoordinates = []\n    const areaCoordinates = []\n    let minY = Number.MAX_SAFE_INTEGER\n    const areaOptions = candleOptions.area\n    const onDrawing = (x, i, kLineData, halfBarSpace, barSpace, n) => {\n      const value = kLineData[areaOptions.value]\n      if (isNumber(value)) {\n        const y = this._yAxis.convertToPixel(value)\n        if (n === 0) {\n          const startX = x - halfBarSpace\n          areaCoordinates.push({ x: startX, y: this._height })\n          areaCoordinates.push({ x: startX, y })\n          lineCoordinates.push({ x: startX, y })\n        }\n        lineCoordinates.push({ x, y })\n        areaCoordinates.push({ x, y })\n        minY = Math.min(minY, y)\n      }\n    }\n    const onDrawEnd = () => {\n      const areaCoordinateLength = areaCoordinates.length\n      if (areaCoordinateLength > 0) {\n        const lastCoordinate = areaCoordinates[areaCoordinateLength - 1]\n        const halfBarSpace = this._chartStore.timeScaleStore().halfBarSpace()\n        const endX = lastCoordinate.x + halfBarSpace\n        lineCoordinates.push({ x: endX, y: lastCoordinate.y })\n        areaCoordinates.push({ x: endX, y: lastCoordinate.y })\n        areaCoordinates.push({ x: endX, y: this._height })\n      }\n\n      if (lineCoordinates.length > 0) {\n        // 绘制分时线\n        this._ctx.lineWidth = areaOptions.lineSize\n        this._ctx.strokeStyle = areaOptions.lineColor\n        renderLine(this._ctx, lineCoordinates)\n      }\n\n      if (areaCoordinates.length > 0) {\n        // 绘制分时线填充区域\n        const backgroundColor = areaOptions.backgroundColor\n        if (isArray(backgroundColor)) {\n          const gradient = this._ctx.createLinearGradient(0, this._height, 0, minY)\n          try {\n            backgroundColor.forEach(({ offset, color }) => {\n              gradient.addColorStop(offset, color)\n            })\n          } catch (e) {\n          }\n          this._ctx.fillStyle = gradient\n        } else {\n          this._ctx.fillStyle = backgroundColor\n        }\n        renderFillPath(this._ctx, areaCoordinates)\n      }\n    }\n    this._drawGraphics(onDrawing, onDrawEnd)\n  }\n\n  /**\n   * 绘制蜡烛\n   * @param candleOptions\n   * @private\n   */\n  _drawCandle (candleOptions) {\n    this._drawGraphics((x, i, kLineData, halfBarSpace, barSpace) => {\n      this._drawCandleBar(x, halfBarSpace, barSpace, i, kLineData, candleOptions.bar, candleOptions.type)\n    })\n  }\n\n  /**\n   * 渲染最高最低价格\n   * @param priceMarkOptions\n   * @param optionKey\n   * @param priceKey\n   * @param initPriceValue\n   * @param offsets\n   * @param compare\n   * @private\n   */\n  _drawLowHighPrice (priceMarkOptions, optionKey, priceKey, initPriceValue, offsets, compare) {\n    const lowHighPriceMarkOptions = priceMarkOptions[optionKey]\n    if (!priceMarkOptions.show || !lowHighPriceMarkOptions.show) {\n      return\n    }\n    const visibleDataList = this._chartStore.visibleDataList()\n    let price = initPriceValue\n    let pos = -1\n    visibleDataList.forEach(({ index, data }) => {\n      const comparePrice = compare(formatValue(data, priceKey, initPriceValue), price)\n      if (comparePrice) {\n        price = comparePrice\n        pos = index\n      }\n    })\n    const pricePrecision = this._chartStore.pricePrecision()\n    const priceY = this._yAxis.convertToPixel(price)\n    const startX = this._xAxis.convertToPixel(pos)\n    const startY = priceY + offsets[0]\n    this._ctx.textAlign = 'left'\n    this._ctx.lineWidth = 1\n    this._ctx.strokeStyle = lowHighPriceMarkOptions.color\n    this._ctx.fillStyle = lowHighPriceMarkOptions.color\n\n    renderLine(\n      this._ctx,\n      [\n        { x: startX - 2, y: startY + offsets[0] },\n        { x: startX, y: startY },\n        { x: startX + 2, y: startY + offsets[0] }\n      ]\n    )\n\n    // 绘制竖线\n    const y = startY + offsets[1]\n    renderLine(\n      this._ctx,\n      [\n        { x: startX, y: startY },\n        { x: startX, y },\n        { x: startX + 5, y }\n      ]\n    )\n\n    this._ctx.font = createFont(lowHighPriceMarkOptions.textSize, lowHighPriceMarkOptions.textWeight, lowHighPriceMarkOptions.textFamily)\n    const text = formatPrecision(price, pricePrecision)\n    this._ctx.textBaseline = 'middle'\n    this._ctx.fillText(text, startX + 5 + lowHighPriceMarkOptions.textMargin, y)\n  }\n\n  /**\n   * 绘制最新价线\n   * @param priceMarkOptions\n   * @private\n   */\n  _drawLastPriceLine (priceMarkOptions) {\n    const lastPriceMarkOptions = priceMarkOptions.last\n    if (!priceMarkOptions.show || !lastPriceMarkOptions.show || !lastPriceMarkOptions.line.show) {\n      return\n    }\n    const dataList = this._chartStore.dataList()\n    const kLineData = dataList[dataList.length - 1]\n    if (!kLineData) {\n      return\n    }\n    const close = kLineData.close\n    const open = kLineData.open\n    const priceY = this._yAxis.convertToNicePixel(close)\n    let color\n    if (close > open) {\n      color = lastPriceMarkOptions.upColor\n    } else if (close < open) {\n      color = lastPriceMarkOptions.downColor\n    } else {\n      color = lastPriceMarkOptions.noChangeColor\n    }\n    this._ctx.save()\n    this._ctx.strokeStyle = color\n    this._ctx.lineWidth = lastPriceMarkOptions.line.size\n    if (lastPriceMarkOptions.line.style === LineStyle.DASH) {\n      this._ctx.setLineDash(lastPriceMarkOptions.line.dashValue)\n    }\n    renderHorizontalLine(this._ctx, priceY, 0, this._width)\n    this._ctx.restore()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorOverlayView from './TechnicalIndicatorOverlayView'\nimport { isFunction, isObject, isArray, isValid } from '../utils/typeChecks'\nimport { formatBigNumber, formatDate, formatPrecision, formatValue } from '../utils/format'\nimport { calcTextWidth, createFont } from '../utils/canvas'\nimport { TooltipShowType } from '../options/styleOptions'\nimport { renderFillRoundRect, renderStrokeRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class CandleOverlayView extends TechnicalIndicatorOverlayView {\n  _drawTooltip (crosshair, techs) {\n    const styleOptions = this._chartStore.styleOptions()\n    const candleOptions = styleOptions.candle\n    const candleTooltipOptions = candleOptions.tooltip\n    const techOptions = styleOptions.technicalIndicator\n    const techTooltipOptions = techOptions.tooltip\n    const isDrawCandleTooltip = this._shouldDrawTooltip(crosshair, candleTooltipOptions)\n    const isDrawTechTooltip = this._shouldDrawTooltip(crosshair, techTooltipOptions)\n    if (\n      candleTooltipOptions.showType === TooltipShowType.RECT &&\n      techTooltipOptions.showType === TooltipShowType.RECT\n    ) {\n      this._drawCandleTooltipWithRect(\n        crosshair,\n        techs,\n        candleOptions,\n        isDrawCandleTooltip,\n        techOptions,\n        isDrawTechTooltip\n      )\n    } else {\n      if (candleTooltipOptions.showType === TooltipShowType.STANDARD) {\n        this._drawCandleTooltipWithStandard(crosshair.kLineData, candleOptions, isDrawCandleTooltip)\n        if (techTooltipOptions.showType === TooltipShowType.STANDARD) {\n          const offsetTop = isDrawCandleTooltip ? candleTooltipOptions.text.size + candleTooltipOptions.text.marginTop : 0\n          this._drawBatchTechToolTip(\n            crosshair,\n            techs,\n            techOptions,\n            offsetTop,\n            isDrawTechTooltip\n          )\n        } else {\n          this._drawCandleTooltipWithRect(\n            crosshair,\n            techs,\n            candleOptions,\n            false,\n            techOptions,\n            isDrawTechTooltip\n          )\n        }\n      } else {\n        this._drawCandleTooltipWithRect(\n          crosshair,\n          techs,\n          candleOptions,\n          isDrawCandleTooltip,\n          techOptions,\n          false\n        )\n        this._drawBatchTechToolTip(\n          crosshair,\n          techs,\n          techOptions,\n          0,\n          isDrawTechTooltip\n        )\n      }\n    }\n  }\n\n  /**\n   * 绘制蜡烛默认的图例\n   * @param kLineData\n   * @param candleOptions\n   * @param isDrawCandleTooltip\n   * @private\n   */\n  _drawCandleTooltipWithStandard (kLineData, candleOptions, isDrawCandleTooltip) {\n    if (!isDrawCandleTooltip) {\n      return\n    }\n    const values = this._getCandleTooltipData(kLineData, candleOptions)\n    const candleTooltipOptions = candleOptions.tooltip\n    const textMarginLeft = candleTooltipOptions.text.marginLeft\n    const textMarginRight = candleTooltipOptions.text.marginRight\n    const textSize = candleTooltipOptions.text.size\n    const textColor = candleTooltipOptions.text.color\n    const labels = candleTooltipOptions.labels\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(textSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family)\n    let labelX = textMarginLeft\n    const labelY = candleTooltipOptions.text.marginTop\n    labels.forEach((label, i) => {\n      const labelWidth = calcTextWidth(this._ctx, label)\n      renderText(this._ctx, textColor, labelX, labelY, label)\n      labelX += labelWidth\n\n      const value = values[i] || candleTooltipOptions.defaultValue\n      let valueText\n      let valueColor\n      if (isObject(value)) {\n        valueText = value.value || candleTooltipOptions.defaultValue\n        valueColor = value.color || textColor\n      } else {\n        valueColor = textColor\n        valueText = value\n      }\n      const textWidth = calcTextWidth(this._ctx, valueText)\n      renderText(this._ctx, valueColor, labelX, labelY, valueText)\n      labelX += (textWidth + textMarginLeft + textMarginRight)\n    })\n  }\n\n  /**\n   * 绘制蜡烛图矩形类型图例\n   * @param crosshair\n   * @param techs\n   * @param candleOptions\n   * @param isDrawCandleTooltip\n   * @param techOptions\n   * @param isDrawTechTooltip\n   * @private\n   */\n  _drawCandleTooltipWithRect (\n    crosshair, techs, candleOptions, isDrawCandleTooltip,\n    techOptions, isDrawTechTooltip\n  ) {\n    if (!isDrawCandleTooltip && !isDrawTechTooltip) {\n      return\n    }\n    const candleTooltipOptions = candleOptions.tooltip\n    const baseLabels = candleTooltipOptions.labels\n    const baseValues = this._getCandleTooltipData(crosshair.kLineData, candleOptions)\n    const baseTextMarginLeft = candleTooltipOptions.text.marginLeft\n    const baseTextMarginRight = candleTooltipOptions.text.marginRight\n    const baseTextMarginTop = candleTooltipOptions.text.marginTop\n    const baseTextMarginBottom = candleTooltipOptions.text.marginBottom\n    const baseTextSize = candleTooltipOptions.text.size\n    const baseTextColor = candleTooltipOptions.text.color\n\n    const rectOptions = candleTooltipOptions.rect\n    const rectBorderSize = rectOptions.borderSize\n    const rectPaddingLeft = rectOptions.paddingLeft\n    const rectPaddingRight = rectOptions.paddingRight\n    const rectPaddingTop = rectOptions.paddingTop\n    const rectPaddingBottom = rectOptions.paddingBottom\n    const rectLeft = rectOptions.offsetLeft\n    const rectRight = rectOptions.offsetRight\n\n    let maxLabelWidth = 0\n    let rectWidth = 0\n    let rectHeight = 0\n    this._ctx.save()\n    this._ctx.textBaseline = 'top'\n    if (isDrawCandleTooltip) {\n      this._ctx.font = createFont(baseTextSize, candleTooltipOptions.text.weight, candleTooltipOptions.text.family)\n      baseLabels.forEach((label, i) => {\n        const value = baseValues[i]\n        let v\n        if (isObject(value)) {\n          v = value.value || candleTooltipOptions.defaultValue\n        } else {\n          v = value\n        }\n        const text = `${label}${v}`\n        const labelWidth = calcTextWidth(this._ctx, text) + baseTextMarginLeft + baseTextMarginRight\n        maxLabelWidth = Math.max(maxLabelWidth, labelWidth)\n      })\n      rectHeight += ((baseTextMarginBottom + baseTextMarginTop + baseTextSize) * baseLabels.length)\n    }\n\n    const techTooltipOptions = techOptions.tooltip\n\n    const techTooltipTextMarginLeft = techTooltipOptions.text.marginLeft\n    const techTooltipTextMarginRight = techTooltipOptions.text.marginRight\n    const techTooltipTextMarginTop = techTooltipOptions.text.marginTop\n    const techTooltipTextMarginBottom = techTooltipOptions.text.marginBottom\n    const techTooltipTextSize = techTooltipOptions.text.size\n    const techTooltipDataList = techs.map(tech => this._getTechTooltipData(crosshair, tech, techOptions))\n    if (isDrawTechTooltip) {\n      this._ctx.font = createFont(\n        techTooltipTextSize,\n        techTooltipOptions.text.weight,\n        techTooltipOptions.text.family\n      )\n      techTooltipDataList.forEach(tooltipData => {\n        tooltipData.values.forEach(({ title, value }) => {\n          if (isValid(title)) {\n            const text = `${title}${value}`\n            const labelWidth = calcTextWidth(this._ctx, text) + techTooltipTextMarginLeft + techTooltipTextMarginRight\n            maxLabelWidth = Math.max(maxLabelWidth, labelWidth)\n            rectHeight += (techTooltipTextMarginTop + techTooltipTextMarginBottom + techTooltipTextSize)\n          }\n        })\n      })\n    }\n    rectWidth += maxLabelWidth\n    if (rectWidth === 0 || rectHeight === 0) {\n      return\n    }\n    rectWidth += (rectBorderSize * 2 + rectPaddingLeft + rectPaddingRight)\n    rectHeight += (rectBorderSize * 2 + rectPaddingTop + rectPaddingBottom)\n    const centerX = this._width / 2\n    let rectX\n    if (crosshair.realX < centerX) {\n      rectX = this._width - rectRight - rectWidth\n    } else {\n      rectX = rectLeft\n    }\n    const rectY = rectOptions.offsetTop\n    const radius = rectOptions.borderRadius\n    renderFillRoundRect(this._ctx, rectOptions.backgroundColor, rectX, rectY, rectWidth, rectHeight, radius)\n    renderStrokeRoundRect(this._ctx, rectOptions.borderColor, rectBorderSize, rectX, rectY, rectWidth, rectHeight, radius)\n    const baseLabelX = rectX + rectBorderSize + rectPaddingLeft + baseTextMarginLeft\n    let labelY = rectY + rectBorderSize + rectPaddingTop\n    if (isDrawCandleTooltip) {\n      // 开始渲染基础数据文字\n      this._ctx.font = createFont(\n        baseTextSize,\n        candleTooltipOptions.text.weight,\n        candleTooltipOptions.text.family\n      )\n      baseLabels.forEach((label, i) => {\n        labelY += baseTextMarginTop\n        this._ctx.textAlign = 'left'\n        renderText(this._ctx, baseTextColor, baseLabelX, labelY, label)\n\n        const value = baseValues[i]\n        let text\n        let color\n        if (isObject(value)) {\n          color = value.color || baseTextColor\n          text = value.value || candleTooltipOptions.defaultValue\n        } else {\n          color = baseTextColor\n          text = value || candleTooltipOptions.defaultValue\n        }\n        this._ctx.textAlign = 'right'\n        renderText(\n          this._ctx,\n          color,\n          rectX + rectWidth - rectBorderSize - baseTextMarginRight - rectPaddingRight,\n          labelY,\n          text\n        )\n        labelY += (baseTextSize + baseTextMarginBottom)\n      })\n    }\n    if (isDrawTechTooltip) {\n      // 开始渲染指标数据文字\n      const indicatorLabelX = rectX + rectBorderSize + rectPaddingLeft + techTooltipTextMarginLeft\n      this._ctx.font = createFont(\n        techTooltipTextSize,\n        techTooltipOptions.text.weight,\n        techTooltipOptions.text.family\n      )\n      techTooltipDataList.forEach(tooltipData => {\n        tooltipData.values.forEach(v => {\n          labelY += techTooltipTextMarginTop\n          this._ctx.textAlign = 'left'\n          this._ctx.fillStyle = v.color\n          this._ctx.fillText(v.title, indicatorLabelX, labelY)\n          this._ctx.textAlign = 'right'\n          this._ctx.fillText(\n            v.value,\n            rectX + rectWidth - rectBorderSize - techTooltipTextMarginRight - rectPaddingRight,\n            labelY\n          )\n          labelY += (techTooltipTextSize + techTooltipTextMarginBottom)\n        })\n      })\n    }\n    this._ctx.restore()\n  }\n\n  /**\n   * 获取蜡烛提示数据\n   * @param kLineData\n   * @param candleOptions\n   * @returns {*}\n   * @private\n   */\n  _getCandleTooltipData (kLineData, candleOptions) {\n    const baseValues = candleOptions.tooltip.values\n    let values = []\n    if (baseValues) {\n      if (isFunction(baseValues)) {\n        values = baseValues(kLineData, candleOptions) || []\n      } else if (isArray(baseValues)) {\n        values = baseValues\n      }\n    } else {\n      const pricePrecision = this._chartStore.pricePrecision()\n      const volumePrecision = this._chartStore.volumePrecision()\n      values = [\n        formatValue(kLineData, 'timestamp'),\n        formatValue(kLineData, 'open'),\n        formatValue(kLineData, 'close'),\n        formatValue(kLineData, 'high'),\n        formatValue(kLineData, 'low'),\n        formatValue(kLineData, 'volume')\n      ]\n      values.forEach((value, index) => {\n        switch (index) {\n          case 0: {\n            values[index] = formatDate(this._chartStore.timeScaleStore().dateTimeFormat(), value, 'YYYY-MM-DD hh:mm')\n            break\n          }\n          case values.length - 1: {\n            values[index] = formatBigNumber(formatPrecision(value, volumePrecision))\n            break\n          }\n          default: {\n            values[index] = formatPrecision(value, pricePrecision)\n            break\n          }\n        }\n      })\n    }\n    return values\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport CandleView from '../view/CandleView'\nimport CandleOverlayView from '../view/CandleOverlayView'\nimport TechnicalIndicatorWidget from './TechnicalIndicatorWidget'\n\nexport default class CandleWidget extends TechnicalIndicatorWidget {\n  _createMainView (container, props) {\n    return new CandleView(container, props.chartStore, props.xAxis, props.yAxis, props.paneId)\n  }\n\n  _createOverlayView (container, props) {\n    return new CandleOverlayView(container, props.chartStore, props.xAxis, props.yAxis, props.paneId)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport TechnicalIndicatorPane from './TechnicalIndicatorPane'\nimport CandleWidget from '../widget/CandleWidget'\nimport YAxis from '../component/axis/YAxis'\n\nexport default class CandlePane extends TechnicalIndicatorPane {\n  _createYAxis (props) {\n    return new YAxis(props.chartStore, true, props.id)\n  }\n\n  _createMainWidget (container, props) {\n    return new CandleWidget({\n      container,\n      chartStore: props.chartStore,\n      xAxis: props.xAxis,\n      yAxis: this._yAxis,\n      paneId: props.id\n    })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\nimport { renderHorizontalLine, renderVerticalLine } from '../renderer/line'\nimport { createFont } from '../utils/canvas'\n\nexport default class XAxisView extends View {\n  constructor (container, chartStore, xAxis) {\n    super(container, chartStore)\n    this._xAxis = xAxis\n  }\n\n  _draw () {\n    const xAxisOptions = this._chartStore.styleOptions().xAxis\n    if (xAxisOptions.show) {\n      this._drawAxisLine(xAxisOptions)\n      this._drawTickLines(xAxisOptions)\n      this._drawTickLabels(xAxisOptions)\n    }\n  }\n\n  _drawAxisLine (xAxisOptions) {\n    const xAxisLine = xAxisOptions.axisLine\n    if (!xAxisLine.show) {\n      return\n    }\n    this._ctx.strokeStyle = xAxisLine.color\n    this._ctx.lineWidth = xAxisLine.size\n    renderHorizontalLine(this._ctx, 0, 0, this._width)\n  }\n\n  _drawTickLines (xAxisOptions) {\n    const tickLine = xAxisOptions.tickLine\n    if (!tickLine.show) {\n      return\n    }\n    this._ctx.lineWidth = tickLine.size\n    this._ctx.strokeStyle = tickLine.color\n\n    const startY = xAxisOptions.axisLine.show ? xAxisOptions.axisLine.size : 0\n\n    const endY = startY + tickLine.length\n    this._xAxis.ticks().forEach(tick => {\n      renderVerticalLine(this._ctx, tick.x, startY, endY)\n    })\n  }\n\n  _drawTickLabels (xAxisOptions) {\n    const tickText = xAxisOptions.tickText\n    if (!tickText.show) {\n      return\n    }\n    const tickLine = xAxisOptions.tickLine\n\n    this._ctx.textBaseline = 'top'\n    this._ctx.font = createFont(tickText.size, tickText.weight, tickText.family)\n    this._ctx.textAlign = 'center'\n    this._ctx.fillStyle = tickText.color\n\n    let labelY = tickText.paddingTop\n    if (xAxisOptions.axisLine.show) {\n      labelY += (xAxisOptions.axisLine.size)\n    }\n    if (tickLine.show) {\n      labelY += (tickLine.length)\n    }\n    const ticks = this._xAxis.ticks()\n    const tickLength = ticks.length\n    for (let i = 0; i < tickLength; i++) {\n      this._ctx.fillText(ticks[i].v, ticks[i].x, labelY)\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport View from './View'\n\nimport { formatDate } from '../utils/format'\nimport { getTextRectWidth, getTextRectHeight } from '../utils/canvas'\nimport { renderStrokeFillRoundRect } from '../renderer/rect'\nimport { renderText } from '../renderer/text'\n\nexport default class XAxisOverlayView extends View {\n  constructor (container, chartStore, xAxis) {\n    super(container, chartStore)\n    this._xAxis = xAxis\n  }\n\n  _draw () {\n    this._drawCrosshairLabel()\n  }\n\n  _drawCrosshairLabel () {\n    const crosshair = this._chartStore.crosshairStore().get()\n    if (!crosshair.paneId) {\n      return\n    }\n    const crosshairOptions = this._chartStore.styleOptions().crosshair\n    const crosshairVerticalOptions = crosshairOptions.vertical\n    const crosshairVerticalTextOptions = crosshairVerticalOptions.text\n    if (\n      !crosshairOptions.show ||\n      !crosshairVerticalOptions.show ||\n      !crosshairVerticalTextOptions.show ||\n      crosshair.dataIndex !== crosshair.realDataIndex\n    ) {\n      return\n    }\n\n    const timestamp = crosshair.kLineData.timestamp\n    const text = formatDate(this._chartStore.timeScaleStore().dateTimeFormat(), timestamp, 'YYYY-MM-DD hh:mm')\n\n    const paddingLeft = crosshairVerticalTextOptions.paddingLeft\n    const paddingRight = crosshairVerticalTextOptions.paddingRight\n    const paddingTop = crosshairVerticalTextOptions.paddingTop\n    const borderSize = crosshairVerticalTextOptions.borderSize\n\n    const rectWidth = getTextRectWidth(this._ctx, text, crosshairVerticalTextOptions)\n    const rectHeight = getTextRectHeight(crosshairVerticalTextOptions)\n    const labelWidth = rectWidth - borderSize * 2 - paddingLeft - paddingRight\n\n    let labelX = crosshair.realX - labelWidth / 2\n\n    // 保证整个x轴上的提示文字总是完全显示\n    if (labelX < paddingLeft + borderSize) {\n      labelX = paddingLeft + borderSize\n    } else if (labelX > this._width - labelWidth - borderSize - paddingRight) {\n      labelX = this._width - labelWidth - borderSize - paddingRight\n    }\n\n    const rectX = labelX - borderSize - paddingLeft\n\n    renderStrokeFillRoundRect(\n      this._ctx,\n      crosshairVerticalTextOptions.backgroundColor,\n      crosshairVerticalTextOptions.borderColor,\n      borderSize,\n      rectX,\n      0,\n      rectWidth,\n      rectHeight,\n      crosshairVerticalTextOptions.borderRadius\n    )\n    // 绘制轴上的提示文字\n    this._ctx.textBaseline = 'top'\n    renderText(\n      this._ctx, crosshairVerticalTextOptions.color,\n      labelX, borderSize + paddingTop, text\n    )\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Widget from './Widget'\nimport XAxisView from '../view/XAxisView'\nimport XAxisOverlayView from '../view/XAxisOverlayView'\n\nexport default class XAxisWidget extends Widget {\n  _createMainView (container, props) {\n    return new XAxisView(container, props.chartStore, props.xAxis)\n  }\n\n  _createOverlayView (container, props) {\n    return new XAxisOverlayView(container, props.chartStore, props.xAxis)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Axis from './Axis'\nimport { calcTextWidth, createFont } from '../../utils/canvas'\nimport { formatDate } from '../../utils/format'\nimport { isNumber } from '../../utils/typeChecks'\n\nexport default class XAxis extends Axis {\n  _computeMinMax () {\n    return { min: this._chartStore.timeScaleStore().from(), max: this._chartStore.timeScaleStore().to() - 1 }\n  }\n\n  _optimalMinMax ({ min, max }) {\n    return {\n      min,\n      max,\n      range: max - min + 1\n    }\n  }\n\n  _optimalTicks (ticks) {\n    const optimalTicks = []\n    const tickLength = ticks.length\n    const dataList = this._chartStore.dataList()\n    if (tickLength > 0) {\n      const dateTimeFormat = this._chartStore.timeScaleStore().dateTimeFormat()\n      const tickText = this._chartStore.styleOptions().xAxis.tickText\n      this._measureCtx.font = createFont(tickText.size, tickText.weight, tickText.family)\n      const defaultLabelWidth = calcTextWidth(this._measureCtx, '00-00 00:00')\n      const pos = parseInt(ticks[0].v, 10)\n      const x = this.convertToPixel(pos)\n      let tickCountDif = 1\n      if (tickLength > 1) {\n        const nextPos = parseInt(ticks[1].v, 10)\n        const nextX = this.convertToPixel(nextPos)\n        const xDif = Math.abs(nextX - x)\n        if (xDif < defaultLabelWidth) {\n          tickCountDif = Math.ceil(defaultLabelWidth / xDif)\n        }\n      }\n      for (let i = 0; i < tickLength; i += tickCountDif) {\n        const pos = parseInt(ticks[i].v, 10)\n        const kLineData = dataList[pos]\n        const timestamp = kLineData.timestamp\n        let label = formatDate(dateTimeFormat, timestamp, 'hh:mm')\n        if (i !== 0) {\n          const prePos = parseInt(ticks[i - tickCountDif].v, 10)\n          const preKLineData = dataList[prePos]\n          const preTimestamp = preKLineData.timestamp\n          label = this._optimalTickLabel(dateTimeFormat, timestamp, preTimestamp) || label\n        }\n        const x = this.convertToPixel(pos)\n        optimalTicks.push({ v: label, x, oV: timestamp })\n      }\n      const optimalTickLength = optimalTicks.length\n      if (optimalTickLength === 1) {\n        optimalTicks[0].v = formatDate(dateTimeFormat, optimalTicks[0].oV, 'YYYY-MM-DD hh:mm')\n      } else {\n        const firstTimestamp = optimalTicks[0].oV\n        const secondTimestamp = optimalTicks[1].oV\n        if (optimalTicks[2]) {\n          const thirdV = optimalTicks[2].v\n          if (/^[0-9]{2}-[0-9]{2}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'MM-DD')\n          } else if (/^[0-9]{4}-[0-9]{2}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'YYYY-MM')\n          } else if (/^[0-9]{4}$/.test(thirdV)) {\n            optimalTicks[0].v = formatDate(dateTimeFormat, firstTimestamp, 'YYYY')\n          }\n        } else {\n          optimalTicks[0].v = this._optimalTickLabel(dateTimeFormat, firstTimestamp, secondTimestamp) || optimalTicks[0].v\n        }\n      }\n    }\n    return optimalTicks\n  }\n\n  _optimalTickLabel (dateTimeFormat, timestamp, comparedTimestamp) {\n    const year = formatDate(dateTimeFormat, timestamp, 'YYYY')\n    const month = formatDate(dateTimeFormat, timestamp, 'YYYY-MM')\n    const day = formatDate(dateTimeFormat, timestamp, 'MM-DD')\n    if (year !== formatDate(dateTimeFormat, comparedTimestamp, 'YYYY')) {\n      return year\n    } else if (month !== formatDate(dateTimeFormat, comparedTimestamp, 'YYYY-MM')) {\n      return month\n    } else if (day !== formatDate(dateTimeFormat, comparedTimestamp, 'MM-DD')) {\n      return day\n    }\n    return null\n  }\n\n  /**\n   * 获取自身高度\n   */\n  getSelfHeight () {\n    const stylOptions = this._chartStore.styleOptions()\n    const xAxisOptions = stylOptions.xAxis\n    const height = xAxisOptions.height\n    if (isNumber(height)) {\n      return height\n    }\n    const crosshairOptions = stylOptions.crosshair\n    let xAxisHeight = 0\n    if (xAxisOptions.show) {\n      if (xAxisOptions.axisLine.show) {\n        xAxisHeight += xAxisOptions.axisLine.size\n      }\n      if (xAxisOptions.tickLine.show) {\n        xAxisHeight += xAxisOptions.tickLine.length\n      }\n      if (xAxisOptions.tickText.show) {\n        xAxisHeight += (xAxisOptions.tickText.paddingTop + xAxisOptions.tickText.paddingBottom + xAxisOptions.tickText.size)\n      }\n    }\n    let crosshairVerticalTextHeight = 0\n    if (\n      crosshairOptions.show &&\n      crosshairOptions.vertical.show &&\n      crosshairOptions.vertical.text.show\n    ) {\n      crosshairVerticalTextHeight += (\n        crosshairOptions.vertical.text.paddingTop +\n        crosshairOptions.vertical.text.paddingBottom +\n        crosshairOptions.vertical.text.borderSize * 2 +\n        crosshairOptions.vertical.text.size\n      )\n    }\n    return Math.max(xAxisHeight, crosshairVerticalTextHeight)\n  }\n\n  convertFromPixel (pixel) {\n    return this._chartStore.timeScaleStore().coordinateToDataIndex(pixel)\n  }\n\n  convertToPixel (value) {\n    return this._chartStore.timeScaleStore().dataIndexToCoordinate(value)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Pane from './Pane'\nimport XAxisWidget from '../widget/XAxisWidget'\nimport XAxis from '../component/axis/XAxis'\n\nexport default class XAxisPane extends Pane {\n  _initBefore () {\n    this._xAxis = new XAxis(this._chartStore)\n  }\n\n  _createMainWidget (container, props) {\n    return new XAxisWidget({ container, chartStore: props.chartStore, xAxis: this._xAxis })\n  }\n\n  xAxis () {\n    return this._xAxis\n  }\n\n  setWidth (mainWidgetWidth, yAxisWidgetWidth) {\n    super.setWidth(mainWidgetWidth, yAxisWidgetWidth)\n    this._xAxis.setWidth(mainWidgetWidth)\n  }\n\n  setHeight (height) {\n    super.setHeight(height)\n    this._xAxis.setHeight(height)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const EventType = {\n  MOUSE: 'mouse',\n  TOUCH: 'touch'\n}\n\nexport function isTouch (event) {\n  return event.type === EventType.TOUCH\n}\n\nexport function isMouse (event) {\n  return event.type === EventType.MOUSE\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * The file comes from tradingview/lightweight-charts\n * https://www.tradingview.com/\n * Convert files from typescript to javascript.\n * Modified the class name.\n * The use of the source code of this file is also subject to the terms\n * and consitions of the license of \"lightweight-charts\" (Apache License V2, see\n * </licenses/LICENSE-lightweight-charts>).\n */\n\nimport { EventType } from './eventTypeChecks'\n\nconst MouseEventButton = {\n  LEFT: 0,\n  RIGHT: 2\n}\n\nconst DELAY_RESET_CLICK = 500\nconst DELAY_LONG_TAG = 600\n\nfunction getBoundingClientRect (element) {\n  return element.getBoundingClientRect() || { left: 0, top: 0 }\n}\n\nfunction isTouchEvent (event) {\n  return Boolean(event.touches)\n}\n\nfunction preventDefault (event) {\n  if (event.cancelable) {\n    event.preventDefault()\n  }\n}\n\nfunction mobileTouch () {\n  let touchEvent\n  if ('ontouchstart' in window) {\n    touchEvent = true\n  } else {\n    touchEvent = Boolean(window.DocumentTouch && document instanceof window.DocumentTouch)\n  }\n  return ('onorientationchange' in window) && (!!navigator.maxTouchPoints || !!navigator.msMaxTouchPoints || touchEvent)\n}\n\nfunction getDistance (p1, p2) {\n  const xDiff = p1.clientX - p2.clientX\n  const yDiff = p1.clientY - p2.clientY\n  return Math.sqrt(xDiff * xDiff + yDiff * yDiff)\n}\n\nexport default class EventBase {\n  constructor (target, eventHandler, options) {\n    this._target = target\n    this._handler = eventHandler\n    this._options = options\n\n    this._clickCount = 0\n    this._clickTimeoutId = null\n    this._longTapTimeoutId = null\n    this._longTapActive = false\n    this._mouseMoveStartPosition = null\n    this._moveExceededManhattanDistance = false\n    this._cancelClick = false\n    this._unsubscribeOutsideEvents = null\n    this._unsubscribeMousemove = null\n    this._unsubscribeRoot = null\n\n    this._startPinchMiddleCoordinate = null\n    this._startPinchDistance = 0\n    this._pinchPrevented = false\n    this._preventDragProcess = false\n\n    this._mousePressed = false\n\n    this._init()\n  }\n\n  setOptions (options = {}) {\n    this._options = { ...this.options, ...options }\n  }\n\n  destroy () {\n    if (this._unsubscribeOutsideEvents !== null) {\n      this._unsubscribeOutsideEvents()\n      this._unsubscribeOutsideEvents = null\n    }\n\n    if (this._unsubscribeMousemove !== null) {\n      this._unsubscribeMousemove()\n      this._unsubscribeMousemove = null\n    }\n\n    if (this._unsubscribeRoot !== null) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    this._clearLongTapTimeout()\n    this._resetClickTimeout()\n  }\n\n  _mouseEnterHandler (enterEvent) {\n    if (this._unsubscribeMousemove) {\n      this._unsubscribeMousemove()\n    }\n\n    {\n      const boundMouseMoveHandler = this._mouseMoveHandler.bind(this)\n      const boundMouseWheelHandler = this._mouseWheelHandler.bind(this)\n      this._unsubscribeMousemove = () => {\n        this._target.removeEventListener('mousemove', boundMouseMoveHandler)\n        this._target.removeEventListener('wheel', boundMouseWheelHandler)\n      }\n      this._target.addEventListener('mousemove', boundMouseMoveHandler)\n      this._target.addEventListener('wheel', boundMouseWheelHandler, { passive: false })\n    }\n\n    if (isTouchEvent(enterEvent)) {\n      this._mouseMoveHandler(enterEvent)\n    }\n\n    const compatEvent = this._makeCompatEvent(enterEvent)\n    this._processEvent(compatEvent, this._handler.mouseEnterEvent)\n  }\n\n  _resetClickTimeout () {\n    if (this._clickTimeoutId !== null) {\n      clearTimeout(this._clickTimeoutId)\n    }\n\n    this._clickCount = 0\n    this._clickTimeoutId = null\n  }\n\n  _mouseMoveHandler (moveEvent) {\n    if (this._mousePressed && !isTouchEvent(moveEvent)) {\n      return\n    }\n\n    const compatEvent = this._makeCompatEvent(moveEvent)\n    this._processEvent(compatEvent, this._handler.mouseMoveEvent)\n  }\n\n  _mouseWheelHandler (wheelEvent) {\n    const compatEvent = this._makeCompatEvent(wheelEvent)\n    wheelEvent.localX = compatEvent.localX\n    wheelEvent.localY = compatEvent.localY\n    this._processEvent(wheelEvent, this._handler.mouseWheelEvent)\n  }\n\n  _mouseMoveWithDownHandler (moveEvent) {\n    if ('button' in moveEvent && moveEvent.button !== MouseEventButton.LEFT) {\n      return\n    }\n\n    if (this._startPinchMiddleCoordinate !== null) {\n      return\n    }\n\n    const isTouch = isTouchEvent(moveEvent)\n    if (this._preventDragProcess && isTouch) {\n      return\n    }\n\n    this._pinchPrevented = true\n\n    const compatEvent = this._makeCompatEvent(moveEvent)\n\n    const startMouseMovePos = this._mouseMoveStartPosition\n    const xOffset = Math.abs(startMouseMovePos.x - compatEvent.pageX)\n    const yOffset = Math.abs(startMouseMovePos.y - compatEvent.pageY)\n\n    const moveExceededManhattanDistance = xOffset + yOffset > 5\n\n    if (!moveExceededManhattanDistance && isTouch) {\n      return\n    }\n\n    if (moveExceededManhattanDistance && !this._moveExceededManhattanDistance && isTouch) {\n      // vertical drag is more important than horizontal drag\n      // because we scroll the page vertically often than horizontally\n      const correctedXOffset = xOffset * 0.5\n\n      // a drag can be only if touch page scroll isn't allowed\n      const isVertDrag = yOffset >= correctedXOffset && !this._options.treatVertTouchDragAsPageScroll\n      const isHorzDrag = correctedXOffset > yOffset && !this._options.treatHorzTouchDragAsPageScroll\n\n      // if drag event happened then we should revert preventDefault state to original one\n      // and try to process the drag event\n      // else we shouldn't prevent default of the event and ignore processing the drag event\n      if (!isVertDrag && !isHorzDrag) {\n        this._preventDragProcess = true\n      }\n    }\n\n    if (moveExceededManhattanDistance) {\n      this._moveExceededManhattanDistance = true\n\n      // if manhattan distance is more that 5 - we should cancel click event\n      this._cancelClick = true\n\n      if (isTouch) {\n        this._clearLongTapTimeout()\n      }\n    }\n\n    if (!this._preventDragProcess) {\n      this._processEvent(compatEvent, this._handler.pressedMouseMoveEvent)\n\n      // we should prevent default in case of touch only\n      // to prevent scroll of the page\n      if (isTouch) {\n        preventDefault(moveEvent)\n      }\n    }\n  }\n\n  _mouseUpHandler (mouseUpEvent) {\n    if ('button' in mouseUpEvent && mouseUpEvent.button !== MouseEventButton.LEFT) {\n      return\n    }\n    const compatEvent = this._makeCompatEvent(mouseUpEvent)\n\n    this._clearLongTapTimeout()\n\n    this._mouseMoveStartPosition = null\n\n    this._mousePressed = false\n\n    if (this._unsubscribeRoot) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    if (isTouchEvent(mouseUpEvent)) {\n      this._mouseLeaveHandler(mouseUpEvent)\n    }\n\n    this._processEvent(compatEvent, this._handler.mouseUpEvent)\n    ++this._clickCount\n    if (this._clickTimeoutId && this._clickCount > 1) {\n      this._processEvent(compatEvent, this._handler.mouseDoubleClickEvent)\n      this._resetClickTimeout()\n    } else {\n      if (!this._cancelClick) {\n        this._processEvent(compatEvent, this._handler.mouseClickEvent)\n      }\n    }\n\n    // prevent safari's dblclick-to-zoom\n    // we handle mouseDoubleClickEvent here ourself\n    if (isTouchEvent(mouseUpEvent)) {\n      preventDefault(mouseUpEvent)\n\n      this._mouseLeaveHandler(mouseUpEvent)\n\n      if (mouseUpEvent.touches.length === 0) {\n        this._longTapActive = false\n      }\n    }\n  }\n\n  _clearLongTapTimeout () {\n    if (this._longTapTimeoutId === null) {\n      return\n    }\n\n    clearTimeout(this._longTapTimeoutId)\n    this._longTapTimeoutId = null\n  }\n\n  _mouseDownHandler (downEvent) {\n    if ('button' in downEvent && downEvent.button !== MouseEventButton.LEFT && downEvent.button !== MouseEventButton.RIGHT) {\n      return\n    }\n    const compatEvent = this._makeCompatEvent(downEvent)\n    if ('button' in downEvent && downEvent.button === MouseEventButton.RIGHT) {\n      this._processEvent(compatEvent, this._handler.mouseRightDownEvent)\n      return\n    }\n    this._cancelClick = false\n    this._moveExceededManhattanDistance = false\n    this._preventDragProcess = false\n\n    if (isTouchEvent(downEvent)) {\n      this._mouseEnterHandler(downEvent)\n    }\n\n    this._mouseMoveStartPosition = {\n      x: compatEvent.pageX,\n      y: compatEvent.pageY\n    }\n\n    if (this._unsubscribeRoot) {\n      this._unsubscribeRoot()\n      this._unsubscribeRoot = null\n    }\n\n    {\n      const boundMouseMoveWithDownHandler = this._mouseMoveWithDownHandler.bind(this)\n      const boundMouseUpHandler = this._mouseUpHandler.bind(this)\n      const rootElement = this._target.ownerDocument.documentElement\n\n      this._unsubscribeRoot = () => {\n        rootElement.removeEventListener('touchmove', boundMouseMoveWithDownHandler)\n        rootElement.removeEventListener('touchend', boundMouseUpHandler)\n\n        rootElement.removeEventListener('mousemove', boundMouseMoveWithDownHandler)\n        rootElement.removeEventListener('mouseup', boundMouseUpHandler)\n      }\n\n      rootElement.addEventListener('touchmove', boundMouseMoveWithDownHandler, { passive: false })\n      rootElement.addEventListener('touchend', boundMouseUpHandler, { passive: false })\n\n      this._clearLongTapTimeout()\n\n      if (isTouchEvent(downEvent) && downEvent.touches.length === 1) {\n        this._longTapTimeoutId = setTimeout(this._longTapHandler.bind(this, downEvent), DELAY_LONG_TAG)\n      } else {\n        rootElement.addEventListener('mousemove', boundMouseMoveWithDownHandler)\n        rootElement.addEventListener('mouseup', boundMouseUpHandler)\n      }\n    }\n\n    this._mousePressed = true\n    this._processEvent(compatEvent, this._handler.mouseDownEvent)\n\n    if (!this._clickTimeoutId) {\n      this._clickCount = 0\n      this._clickTimeoutId = setTimeout(this._resetClickTimeout.bind(this), DELAY_RESET_CLICK)\n    }\n  }\n\n  _init () {\n    this._target.addEventListener('mouseenter', this._mouseEnterHandler.bind(this))\n\n    this._target.addEventListener('touchcancel', this._clearLongTapTimeout.bind(this))\n\n    {\n      const doc = this._target.ownerDocument\n\n      const outsideHandler = (event) => {\n        if (!this._handler.mouseDownOutsideEvent) {\n          return\n        }\n        if (event.target && this._target.contains(event.target)) {\n          return\n        }\n        this._handler.mouseDownOutsideEvent()\n      }\n\n      this._unsubscribeOutsideEvents = () => {\n        doc.removeEventListener('mousedown', outsideHandler)\n        doc.removeEventListener('touchstart', outsideHandler)\n      }\n\n      doc.addEventListener('mousedown', outsideHandler)\n      doc.addEventListener('touchstart', outsideHandler, { passive: true })\n    }\n\n    this._target.addEventListener('mouseleave', this._mouseLeaveHandler.bind(this))\n\n    this._target.addEventListener('touchstart', this._mouseDownHandler.bind(this), { passive: true })\n    if (!mobileTouch()) {\n      this._target.addEventListener('mousedown', this._mouseDownHandler.bind(this))\n    }\n\n    this._initPinch()\n\n    // Hey mobile Safari, what's up?\n    // If mobile Safari doesn't have any touchmove handler with passive=false\n    // it treats a touchstart and the following touchmove events as cancelable=false,\n    // so we can't prevent them (as soon we subscribe on touchmove inside handler of touchstart).\n    // And we'll get scroll of the page along with chart's one instead of only chart's scroll.\n    this._target.addEventListener('touchmove', () => {}, { passive: false })\n  }\n\n  _initPinch () {\n    if (this._handler.pinchStartEvent === undefined &&\n      this._handler.pinchEvent === undefined &&\n      this._handler.pinchEndEvent === undefined\n    ) {\n      return\n    }\n\n    this._target.addEventListener(\n      'touchstart',\n      (event) => this._checkPinchState(event.touches),\n      { passive: true }\n    )\n\n    this._target.addEventListener(\n      'touchmove',\n      (event) => {\n        if (event.touches.length !== 2 || this._startPinchMiddleCoordinate === null) {\n          return\n        }\n\n        if (this._handler.pinchEvent !== undefined) {\n          const currentDistance = getDistance(event.touches[0], event.touches[1])\n          const scale = currentDistance / this._startPinchDistance\n          this._handler.pinchEvent(this._startPinchMiddleCoordinate, scale)\n          preventDefault(event)\n        }\n      },\n      { passive: false }\n    )\n\n    this._target.addEventListener('touchend', (event) => {\n      this._checkPinchState(event.touches)\n    })\n  }\n\n  _checkPinchState (touches) {\n    if (touches.length === 1) {\n      this._pinchPrevented = false\n    }\n\n    if (touches.length !== 2 || this._pinchPrevented || this._longTapActive) {\n      this._stopPinch()\n    } else {\n      this._startPinch(touches)\n    }\n  }\n\n  _startPinch (touches) {\n    const box = getBoundingClientRect(this._target)\n    this._startPinchMiddleCoordinate = {\n      x: ((touches[0].clientX - box.left) + (touches[1].clientX - box.left)) / 2,\n      y: ((touches[0].clientY - box.top) + (touches[1].clientY - box.top)) / 2\n    }\n\n    this._startPinchDistance = getDistance(touches[0], touches[1])\n\n    if (this._handler.pinchStartEvent !== undefined) {\n      this._handler.pinchStartEvent()\n    }\n\n    this._clearLongTapTimeout()\n  }\n\n  _stopPinch () {\n    if (this._startPinchMiddleCoordinate === null) {\n      return\n    }\n\n    this._startPinchMiddleCoordinate = null\n\n    if (this._handler.pinchEndEvent !== undefined) {\n      this._handler.pinchEndEvent()\n    }\n  }\n\n  _mouseLeaveHandler (event) {\n    if (this._unsubscribeMousemove) {\n      this._unsubscribeMousemove()\n    }\n    const compatEvent = this._makeCompatEvent(event)\n    this._processEvent(compatEvent, this._handler.mouseLeaveEvent)\n  }\n\n  _longTapHandler (event) {\n    const compatEvent = this._makeCompatEvent(event)\n    this._processEvent(compatEvent, this._handler.longTapEvent)\n    this._cancelClick = true\n\n    // long tap is active untill touchend event with 0 touches occured\n    this._longTapActive = true\n  }\n\n  _processEvent (event, callback) {\n    if (!callback) {\n      return\n    }\n    callback.call(this._handler, event)\n  }\n\n  _makeCompatEvent (event) {\n  // TouchEvent has no clientX/Y coordinates:\n  // We have to use the last Touch instead\n    let eventLike\n    if ('touches' in event && event.touches.length) {\n      eventLike = event.touches[0]\n    } else if ('changedTouches' in event && event.changedTouches.length) {\n      eventLike = event.changedTouches[0]\n    } else {\n      eventLike = event\n    }\n\n    const box = getBoundingClientRect(this._target)\n\n    return {\n      clientX: eventLike.clientX,\n      clientY: eventLike.clientY,\n      pageX: eventLike.pageX,\n      pageY: eventLike.pageY,\n      screenX: eventLike.screenX,\n      screenY: eventLike.screenY,\n      localX: eventLike.clientX - box.left,\n      localY: eventLike.clientY - box.top,\n\n      ctrlKey: event.ctrlKey,\n      altKey: event.altKey,\n      shiftKey: event.shiftKey,\n      metaKey: event.metaKey,\n\n      type: event.type.startsWith('mouse') ? EventType.MOUSE : EventType.TOUCH,\n\n      target: eventLike.target,\n      view: event.view\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventBase from '../event/EventBase'\nimport { getPixelRatio } from '../utils/canvas'\nimport { isValid } from '../utils/typeChecks'\nimport { createElement } from '../utils/element'\n\nexport default class SeparatorPane {\n  constructor (container, chartStore, topPaneId, bottomPaneId, dragEnabled, dragEventHandler) {\n    this._chartStore = chartStore\n    this._topPaneId = topPaneId\n    this._bottomPaneId = bottomPaneId\n    this._dragEnabled = dragEnabled\n    this._width = 0\n    this._offsetLeft = 0\n    this._dragEventHandler = dragEventHandler\n    this._dragFlag = false\n    this._initElement(container)\n    this._initEvent(dragEnabled)\n  }\n\n  /**\n   * 初始化dom元素\n   * @param container\n   * @private\n   */\n  _initElement (container) {\n    this._container = container\n    this._wrapper = createElement('div', {\n      margin: '0', padding: '0', position: 'relative', boxSizing: 'border-box'\n    })\n    this._element = createElement('div', {\n      width: '100%',\n      height: '7px',\n      margin: '0',\n      padding: '0',\n      position: 'absolute',\n      top: '-3px',\n      zIndex: '20',\n      boxSizing: 'border-box'\n    })\n    this._wrapper.appendChild(this._element)\n    const lastElement = container.lastChild\n    if (lastElement) {\n      container.insertBefore(this._wrapper, lastElement)\n    } else {\n      container.appendChild(this._wrapper)\n    }\n  }\n\n  /**\n   * 初始化事件\n   * @param dragEnabled\n   * @private\n   */\n  _initEvent (dragEnabled) {\n    if (dragEnabled) {\n      this._element.style.cursor = 'ns-resize'\n      this._dragEvent = new EventBase(this._element, {\n        mouseDownEvent: this._mouseDownEvent.bind(this),\n        mouseUpEvent: this._mouseUpEvent.bind(this),\n        pressedMouseMoveEvent: this._pressedMouseMoveEvent.bind(this),\n        mouseEnterEvent: this._mouseEnterEvent.bind(this),\n        mouseLeaveEvent: this._mouseLeaveEvent.bind(this)\n      }, {\n        treatVertTouchDragAsPageScroll: false,\n        treatHorzTouchDragAsPageScroll: true\n      })\n    }\n  }\n\n  _mouseDownEvent (event) {\n    this._dragFlag = true\n    this._startY = event.pageY\n    this._dragEventHandler.startDrag(this._topPaneId, this._bottomPaneId)\n  }\n\n  _mouseUpEvent () {\n    this._dragFlag = false\n    this._chartStore.setDragPaneFlag(false)\n  }\n\n  _pressedMouseMoveEvent (event) {\n    const dragDistance = event.pageY - this._startY\n    this._dragEventHandler.drag(dragDistance, this._topPaneId, this._bottomPaneId)\n    this._chartStore.setDragPaneFlag(true)\n    this._chartStore.crosshairStore().set()\n  }\n\n  _mouseEnterEvent () {\n    const separatorOptions = this._chartStore.styleOptions().separator\n    this._element.style.background = separatorOptions.activeBackgroundColor\n    // this._chartStore.setDragPaneFlag(true)\n    this._chartStore.crosshairStore().set()\n  }\n\n  _mouseLeaveEvent () {\n    if (!this._dragFlag) {\n      this._element.style.background = null\n      this._chartStore.setDragPaneFlag(false)\n    }\n  }\n\n  /**\n   * 获取高度\n   * @returns {number}\n   */\n  height () {\n    return this._wrapper.offsetHeight\n  }\n\n  /**\n   * 设置尺寸\n   * 用于fill属性\n   * @param offsetLeft\n   * @param width\n   */\n  setSize (offsetLeft, width) {\n    this._offsetLeft = offsetLeft\n    this._width = width\n    this.invalidate()\n  }\n\n  /**\n   * 设置是否可以拖拽\n   * @param dragEnabled\n   */\n  setDragEnabled (dragEnabled) {\n    if (dragEnabled !== this._dragEnabled) {\n      this._dragEnabled = dragEnabled\n      if (dragEnabled) {\n        !this._dragEvent && this._initEvent(dragEnabled)\n      } else {\n        this._element.style.cursor = 'default'\n        this._dragEvent && this._dragEvent.destroy()\n        this._dragEvent = null\n      }\n    }\n  }\n\n  /**\n   * 顶部paneId\n   * @return {*}\n   */\n  topPaneId () {\n    return this._topPaneId\n  }\n\n  /**\n   * 底部paneId\n   * @return {*}\n   */\n  bottomPaneId () {\n    return this._bottomPaneId\n  }\n\n  /**\n   * 更新上下两个图表的索引\n   * @param topPaneId\n   * @param bottomPaneId\n   */\n  updatePaneId (topPaneId, bottomPaneId) {\n    if (isValid(topPaneId)) {\n      this._topPaneId = topPaneId\n    }\n    if (isValid(bottomPaneId)) {\n      this._bottomPaneId = bottomPaneId\n    }\n  }\n\n  /**\n   * 刷新\n   */\n  invalidate () {\n    const separatorOptions = this._chartStore.styleOptions().separator\n    this._element.style.top = `${-Math.floor((7 - separatorOptions.size) / 2)}px`\n    this._wrapper.style.backgroundColor = separatorOptions.color\n    this._wrapper.style.height = `${separatorOptions.size}px`\n    this._wrapper.style.marginLeft = `${separatorOptions.fill ? 0 : this._offsetLeft}px`\n    this._wrapper.style.width = separatorOptions.fill ? '100%' : `${this._width}px`\n  }\n\n  /**\n   * 将图形转换成图片\n   * @returns {HTMLCanvasElement}\n   */\n  getImage () {\n    const separatorOptions = this._chartStore.styleOptions().separator\n    const width = this._wrapper.offsetWidth\n    const height = separatorOptions.size\n    const canvas = createElement('canvas', {\n      width: `${width}px`,\n      height: `${height}px`,\n      boxSizing: 'border-box'\n    })\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n    ctx.fillStyle = separatorOptions.color\n    ctx.fillRect(this._offsetLeft, 0, width, height)\n    return canvas\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    if (this._dragEvent) {\n      this._dragEvent.destroy()\n    }\n    this._container.removeChild(this._wrapper)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default class EventHandler {\n  constructor (chartStore) {\n    this._chartStore = chartStore\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler from './EventHandler'\n\nimport { isMouse, isTouch } from './eventTypeChecks'\n\nconst TOUCH_MIN_RADIUS = 10\n\nexport default class ZoomScrollEventHandler extends EventHandler {\n  constructor (chartStore) {\n    super(chartStore)\n    // 开始滚动时坐标点\n    this._startScrollCoordinate = null\n    // 开始触摸时坐标\n    this._touchCoordinate = null\n    // 是否是取消了十字光标\n    this._touchCancelCrosshair = false\n    // 是否缩放过\n    this._touchZoomed = false\n    // 用来记录捏合缩放的尺寸\n    this._pinchScale = 1\n  }\n\n  pinchStartEvent () {\n    this._pinchScale = 1\n    this._touchZoomed = true\n  }\n\n  pinchEvent (middleCoordinate, scale) {\n    const zoomScale = (scale - this._pinchScale) * 5\n    this._pinchScale = scale\n    this._chartStore.timeScaleStore().zoom(zoomScale, middleCoordinate)\n  }\n\n  mouseUpEvent () {\n    this._startScrollCoordinate = null\n  }\n\n  mouseLeaveEvent (event) {\n    this._startScrollCoordinate = null\n    if (isMouse(event)) {\n      this._chartStore.crosshairStore().set()\n    }\n  }\n\n  mouseMoveEvent (event) {\n    if (!isMouse(event)) {\n      return\n    }\n    this._chartStore.crosshairStore().set({ x: event.localX, y: event.paneY, paneId: event.paneId })\n  }\n\n  mouseWheelEvent (event) {\n    if (Math.abs(event.deltaX) > Math.abs(event.deltaY)) {\n      if (event.cancelable) {\n        event.preventDefault()\n      }\n      if (Math.abs(event.deltaX) === 0) {\n        return\n      }\n      this._chartStore.timeScaleStore().startScroll()\n      this._chartStore.timeScaleStore().scroll(-event.deltaX)\n    } else {\n      let deltaY = -(event.deltaY / 100)\n      if (deltaY === 0) {\n        return\n      }\n      if (event.cancelable) {\n        event.preventDefault()\n      }\n\n      switch (event.deltaMode) {\n        case event.DOM_DELTA_PAGE:\n          deltaY *= 120\n          break\n\n        case event.DOM_DELTA_LINE:\n          deltaY *= 32\n          break\n      }\n\n      if (deltaY !== 0) {\n        const scale = Math.sign(deltaY) * Math.min(1, Math.abs(deltaY))\n        this._chartStore.timeScaleStore().zoom(scale, { x: event.localX, y: event.localY })\n      }\n    }\n  }\n\n  mouseClickEvent (event) {\n    if (!isTouch(event)) {\n      return\n    }\n    if (!this._touchCoordinate && !this._touchCancelCrosshair && !this._touchZoomed) {\n      this._touchCoordinate = { x: event.localX, y: event.localY }\n      this._chartStore.crosshairStore().set({ x: event.localX, y: event.paneY, paneId: event.paneId })\n    }\n  }\n\n  mouseDownEvent (event) {\n    this._startScrollCoordinate = { x: event.localX, y: event.localY }\n    this._chartStore.timeScaleStore().startScroll()\n    if (isTouch(event)) {\n      this._touchZoomed = false\n      if (this._touchCoordinate) {\n        const xDif = event.localX - this._touchCoordinate.x\n        const yDif = event.localY - this._touchCoordinate.y\n        const radius = Math.sqrt(xDif * xDif + yDif * yDif)\n        if (radius < TOUCH_MIN_RADIUS) {\n          this._touchCoordinate = { x: event.localX, y: event.localY }\n          this._chartStore.crosshairStore().set({ x: event.localX, y: event.paneY, paneId: event.paneId })\n        } else {\n          this._touchCancelCrosshair = true\n          this._touchCoordinate = null\n          this._chartStore.crosshairStore().set()\n        }\n      } else {\n        this._touchCancelCrosshair = false\n      }\n    }\n  }\n\n  pressedMouseMoveEvent (event) {\n    let crosshair = { x: event.localX, y: event.paneY, paneId: event.paneId }\n    if (isTouch(event)) {\n      if (this._touchCoordinate) {\n        this._touchCoordinate = { x: event.localX, y: event.localY }\n        this._chartStore.crosshairStore().set(crosshair)\n        return\n      } else {\n        crosshair = null\n      }\n    }\n    if (this._startScrollCoordinate) {\n      const distance = event.localX - this._startScrollCoordinate.x\n      this._chartStore.timeScaleStore().scroll(distance, crosshair)\n    }\n  }\n\n  longTapEvent (event) {\n    if (!isTouch(event)) {\n      return\n    }\n    this._touchCoordinate = { x: event.localX, y: event.localY }\n    this._chartStore.crosshairStore().set({ x: event.localX, y: event.paneY, paneId: event.paneId })\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler from './EventHandler'\nimport { isMouse } from './eventTypeChecks'\n\nimport InvalidateLevel from '../enum/InvalidateLevel'\nimport { ShapeMouseOperateElement } from '../component/overlay/Shape'\n\nexport default class OverlayEventHandler extends EventHandler {\n  constructor (chartStore, yAxis) {\n    super(chartStore)\n    this._yAxis = yAxis\n  }\n\n  /**\n   * 处理覆盖物鼠标hover事件\n   * @param overlays\n   * @param preHoverOperate\n   * @param coordinate\n   * @param event\n   * @return {*}\n   * @private\n   */\n  _performOverlayMouseHover (overlays, preHoverOperate, coordinate, event) {\n    let hoverOperate\n    if (overlays) {\n      for (const overlay of overlays) {\n        hoverOperate = overlay.checkEventCoordinateOn(coordinate)\n        if (hoverOperate) {\n          break\n        }\n      }\n      if (!hoverOperate || preHoverOperate.id !== hoverOperate.id) {\n        if (preHoverOperate.id && preHoverOperate.instance && isMouse(event)) {\n          preHoverOperate.instance.onMouseLeave({\n            id: preHoverOperate.id,\n            points: preHoverOperate.instance.points(),\n            event\n          })\n        }\n        if (hoverOperate && hoverOperate.id !== preHoverOperate.id && hoverOperate.instance && isMouse(event)) {\n          hoverOperate.instance.onMouseEnter({\n            id: hoverOperate.id,\n            points: hoverOperate.instance.points(),\n            event\n          })\n        }\n      }\n    }\n    return hoverOperate\n  }\n\n  /**\n   * 鼠标抬起事件\n   */\n  mouseUpEvent () {\n    this._chartStore.shapeStore().updatePressedInstance()\n  }\n\n  mouseMoveEvent (event) {\n    if (this._waitingForMouseMove) {\n      return false\n    }\n    this._waitingForMouseMove = true\n    const coordinate = { x: event.localX, y: event.paneY }\n    const { paneId, instance } = this._chartStore.shapeStore().progressInstance()\n    let shapeHoverOperate\n    let shapeClickOperate\n    let annotationHoverOperate\n    if (instance && instance.isDrawing()) {\n      if (event.paneId) {\n        if (instance.isStart()) {\n          this._chartStore.shapeStore().updateProgressInstance(this._yAxis(event.paneId), event.paneId)\n        }\n        if (paneId === event.paneId) {\n          instance.mouseMoveForDrawing(coordinate, event)\n        }\n        shapeHoverOperate = instance.checkEventCoordinateOn(coordinate)\n      }\n      shapeClickOperate = {\n        id: '',\n        element: ShapeMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    } else {\n      const annotations = this._chartStore.annotationStore().get(event.paneId)\n      const shapes = this._chartStore.shapeStore().instances(event.paneId)\n      const prevShapeHoverOperate = this._chartStore.shapeStore().mouseOperate().hover\n      const prevAnnotationHoverOperate = this._chartStore.annotationStore().mouseOperate()\n      shapeHoverOperate = this._performOverlayMouseHover(shapes, prevShapeHoverOperate, coordinate, event)\n      annotationHoverOperate = this._performOverlayMouseHover(annotations, prevAnnotationHoverOperate, coordinate, event)\n    }\n    this._chartStore.shapeStore().setMouseOperate({\n      hover: shapeHoverOperate || {\n        id: '',\n        element: ShapeMouseOperateElement.NONE,\n        elementIndex: -1\n      },\n      click: shapeClickOperate\n    })\n    this._chartStore.annotationStore().setMouseOperate(annotationHoverOperate || { id: '' })\n    this._waitingForMouseMove = false\n  }\n\n  /**\n   * 鼠标按下事件\n   * @param event\n   */\n  mouseDownEvent (event) {\n    const coordinate = { x: event.localX, y: event.paneY }\n    const { instance, paneId } = this._chartStore.shapeStore().progressInstance()\n    let shapeHoverOperate = {\n      id: '',\n      element: ShapeMouseOperateElement.NONE,\n      elementIndex: -1\n    }\n    let shapeClickOperate\n    if (instance && instance.isDrawing() && paneId === event.paneId) {\n      instance.mouseLeftButtonDownForDrawing()\n      shapeClickOperate = instance.checkEventCoordinateOn(coordinate)\n    } else {\n      const shapes = this._chartStore.shapeStore().instances(event.paneId)\n      for (const shape of shapes) {\n        shapeClickOperate = shape.checkEventCoordinateOn(coordinate)\n        if (shapeClickOperate) {\n          this._chartStore.shapeStore().updatePressedInstance(shape, event.paneId, shapeClickOperate.element)\n          if (shapeClickOperate.element === ShapeMouseOperateElement.POINT) {\n            shapeHoverOperate = {\n              ...shapeClickOperate\n            }\n          } else {\n            shape.startPressedOtherMove(coordinate)\n          }\n          shape.onClick({\n            id: shapeClickOperate.id,\n            points: shape.points(),\n            event\n          })\n          break\n        }\n      }\n      const visibleAnnotations = this._chartStore.annotationStore().get(event.paneId)\n      if (visibleAnnotations) {\n        for (const an of visibleAnnotations) {\n          const annotationOperate = an.checkEventCoordinateOn(coordinate)\n          if (annotationOperate) {\n            an.onClick({\n              id: annotationOperate.id,\n              points: an.points(),\n              event\n            })\n            break\n          }\n        }\n      }\n    }\n    const shapeOperateValid = this._chartStore.shapeStore().setMouseOperate({\n      hover: shapeHoverOperate,\n      click: shapeClickOperate || {\n        id: '',\n        element: ShapeMouseOperateElement.NONE,\n        elementIndex: -1\n      }\n    })\n    if (shapeOperateValid) {\n      this._chartStore.invalidate(InvalidateLevel.OVERLAY)\n    }\n  }\n\n  mouseRightDownEvent (event) {\n    const { instance } = this._chartStore.shapeStore().progressInstance()\n    let removeShape\n    if (instance) {\n      removeShape = instance\n    } else {\n      const shapes = this._chartStore.shapeStore().instances(event.paneId)\n      removeShape = shapes.find(s => s.checkEventCoordinateOn({ x: event.localX, y: event.paneY }))\n    }\n    if (removeShape && !removeShape.onRightClick({ id: removeShape.id(), points: removeShape.points(), event })) {\n      this._chartStore.shapeStore().removeInstance(removeShape.id())\n    }\n    const visibleAnnotations = this._chartStore.annotationStore().get(event.paneId)\n    if (visibleAnnotations) {\n      const annotation = visibleAnnotations.find(an => an.checkEventCoordinateOn({ x: event.localX, y: event.paneY }))\n      if (annotation) {\n        annotation.onRightClick({ id: annotation.id(), points: annotation.points(), event })\n      }\n    }\n  }\n\n  pressedMouseMoveEvent (event) {\n    const { instance, paneId, element } = this._chartStore.shapeStore().pressedInstance()\n    if (instance && paneId === event.paneId) {\n      const coordinate = { x: event.localX, y: event.paneY }\n      if (element === ShapeMouseOperateElement.POINT) {\n        instance.mousePressedPointMove(coordinate, event)\n      } else {\n        instance.mousePressedOtherMove(coordinate, event)\n      }\n      this._chartStore.crosshairStore().set({ x: event.localX, y: event.paneY, paneId: event.paneId })\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventHandler from './EventHandler'\n\nconst KeyBoardCode = {\n  EQUAL: 'Equal',\n  MINUS: 'Minus',\n  ARROW_LEFT: 'ArrowLeft',\n  ARROW_RIGHT: 'ArrowRight'\n}\n\nexport default class KeyBoardEventHandler extends EventHandler {\n  /**\n   * 键盘事件\n   * @param event\n   */\n  keyBoardDownEvent (event) {\n    if (event.shiftKey) {\n      switch (event.code) {\n        case KeyBoardCode.EQUAL: {\n          this._chartStore.timeScaleStore().zoom(0.5)\n          break\n        }\n        case KeyBoardCode.MINUS: {\n          this._chartStore.timeScaleStore().zoom(-0.5)\n          break\n        }\n        case KeyBoardCode.ARROW_LEFT: {\n          this._chartStore.timeScaleStore().startScroll()\n          this._chartStore.timeScaleStore().scroll(-3 * this._chartStore.timeScaleStore().dataSpace())\n          break\n        }\n        case KeyBoardCode.ARROW_RIGHT: {\n          this._chartStore.timeScaleStore().startScroll()\n          this._chartStore.timeScaleStore().scroll(3 * this._chartStore.timeScaleStore().dataSpace())\n          break\n        }\n        default: {\n          break\n        }\n      }\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport EventBase from './EventBase'\nimport ZoomScrollEventHandler from './ZoomScrollEventHandler'\nimport OverlayEventHandler from './OverlayEventHandler'\nimport KeyBoardEventHandler from './KeyBoardEventHandler'\n\nimport { isTouch } from './eventTypeChecks'\n\nexport default class ChartEvent {\n  constructor (target, chartStore, yAxis) {\n    this._target = target\n    this._chartStore = chartStore\n    this._chartContentLeftRight = {}\n    this._chartContentTopBottom = {}\n    this._paneContentSize = {}\n    this._event = new EventBase(this._target, {\n      pinchStartEvent: this._pinchStartEvent.bind(this),\n      pinchEvent: this._pinchEvent.bind(this),\n      mouseUpEvent: this._mouseUpEvent.bind(this),\n      mouseClickEvent: this._mouseClickEvent.bind(this),\n      mouseDownEvent: this._mouseDownEvent.bind(this),\n      mouseRightDownEvent: this._mouseRightDownEvent.bind(this),\n      mouseLeaveEvent: this._mouseLeaveEvent.bind(this),\n      mouseMoveEvent: this._mouseMoveEvent.bind(this),\n      mouseWheelEvent: this._mouseWheelEvent.bind(this),\n      pressedMouseMoveEvent: this._pressedMouseMoveEvent.bind(this),\n      longTapEvent: this._longTapEvent.bind(this)\n    }, {\n      treatVertTouchDragAsPageScroll: true,\n      treatHorzTouchDragAsPageScroll: false\n    })\n    this._boundKeyBoardDownEvent = this._keyBoardDownEvent.bind(this)\n    this._target.addEventListener('keydown', this._boundKeyBoardDownEvent)\n    this._boundContextMenuEvent = (e) => { e.preventDefault() }\n    this._target.addEventListener('contextmenu', this._boundContextMenuEvent, false)\n    this._zoomScrollEventHandler = new ZoomScrollEventHandler(chartStore)\n    this._overlayEventHandler = new OverlayEventHandler(chartStore, yAxis)\n    this._keyBoardEventHandler = new KeyBoardEventHandler(chartStore)\n  }\n\n  _keyBoardDownEvent (event) {\n    this._keyBoardEventHandler.keyBoardDownEvent(event)\n  }\n\n  _pinchStartEvent () {\n    this._zoomScrollEventHandler.pinchStartEvent()\n  }\n\n  _pinchEvent (middleCoordinate, scale) {\n    this._zoomScrollEventHandler.pinchEvent(middleCoordinate, scale)\n  }\n\n  _mouseUpEvent (event) {\n    if (this._checkEventInChartContent(event)) {\n      this._target.style.cursor = 'crosshair'\n    }\n    this._zoomScrollEventHandler.mouseUpEvent(event)\n    if (this._shouldPerformOverlayEvent()) {\n      this._overlayEventHandler.mouseUpEvent(event)\n    }\n  }\n\n  _mouseLeaveEvent (event) {\n    this._zoomScrollEventHandler.mouseLeaveEvent(event)\n  }\n\n  _mouseMoveEvent (event) {\n    // 当事件目标是在容器内部元素时，不出来move事件\n    // 等待寻找最优解\n    if (event.target instanceof HTMLCanvasElement) {\n      if (this._checkEventInChartContent(event)) {\n        this._target.style.cursor = 'crosshair'\n        const compatEvent = this._compatChartEvent(event, true)\n        if (this._shouldPerformOverlayEvent()) {\n          this._overlayEventHandler.mouseMoveEvent(compatEvent)\n        }\n        if (!this._chartStore.dragPaneFlag()) {\n          this._zoomScrollEventHandler.mouseMoveEvent(compatEvent)\n        }\n      } else {\n        this._target.style.cursor = 'default'\n        this._zoomScrollEventHandler.mouseLeaveEvent(event)\n      }\n    } else {\n      this._target.style.cursor = 'default'\n      this._chartStore.crosshairStore().set()\n    }\n  }\n\n  _mouseWheelEvent (event) {\n    if (this._checkZoomScroll() && this._checkEventInChartContent(event)) {\n      this._zoomScrollEventHandler.mouseWheelEvent(this._compatChartEvent(event))\n    }\n  }\n\n  _mouseClickEvent (event) {\n    if (this._checkZoomScroll() && this._checkEventInChartContent(event)) {\n      this._zoomScrollEventHandler.mouseClickEvent(this._compatChartEvent(event, true))\n      this._modifyEventOptions(event)\n    }\n  }\n\n  _mouseDownEvent (event) {\n    if (this._checkEventInChartContent(event)) {\n      this._target.style.cursor = 'pointer'\n      const compatEvent = this._compatChartEvent(event, true)\n      if (this._shouldPerformOverlayEvent()) {\n        this._overlayEventHandler.mouseDownEvent(compatEvent)\n      }\n      if (this._checkZoomScroll()) {\n        this._zoomScrollEventHandler.mouseDownEvent(compatEvent)\n        this._modifyEventOptions(event)\n      }\n    }\n  }\n\n  _mouseRightDownEvent (event) {\n    if (this._shouldPerformOverlayEvent() && this._checkEventInChartContent(event)) {\n      this._overlayEventHandler.mouseRightDownEvent(this._compatChartEvent(event, true))\n    }\n  }\n\n  _pressedMouseMoveEvent (event) {\n    if (this._checkEventInChartContent(event)) {\n      const compatEvent = this._compatChartEvent(event, true)\n      if (this._checkZoomScroll()) {\n        this._zoomScrollEventHandler.pressedMouseMoveEvent(compatEvent)\n        this._modifyEventOptions(event)\n      } else {\n        this._overlayEventHandler.pressedMouseMoveEvent(compatEvent)\n      }\n    }\n  }\n\n  _longTapEvent (event) {\n    if (this._checkZoomScroll() && this._checkEventInChartContent(event)) {\n      this._zoomScrollEventHandler.longTapEvent(this._compatChartEvent(event, true))\n      this._modifyEventOptions(event)\n    }\n  }\n\n  _checkZoomScroll () {\n    return !this._chartStore.dragPaneFlag() && !this._chartStore.shapeStore().isPressed() && !this._chartStore.shapeStore().isDrawing()\n  }\n\n  /**\n   * 是否需要处理图形标记事件\n   * @return {boolean}\n   * @private\n   */\n  _shouldPerformOverlayEvent () {\n    return !this._chartStore.shapeStore().isEmpty() || !this._chartStore.annotationStore().isEmpty()\n  }\n\n  /**\n   * 修改事件配置\n   * @param event\n   */\n  _modifyEventOptions (event) {\n    if (isTouch(event) && this._chartStore.crosshairStore().get().paneId) {\n      this._event.setOptions({ treatVertTouchDragAsPageScroll: false })\n    } else {\n      this._event.setOptions({ treatVertTouchDragAsPageScroll: true })\n    }\n  }\n\n  /**\n   * 事件信息兼容\n   * @param {*} event\n   * @param {*} compatY\n   * @returns\n   */\n  _compatChartEvent (event, compatY) {\n    if (compatY) {\n      for (const id in this._paneContentSize) {\n        if (Object.prototype.hasOwnProperty.call(this._paneContentSize, id)) {\n          const size = this._paneContentSize[id]\n          if (event.localY > size.contentTop && event.localY < size.contentBottom) {\n            event.paneY = event.localY - size.contentTop\n            event.paneId = id\n            break\n          }\n        }\n      }\n    }\n    event.localX -= this._chartContentLeftRight.contentLeft\n    return event\n  }\n\n  /**\n   * 检查事件是否在图表内容内\n   * @param {*} event\n   * @returns\n   */\n  _checkEventInChartContent (event) {\n    return (event.localX > this._chartContentLeftRight.contentLeft && event.localX < this._chartContentLeftRight.contentRight) &&\n      (event.localY > this._chartContentTopBottom.contentTop && event.localY < this._chartContentTopBottom.contentBottom)\n  }\n\n  setChartContentLeftRight (chartContentLeftRight) {\n    this._chartContentLeftRight = chartContentLeftRight\n  }\n\n  setChartContentTopBottom (chartContentTopBottom) {\n    this._chartContentTopBottom = chartContentTopBottom\n  }\n\n  setPaneContentSize (paneContentSize) {\n    this._paneContentSize = paneContentSize\n  }\n\n  destroy () {\n    this._event.destroy()\n    this._target.removeEventListener('keydown', this._boundKeyBoardDownEvent)\n    this._target.removeEventListener('contextmenu', this._boundContextMenuEvent)\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function throttle (func, wait = 20) {\n  let previous = 0\n  return function () {\n    const now = Date.now()\n    const context = this\n    const args = arguments\n    if (now - previous > wait) {\n      func.apply(context, args)\n      previous = now\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 渲染填充菱形\n * @param ctx\n * @param color\n * @param centerCoordinate\n * @param width\n * @param height\n */\nexport function renderFillDiamond (ctx, color, centerCoordinate, width, height) {\n  ctx.fillStyle = color\n  ctx.beginPath()\n  ctx.moveTo(centerCoordinate.x - width / 2, centerCoordinate.y)\n  ctx.lineTo(centerCoordinate.x, centerCoordinate.y - height / 2)\n  ctx.lineTo(centerCoordinate.x + width / 2, centerCoordinate.y)\n  ctx.lineTo(centerCoordinate.x, centerCoordinate.y + height / 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * 渲染填充菱形\n * @param ctx\n * @param color\n * @param centerCoordinate\n * @param width\n * @param height\n */\nexport function renderFillTriangle (ctx, color, centerCoordinate, width, height) {\n  ctx.fillStyle = color\n  ctx.beginPath()\n  ctx.moveTo(centerCoordinate.x - width / 2, centerCoordinate.y + height / 2)\n  ctx.lineTo(centerCoordinate.x, centerCoordinate.y - height / 2)\n  ctx.lineTo(centerCoordinate.x + width / 2, centerCoordinate.y + height / 2)\n  ctx.closePath()\n  ctx.fill()\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from './Overlay'\n\nimport { renderFillCircle } from '../../renderer/circle'\nimport { renderFillRect } from '../../renderer/rect'\nimport { renderFillDiamond } from '../../renderer/diamond'\nimport { renderFillTriangle } from '../../renderer/triangle'\nimport {\n  checkCoordinateInCircle, checkCoordinateInDiamond,\n  checkCoordinateInRect, checkCoordinateInTriangle\n} from '../../extension/shape/shapeHelper'\n\nimport { isNumber } from '../../utils/typeChecks'\n\nimport {\n  OverlayPosition,\n  AnnotationSymbolType\n} from '../../options/styleOptions'\n\n/**\n * 注解\n */\nexport default class Annotation extends Overlay {\n  constructor ({\n    id, point, chartStore, xAxis, yAxis, styles\n  }) {\n    super({ id, chartStore, xAxis, yAxis })\n    this._point = point\n    this._symbolCoordinate = {}\n    this.setStyles(styles, chartStore.styleOptions().annotation)\n  }\n\n  /**\n   * 绘制标识\n   * @param ctx\n   * @param isActive\n   * @param styles\n   * @private\n   */\n  _drawSymbol (ctx, isActive, styles) {\n    const barSpace = this._chartStore.timeScaleStore().barSpace()\n    const symbolOptions = styles.symbol\n    const styleSize = symbolOptions.size\n    const styleActiveSize = symbolOptions.activeSize\n    const size = isActive\n      ? (isNumber(styleActiveSize) ? styleActiveSize : barSpace)\n      : (isNumber(styleSize) ? styleSize : barSpace)\n    const color = isActive ? symbolOptions.activeColor : symbolOptions.color\n    switch (symbolOptions.type) {\n      case AnnotationSymbolType.CIRCLE: {\n        renderFillCircle(ctx, color, this._symbolCoordinate, size / 2)\n        break\n      }\n      case AnnotationSymbolType.RECT: {\n        renderFillRect(\n          ctx, color,\n          this._symbolCoordinate.x - size / 2,\n          this._symbolCoordinate.y - size / 2,\n          size, size\n        )\n        break\n      }\n      case AnnotationSymbolType.DIAMOND: {\n        renderFillDiamond(ctx, color, this._symbolCoordinate, size, size)\n        break\n      }\n      case AnnotationSymbolType.TRIANGLE: {\n        renderFillTriangle(ctx, color, this._symbolCoordinate, size, size)\n        break\n      }\n      case AnnotationSymbolType.CUSTOM: {\n        ctx.save()\n        this.drawCustomSymbol({\n          ctx,\n          point: this._point,\n          coordinate: this._symbolCoordinate,\n          viewport: {\n            width: this._xAxis.width(),\n            height: this._yAxis.height(),\n            barSpace\n          },\n          styles: symbolOptions,\n          isActive\n        })\n        ctx.restore()\n        break\n      }\n      default: {\n        break\n      }\n    }\n  }\n\n  draw (ctx) {\n    const styles = this._styles || this._chartStore.styleOptions().annotation\n    const offset = styles.offset || [0, 0]\n    let y = 0\n    switch (styles.position) {\n      case OverlayPosition.POINT: {\n        y = this._yAxis.convertToPixel(this._point.value)\n        break\n      }\n      case OverlayPosition.TOP: {\n        y = 0\n        break\n      }\n      case OverlayPosition.BOTTOM: {\n        y = this._yAxis.height()\n        break\n      }\n    }\n    this._symbolCoordinate.y = y + offset[0]\n    const isActive = this._id === this._chartStore.annotationStore().mouseOperate().id\n    this._drawSymbol(ctx, isActive, styles)\n    if (this.drawExtend) {\n      ctx.save()\n      this.drawExtend({\n        ctx,\n        point: this._point,\n        coordinate: this._symbolCoordinate,\n        viewport: {\n          width: this._xAxis.width(),\n          height: this._yAxis.height()\n        },\n        styles,\n        isActive\n      })\n      ctx.restore()\n    }\n  }\n\n  checkEventCoordinateOn (eventCoordinate) {\n    const barSpace = this._chartStore.timeScaleStore().barSpace()\n    const styles = this._styles || this._chartStore.styleOptions().annotation\n    const symbolOptions = styles.symbol\n    const size = isNumber(symbolOptions.size) ? symbolOptions.size : barSpace\n    let isOn\n    switch (symbolOptions.type) {\n      case AnnotationSymbolType.CIRCLE: {\n        isOn = checkCoordinateInCircle(this._symbolCoordinate, size / 2, eventCoordinate)\n        break\n      }\n      case AnnotationSymbolType.RECT: {\n        const coordinate1 = { x: this._symbolCoordinate.x - size / 2, y: this._symbolCoordinate.y - size / 2 }\n        const coordinate2 = { x: this._symbolCoordinate.x + size / 2, y: this._symbolCoordinate.y + size / 2 }\n        isOn = checkCoordinateInRect(coordinate1, coordinate2, eventCoordinate)\n        break\n      }\n      case AnnotationSymbolType.DIAMOND: {\n        isOn = checkCoordinateInDiamond(this._symbolCoordinate, size, size, eventCoordinate)\n        break\n      }\n      case AnnotationSymbolType.TRIANGLE: {\n        isOn = checkCoordinateInTriangle(\n          [\n            { x: this._symbolCoordinate.x - size / 2, y: this._symbolCoordinate.y + size / 2 },\n            { x: this._symbolCoordinate.x, y: this._symbolCoordinate.y - size / 2 },\n            { x: this._symbolCoordinate.x + size / 2, y: this._symbolCoordinate.y + size / 2 }\n          ],\n          eventCoordinate\n        )\n        break\n      }\n      case AnnotationSymbolType.CUSTOM: {\n        isOn = this.checkEventCoordinateOnCustomSymbol({\n          eventCoordinate,\n          coordinate: this._symbolCoordinate,\n          size\n        })\n        break\n      }\n      default: {\n        break\n      }\n    }\n    if (isOn) {\n      return {\n        id: this._id,\n        instance: this\n      }\n    }\n  }\n\n  /**\n   * 生成标识坐标\n   * @param x\n   */\n  createSymbolCoordinate (x) {\n    const styles = this._styles || this._chartStore.styleOptions().annotation\n    const offset = styles.offset || [0, 0]\n    this._symbolCoordinate = { x: x + offset[1] }\n  }\n\n  /**\n   * 获取点\n   * @return {*}\n   */\n  points () {\n    return this._point\n  }\n\n  /**\n   * 检查鼠标点是否在自定义标识内\n   * @param eventCoordinate\n   * @param coordinate\n   * @param size\n   */\n  checkEventCoordinateOnCustomSymbol ({ eventCoordinate, coordinate, size }) {}\n\n  /**\n   * 绘制自定义标识\n   * @param ctx\n   * @param point\n   * @param coordinate\n   * @param viewport\n   * @param styles\n   * @param isActive\n   */\n  drawCustomSymbol ({ ctx, point, coordinate, viewport, styles, isActive }) {}\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Overlay from './Overlay'\nimport { LineStyle, OverlayPosition, YAxisPosition } from '../../options/styleOptions'\nimport { renderHorizontalLine } from '../../renderer/line'\nimport { isValid, isObject } from '../../utils/typeChecks'\nimport { createFont, getTextRectWidth, getTextRectHeight } from '../../utils/canvas'\nimport { renderStrokeFillRoundRect } from '../../renderer/rect'\nimport { renderText } from '../../renderer/text'\n\nexport default class Tag extends Overlay {\n  constructor ({\n    id, point, text, mark, chartStore, xAxis, yAxis, styles\n  }) {\n    super({ id, chartStore, xAxis, yAxis })\n    this._point = point || {}\n    this._text = text\n    this._mark = mark\n    this.setStyles(styles, chartStore.styleOptions().tag)\n  }\n\n  /**\n   * 更新\n   * @param point\n   * @param text\n   * @param mark\n   * @param styles\n   * @return {boolean}\n   */\n  update ({ point, text, mark, styles }) {\n    let success = false\n    if (isObject(point)) {\n      this._point = point\n      success = true\n    }\n    if (isValid(text)) {\n      this._text = text\n      success = true\n    }\n    if (isValid(mark)) {\n      this._mark = mark\n      success = true\n    }\n    if (this.setStyles(styles, this._chartStore.styleOptions().tag)) {\n      success = true\n    }\n    return success\n  }\n\n  /**\n   * 绘制标记和线\n   * @param ctx\n   */\n  drawMarkLine (ctx) {\n    const options = this._chartStore.styleOptions()\n    const yAxisOptions = options.yAxis\n    const tagOptions = this._styles || options.tag\n    const y = this._getY(tagOptions)\n    ctx.save()\n    this._drawLine(ctx, y, tagOptions, yAxisOptions)\n    this._drawMark(ctx, y, tagOptions, yAxisOptions)\n    ctx.restore()\n  }\n\n  /**\n   * 绘制值\n   */\n  drawText (ctx) {\n    if (!isValid(this._text)) {\n      return\n    }\n    const options = this._chartStore.styleOptions()\n    const tagOptions = this._styles || options.tag\n    const tagTextOptions = tagOptions.text\n    ctx.save()\n    const rectWidth = getTextRectWidth(ctx, this._text, tagTextOptions)\n    const rectHeight = getTextRectHeight(tagTextOptions)\n    let x\n    if (this._yAxis.isFromYAxisZero()) {\n      x = 0\n    } else {\n      x = this._yAxis.width() - rectWidth\n    }\n    const y = this._getY(tagOptions)\n    renderStrokeFillRoundRect(\n      ctx,\n      tagTextOptions.backgroundColor,\n      tagTextOptions.borderColor,\n      tagTextOptions.borderSize,\n      x,\n      y - rectHeight / 2,\n      rectWidth,\n      rectHeight,\n      tagTextOptions.borderRadius\n    )\n    renderText(ctx, tagTextOptions.color, x + tagTextOptions.paddingLeft, y, this._text)\n    ctx.restore()\n  }\n\n  /**\n   * 绘制线\n   * @param ctx\n   * @param y\n   * @param tagOptions\n   * @private\n   */\n  _drawLine (ctx, y, tagOptions, yAxisOptions) {\n    const tagLineOptions = tagOptions.line\n    if (!tagLineOptions.show) {\n      return\n    }\n    ctx.save()\n    const textRectWidth = getTextRectWidth(ctx, this._text, tagOptions.text)\n    const markRectWidth = getTextRectWidth(ctx, this._mark, tagOptions.mark)\n    ctx.strokeStyle = tagLineOptions.color\n    ctx.lineWidth = tagLineOptions.size\n    if (tagLineOptions.style === LineStyle.DASH) {\n      ctx.setLineDash(tagLineOptions.dashValue)\n    }\n    const markOffset = tagOptions.mark.offset\n    const lines = []\n    const textValid = isValid(this._text)\n    const markValid = isValid(this._mark)\n    if (yAxisOptions.inside) {\n      if (yAxisOptions.position === YAxisPosition.LEFT) {\n        if (textValid && markValid) {\n          if (markOffset > 0) {\n            lines.push([textRectWidth, textRectWidth + markOffset])\n            lines.push([textRectWidth + markOffset + markRectWidth, this._xAxis.width()])\n          } else {\n            if (Math.abs(markOffset) < Math.min(textRectWidth, markRectWidth)) {\n              lines.push([textRectWidth + markOffset + markRectWidth, this._xAxis.width()])\n            } else {\n              lines.push([Math.max(textRectWidth, markRectWidth), this._xAxis.width()])\n            }\n          }\n        } else {\n          if (textValid) {\n            lines.push([textRectWidth, this._xAxis.width()])\n          } else if (markValid) {\n            if (markOffset > 0) {\n              lines.push([0, markOffset])\n              lines.push([markOffset + markRectWidth, this._xAxis.width()])\n            } else {\n              if (Math.abs(markOffset) < markRectWidth) {\n                lines.push([markOffset + markRectWidth, this._xAxis.width()])\n              } else {\n                lines.push([0, this._xAxis.width()])\n              }\n            }\n          } else {\n            lines.push([0, this._xAxis.width()])\n          }\n        }\n      } else {\n        if (textValid && markValid) {\n          if (markOffset < 0) {\n            lines.push([0, this._xAxis.width() - textRectWidth + markOffset - markRectWidth])\n            lines.push([this._xAxis.width() - textRectWidth + markOffset, this._xAxis.width() - textRectWidth])\n          } else {\n            if (markOffset < Math.min(textRectWidth, markRectWidth)) {\n              lines.push([0, this._xAxis.width() - textRectWidth - markRectWidth + markOffset])\n            } else {\n              lines.push([0, this._xAxis.width() - Math.max(textRectWidth, markRectWidth)])\n            }\n          }\n        } else {\n          if (textValid) {\n            lines.push([0, this._xAxis.width() - textRectWidth])\n          } else if (markValid) {\n            if (markOffset < 0) {\n              lines.push([0, this._xAxis.width() + markOffset - markRectWidth])\n              lines.push([this._xAxis.width() + markOffset, this._xAxis.width()])\n            } else {\n              if (markOffset < markRectWidth) {\n                lines.push([0, this._xAxis.width() - markRectWidth + markOffset])\n              } else {\n                lines.push([0, this._xAxis.width()])\n              }\n            }\n          } else {\n            lines.push([0, this._xAxis.width()])\n          }\n        }\n      }\n    } else {\n      if (yAxisOptions.position === YAxisPosition.LEFT) {\n        if (markValid) {\n          if (markOffset > 0) {\n            lines.push([0, markOffset])\n            lines.push([markOffset + markRectWidth, this._xAxis.width()])\n          } else {\n            if (Math.abs(markOffset) < markRectWidth) {\n              lines.push([markRectWidth + markOffset, this._xAxis.width()])\n            } else {\n              lines.push([0, this._xAxis.width()])\n            }\n          }\n        } else {\n          lines.push([0, this._xAxis.width()])\n        }\n      } else {\n        if (markValid) {\n          if (markOffset < 0) {\n            lines.push([0, this._xAxis.width() - markRectWidth + markOffset])\n            lines.push([this._xAxis.width() + markOffset, this._xAxis.width()])\n          } else {\n            if (markOffset < markRectWidth) {\n              lines.push([0, this._xAxis.width() - markRectWidth + markOffset])\n            } else {\n              lines.push([0, this._xAxis.width()])\n            }\n          }\n        } else {\n          lines.push([0, this._xAxis.width()])\n        }\n      }\n    }\n    lines.forEach(line => {\n      renderHorizontalLine(ctx, y, line[0], line[1])\n    })\n    ctx.restore()\n  }\n\n  /**\n   * 绘制标记\n   * @param ctx\n   * @param y\n   * @param tagOptions\n   * @param yAxisOptions\n   * @private\n   */\n  _drawMark (ctx, y, tagOptions, yAxisOptions) {\n    if (!isValid(this._mark)) {\n      return\n    }\n    const tagMarkOptions = tagOptions.mark\n    const rectWidth = getTextRectWidth(ctx, this._mark, tagMarkOptions)\n    const rectHeight = getTextRectHeight(tagMarkOptions)\n    let x\n    if (yAxisOptions.inside) {\n      let textRectWidth = 0\n      if (isValid(this._text)) {\n        textRectWidth = getTextRectWidth(ctx, this._text, tagOptions.text)\n      }\n      if (yAxisOptions.position === YAxisPosition.LEFT) {\n        x = textRectWidth\n      } else {\n        x = this._xAxis.width() - textRectWidth - rectWidth\n      }\n    } else {\n      if (yAxisOptions.position === YAxisPosition.LEFT) {\n        x = 0\n      } else {\n        x = this._xAxis.width() - rectWidth\n      }\n    }\n    x += tagMarkOptions.offset\n    renderStrokeFillRoundRect(\n      ctx,\n      tagMarkOptions.backgroundColor,\n      tagMarkOptions.borderColor,\n      tagMarkOptions.borderSize,\n      x,\n      y - rectHeight / 2,\n      rectWidth,\n      rectHeight,\n      tagMarkOptions.borderRadius\n    )\n    ctx.textBaseline = 'middle'\n    ctx.font = createFont(tagMarkOptions.size, tagMarkOptions.weight, tagMarkOptions.family)\n    renderText(ctx, tagMarkOptions.color, x + tagMarkOptions.paddingLeft, y, this._mark)\n  }\n\n  /**\n   * 获取坐标y值\n   * @param tagOptions\n   * @return {*}\n   * @private\n   */\n  _getY (tagOptions) {\n    const offset = tagOptions.offset\n    switch (tagOptions.position) {\n      case OverlayPosition.TOP: {\n        return offset\n      }\n      case OverlayPosition.BOTTOM: {\n        return this._yAxis.height() + offset\n      }\n      default: {\n        return this._yAxis.convertToNicePixel(this._point.value) + offset\n      }\n    }\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ChartStore from '../store/ChartStore'\n\nimport CandlePane from './CandlePane'\nimport XAxisPane from './XAxisPane'\n\nimport { YAxisPosition } from '../options/styleOptions'\nimport { isArray, isBoolean, isFunction, isValid, isNumber } from '../utils/typeChecks'\nimport TechnicalIndicatorPane from './TechnicalIndicatorPane'\nimport SeparatorPane from './SeparatorPane'\n\nimport ChartEvent from '../event/ChartEvent'\nimport { getPixelRatio } from '../utils/canvas'\nimport { throttle } from '../utils/performance'\nimport { createElement } from '../utils/element'\nimport Annotation from '../component/overlay/Annotation'\nimport Tag from '../component/overlay/Tag'\nimport { perfectOverlayFunc } from '../component/overlay/Overlay'\n\nimport ActionType from '../enum/ActionType'\nimport InvalidateLevel from '../enum/InvalidateLevel'\n\n// 默认技术指标窗口高度\nconst DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT = 100\n\n// 技术指标窗口id前缀\nconst TECHNICAL_INDICATOR_PANE_ID_PREFIX = 'technical_indicator_pane_'\n\n// 图形id前缀\nconst SHAPE_ID_PREFIX = 'shape_'\n\n// 蜡烛图窗口id\nexport const CANDLE_PANE_ID = 'candle_pane'\n\n// x轴窗口id\nconst XAXIS_PANE_ID = 'x_axis_pane'\n\nexport default class ChartPane {\n  constructor (container, styleOptions) {\n    this._initChartContainer(container)\n    this._shapeBaseId = 0\n    this._paneBaseId = 0\n    this._separatorDragStartTopPaneHeight = 0\n    this._separatorDragStartBottomPaneHeight = 0\n    this._chartStore = new ChartStore(styleOptions, {\n      invalidate: this._invalidatePane.bind(this),\n      crosshair: this._crosshairObserver.bind(this)\n    })\n    this._xAxisPane = new XAxisPane({ id: XAXIS_PANE_ID, container: this._chartContainer, chartStore: this._chartStore })\n    this._panes = new Map([[CANDLE_PANE_ID, new CandlePane({\n      container: this._chartContainer,\n      chartStore: this._chartStore,\n      xAxis: this._xAxisPane.xAxis(),\n      id: CANDLE_PANE_ID\n    })]])\n    this._separators = new Map()\n    this._chartWidth = {}\n    this._chartHeight = {}\n    this._chartEvent = new ChartEvent(\n      this._chartContainer,\n      this._chartStore,\n      (paneId) => this._panes.get(paneId).yAxis()\n    )\n    this.adjustPaneViewport(true, true, true)\n  }\n\n  /**\n   * 初始化图表容器\n   * @param container\n   * @private\n   */\n  _initChartContainer (container) {\n    this._container = container\n    this._chartContainer = createElement('div', {\n      userSelect: 'none',\n      webkitUserSelect: 'none',\n      msUserSelect: 'none',\n      MozUserSelect: 'none',\n      webkitTapHighlightColor: 'transparent',\n      position: 'relative',\n      outline: 'none',\n      borderStyle: 'none',\n      width: '100%',\n      cursor: 'crosshair',\n      boxSizing: 'border-box'\n    })\n    this._chartContainer.tabIndex = 1\n    container.appendChild(this._chartContainer)\n  }\n\n  /**\n   * 十字光标观察者\n   * @private\n   */\n  _crosshairObserver ({ crosshair, dataIndex, kLineData, x, y }) {\n    if (\n      this._chartStore.actionStore().has(ActionType.CROSSHAIR) ||\n      this._chartStore.actionStore().has(ActionType.TOOLTIP)\n    ) {\n      const techDatas = {}\n      this._panes.forEach((_, id) => {\n        const data = {}\n        const techDataList = []\n        const techs = this.chartStore().technicalIndicatorStore().instances(id)\n        techs.forEach(tech => {\n          const result = tech.result\n          const techData = result[dataIndex]\n          data[tech.name] = techData\n          techDataList.push({ name: tech.name, data: techData })\n        })\n        techDatas[id] = data\n        this._chartStore.actionStore().execute(ActionType.TOOLTIP, {\n          paneId: id,\n          dataIndex,\n          kLineData,\n          technicalIndicatorData: techDataList\n        })\n      })\n      if (crosshair.paneId) {\n        this._chartStore.actionStore().execute(ActionType.CROSSHAIR, {\n          coordinate: { x, y },\n          dataIndex,\n          kLineData,\n          technicalIndicatorData: techDatas\n        })\n      }\n    }\n  }\n\n  /**\n   * 分割线拖拽开始\n   * @param topPaneId\n   * @param bottomPaneId\n   * @private\n   */\n  _separatorStartDrag (topPaneId, bottomPaneId) {\n    this._separatorDragStartTopPaneHeight = this._panes.get(topPaneId).height()\n    this._separatorDragStartBottomPaneHeight = this._panes.get(bottomPaneId).height()\n  }\n\n  /**\n   * 分割线拖拽\n   * @param dragDistance\n   * @param topPaneId\n   * @param bottomPaneId\n   * @private\n   */\n  _separatorDrag (dragDistance, topPaneId, bottomPaneId) {\n    let topPaneHeight = this._separatorDragStartTopPaneHeight + dragDistance\n    let bottomPaneHeight = this._separatorDragStartBottomPaneHeight - dragDistance\n    if (topPaneHeight > this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight) {\n      topPaneHeight = this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight\n      bottomPaneHeight = 0\n    }\n    if (topPaneHeight < 0) {\n      topPaneHeight = 0\n      bottomPaneHeight = this._separatorDragStartTopPaneHeight + this._separatorDragStartBottomPaneHeight\n    }\n    this._panes.get(topPaneId).setHeight(topPaneHeight)\n    this._panes.get(bottomPaneId).setHeight(bottomPaneHeight)\n    this._chartStore.actionStore().execute(ActionType.PANE_DRAG, { topPaneId, bottomPaneId, topPaneHeight, bottomPaneHeight })\n    this.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 更新所有pane\n   * @private\n   */\n  _invalidatePane (invalidateLevel = InvalidateLevel.FULL) {\n    if (invalidateLevel === InvalidateLevel.OVERLAY) {\n      this._xAxisPane.invalidate(invalidateLevel)\n      this._panes.forEach((pane) => {\n        pane.invalidate(invalidateLevel)\n      })\n    } else {\n      let shouldMeasureWidth = false\n      this._panes.forEach((pane) => {\n        const should = pane.yAxis().computeAxis()\n        if (should) {\n          shouldMeasureWidth = should\n        }\n      })\n      this.adjustPaneViewport(false, shouldMeasureWidth, true)\n    }\n  }\n\n  /**\n   * 测量pane高度\n   * @private\n   */\n  _measurePaneHeight () {\n    const styleOptions = this._chartStore.styleOptions()\n    const paneHeight = this._container.offsetHeight\n    const separatorSize = styleOptions.separator.size\n    const separatorTotalHeight = separatorSize * this._separators.size\n    const xAxisHeight = this._xAxisPane.xAxis().getSelfHeight()\n    const paneExcludeXAxisSeparatorHeight = paneHeight - xAxisHeight - separatorTotalHeight\n    let techPaneTotalHeight = 0\n    this._panes.forEach(pane => {\n      if (pane.id() !== CANDLE_PANE_ID) {\n        const paneHeight = pane.height()\n        if (techPaneTotalHeight + paneHeight > paneExcludeXAxisSeparatorHeight) {\n          pane.setHeight(paneExcludeXAxisSeparatorHeight - techPaneTotalHeight)\n          techPaneTotalHeight = paneExcludeXAxisSeparatorHeight\n        } else {\n          techPaneTotalHeight += paneHeight\n        }\n      }\n    })\n\n    const candlePaneHeight = paneExcludeXAxisSeparatorHeight - techPaneTotalHeight\n\n    const paneContentSize = {}\n    paneContentSize[CANDLE_PANE_ID] = { contentTop: 0, contentBottom: candlePaneHeight }\n    let contentTop = candlePaneHeight\n    let contentBottom = candlePaneHeight\n    this._panes.get(CANDLE_PANE_ID).setHeight(candlePaneHeight)\n    this._chartHeight[CANDLE_PANE_ID] = candlePaneHeight\n    this._panes.forEach(pane => {\n      if (pane.id() !== CANDLE_PANE_ID) {\n        const paneHeight = pane.height()\n        contentBottom += (paneHeight + separatorSize)\n        paneContentSize[pane.id()] = { contentTop, contentBottom }\n        this._chartHeight[pane.id()] = paneHeight\n        contentTop = contentBottom\n      }\n    })\n    this._xAxisPane.setHeight(xAxisHeight)\n    this._chartHeight.xAxis = xAxisHeight\n    this._chartHeight.total = paneHeight\n    this._chartEvent.setPaneContentSize(paneContentSize)\n    this._chartEvent.setChartContentTopBottom({ contentTop: 0, contentBottom })\n  }\n\n  /**\n   * 测量pan宽度\n   * @private\n   */\n  _measurePaneWidth () {\n    const styleOptions = this._chartStore.styleOptions()\n    const yAxisOptions = styleOptions.yAxis\n    const isYAxisLeft = yAxisOptions.position === YAxisPosition.LEFT\n    const isOutside = !yAxisOptions.inside\n    const paneWidth = this._container.offsetWidth\n    let mainWidth\n    let yAxisWidth = Number.MIN_SAFE_INTEGER\n    let yAxisOffsetLeft\n    let mainOffsetLeft\n    if (isOutside) {\n      this._panes.forEach(pane => {\n        yAxisWidth = Math.max(yAxisWidth, pane.yAxis().getSelfWidth())\n      })\n      mainWidth = paneWidth - yAxisWidth\n      if (isYAxisLeft) {\n        yAxisOffsetLeft = 0\n        mainOffsetLeft = yAxisWidth\n      } else {\n        mainOffsetLeft = 0\n        yAxisOffsetLeft = paneWidth - yAxisWidth\n      }\n    } else {\n      mainWidth = paneWidth\n      yAxisWidth = paneWidth\n      yAxisOffsetLeft = 0\n      mainOffsetLeft = 0\n    }\n\n    this._chartStore.timeScaleStore().setTotalDataSpace(mainWidth)\n\n    this._panes.forEach((pane, paneId) => {\n      pane.setWidth(mainWidth, yAxisWidth)\n      pane.setOffsetLeft(mainOffsetLeft, yAxisOffsetLeft)\n      const separator = this._separators.get(paneId)\n      separator && separator.setSize(mainOffsetLeft, mainWidth)\n    })\n    this._chartWidth = { content: mainWidth, yAxis: yAxisWidth, total: paneWidth }\n    this._xAxisPane.setWidth(mainWidth, yAxisWidth)\n    this._xAxisPane.setOffsetLeft(mainOffsetLeft, yAxisOffsetLeft)\n    this._chartEvent.setChartContentLeftRight({ contentLeft: mainOffsetLeft, contentRight: mainOffsetLeft + mainWidth })\n  }\n\n  /**\n   * 调整窗口尺寸\n   * @param shouldMeasureHeight\n   * @param shouldMeasureWidth\n   * @param shouldLayout\n   * @param shouldComputeAxis\n   * @param shouldForceComputeAxis\n   */\n  adjustPaneViewport (\n    shouldMeasureHeight, shouldMeasureWidth, shouldLayout, shouldComputeAxis, shouldForceComputeAxis\n  ) {\n    if (shouldMeasureHeight) {\n      this._measurePaneHeight()\n    }\n    let isAdjust = false\n    if (shouldComputeAxis) {\n      this._panes.forEach(pane => {\n        const adjust = pane.yAxis().computeAxis(shouldForceComputeAxis)\n        if (!isAdjust) {\n          isAdjust = adjust\n        }\n      })\n    }\n    if ((!shouldComputeAxis && shouldMeasureWidth) || (shouldComputeAxis && isAdjust)) {\n      this._measurePaneWidth()\n    }\n    if (shouldLayout) {\n      this._xAxisPane.xAxis().computeAxis(true)\n      this._xAxisPane.layout()\n      this._panes.forEach(pane => {\n        pane.layout()\n      })\n    }\n  }\n\n  /**\n   * 窗口是否存在\n   * @param paneId\n   * @return {boolean}\n   */\n  hasPane (paneId) {\n    return this._panes.has(paneId)\n  }\n\n  /**\n   * 获取窗口\n   * @param paneId\n   * @returns\n   */\n  getPane (paneId) {\n    return this._panes.get(paneId)\n  }\n\n  /**\n   * 获取图表上的数据\n   * @returns {chartStore}\n   */\n  chartStore () {\n    return this._chartStore\n  }\n\n  /**\n   * 移除指标\n   * @param paneId\n   * @param name\n   */\n  removeTechnicalIndicator (paneId, name) {\n    const removed = this._chartStore.technicalIndicatorStore().removeInstance(paneId, name)\n    if (removed) {\n      let shouldMeasureHeight = false\n      if (paneId !== CANDLE_PANE_ID) {\n        if (!this._chartStore.technicalIndicatorStore().hasInstance(paneId)) {\n          shouldMeasureHeight = true\n          this._panes.get(paneId).destroy()\n          const deleteSeparatorTopPaneId = this._separators.get(paneId).topPaneId()\n          this._separators.get(paneId).destroy()\n          this._panes.delete(paneId)\n          this._separators.delete(paneId)\n          this._separators.forEach(separator => {\n            const topPaneId = separator.topPaneId()\n            if (!this._separators.has(topPaneId)) {\n              separator.updatePaneId(deleteSeparatorTopPaneId)\n            }\n          })\n        }\n      }\n      this.adjustPaneViewport(shouldMeasureHeight, true, true, true, true)\n    }\n  }\n\n  /**\n   * 设置指标类型\n   * @param tech 技术指标实例\n   * @param isStack 是否叠加\n   * @param options 配置\n   */\n  createTechnicalIndicator (tech, isStack, options = {}) {\n    if (this._panes.has(options.id)) {\n      let shouldAdjust = false\n      if (this._chartStore.technicalIndicatorStore().addInstance(options.id, tech, isStack)) {\n        shouldAdjust = this._panes.get(options.id).yAxis().computeAxis()\n      }\n      this.setPaneOptions(options, shouldAdjust)\n      return options.id\n    }\n    const id = options.id || `${TECHNICAL_INDICATOR_PANE_ID_PREFIX}${++this._paneBaseId}`\n    const dragEnabled = isBoolean(options.dragEnabled) ? options.dragEnabled : true\n    this._separators.set(id, new SeparatorPane(\n      this._chartContainer,\n      this._chartStore,\n      Array.from(this._panes.keys()).pop(),\n      id,\n      dragEnabled,\n      {\n        startDrag: this._separatorStartDrag.bind(this),\n        drag: throttle(this._separatorDrag.bind(this), 50)\n      }\n    ))\n    const pane = new TechnicalIndicatorPane({\n      container: this._chartContainer,\n      chartStore: this._chartStore,\n      xAxis: this._xAxisPane.xAxis(),\n      id,\n      height: options.height || DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT\n    })\n    this._panes.set(id, pane)\n    this._chartStore.technicalIndicatorStore().addInstance(id, tech, isStack)\n    this.adjustPaneViewport(true, true, true, true, true)\n    return id\n  }\n\n  /**\n   * 创建图形\n   * @param ShapeTemplateClass\n   * @param shapeOptions\n   * @param paneId\n   */\n  createShape (ShapeTemplateClass, shapeOptions, paneId) {\n    const {\n      id, points, styles, lock, data,\n      onDrawStart, onDrawing,\n      onDrawEnd, onClick,\n      onRightClick, onPressedMove,\n      onMouseEnter, onMouseLeave,\n      onRemove\n    } = shapeOptions\n    const shapeId = id || `${SHAPE_ID_PREFIX}${++this._shapeBaseId}`\n    if (!this._chartStore.shapeStore().hasInstance(shapeId)) {\n      let yAxis = null\n      if (this.hasPane(paneId)) {\n        yAxis = this._panes.get(paneId).yAxis()\n      } else {\n        if (points && points.length > 0) {\n          paneId = CANDLE_PANE_ID\n          yAxis = this._panes.get(CANDLE_PANE_ID).yAxis()\n        }\n      }\n      const shapeInstance = new ShapeTemplateClass({\n        id: shapeId,\n        chartStore: this._chartStore,\n        xAxis: this._xAxisPane.xAxis(),\n        yAxis,\n        points,\n        styles,\n        lock,\n        data\n      })\n      if (isFunction(onDrawStart)) {\n        onDrawStart({ id: shapeId })\n      }\n      perfectOverlayFunc(shapeInstance, [\n        { key: 'onDrawing', fn: onDrawing },\n        { key: 'onDrawEnd', fn: onDrawEnd },\n        { key: 'onClick', fn: onClick },\n        { key: 'onRightClick', fn: onRightClick },\n        { key: 'onPressedMove', fn: onPressedMove },\n        { key: 'onMouseEnter', fn: onMouseEnter },\n        { key: 'onMouseLeave', fn: onMouseLeave },\n        { key: 'onRemove', fn: onRemove }\n      ])\n      this._chartStore.shapeStore().addInstance(shapeInstance, paneId)\n      return shapeId\n    }\n    return null\n  }\n\n  /**\n   * 创建注解\n   * @param annotations\n   * @param paneId\n   */\n  createAnnotation (annotations, paneId) {\n    const instances = []\n    annotations.forEach(({\n      point,\n      styles,\n      checkEventCoordinateOnCustomSymbol,\n      drawCustomSymbol,\n      drawExtend,\n      onClick,\n      onRightClick,\n      onMouseEnter,\n      onMouseLeave\n    }) => {\n      if (point && point.timestamp) {\n        const annotationInstance = new Annotation({\n          id: point.timestamp,\n          chartStore: this._chartStore,\n          point,\n          xAxis: this._xAxisPane.xAxis(),\n          yAxis: this._panes.get(paneId).yAxis(),\n          styles\n        })\n\n        perfectOverlayFunc(annotationInstance, [\n          { key: 'drawExtend', fn: drawExtend },\n          { key: 'drawCustomSymbol', fn: drawCustomSymbol },\n          { key: 'checkEventCoordinateOnCustomSymbol', fn: checkEventCoordinateOnCustomSymbol },\n          { key: 'onClick', fn: onClick },\n          { key: 'onRightClick', fn: onRightClick },\n          { key: 'onMouseEnter', fn: onMouseEnter },\n          { key: 'onMouseLeave', fn: onMouseLeave }\n        ])\n        instances.push(annotationInstance)\n      }\n    })\n    if (instances.length > 0) {\n      this._chartStore.annotationStore().add(instances, paneId)\n    }\n  }\n\n  /**\n   * 创建标签\n   * @param tags\n   * @param paneId\n   */\n  createTag (tags, paneId) {\n    const instances = []\n    let shouldUpdate = false\n    let shouldAdd = false\n    tags.forEach(({ id, point, text, mark, styles }) => {\n      if (isValid(id)) {\n        if (this._chartStore.tagStore().has(id, paneId)) {\n          const updateSuccess = this._chartStore.tagStore().update(id, paneId, { point, text, mark, styles })\n          if (!shouldUpdate) {\n            shouldUpdate = updateSuccess\n          }\n        } else {\n          shouldAdd = true\n          instances.push(new Tag({\n            id,\n            point,\n            text,\n            mark,\n            styles,\n            chartStore: this._chartStore,\n            xAxis: this._xAxisPane.xAxis(),\n            yAxis: this._panes.get(paneId).yAxis()\n          }))\n        }\n      }\n    })\n    if (shouldAdd) {\n      this._chartStore.tagStore().add(instances, paneId)\n    } else {\n      if (shouldUpdate) {\n        this._invalidatePane(InvalidateLevel.OVERLAY)\n      }\n    }\n  }\n\n  /**\n   * 移除所有html元素\n   */\n  removeAllHtml () {\n    this._panes.forEach(pane => { pane.removeHtml() })\n    this._xAxisPane.removeHtml()\n  }\n\n  /**\n   * 设置窗体参数\n   * @param options\n   * @param forceShouldAdjust\n   */\n  setPaneOptions (options, forceShouldAdjust) {\n    let shouldAdjust = forceShouldAdjust\n    let shouldMeasureHeight = false\n    if (options.id !== CANDLE_PANE_ID) {\n      const pane = this._panes.get(options.id)\n      if (pane) {\n        if (isNumber(options.height) && options.height > 0 && pane.height() !== options.height) {\n          shouldAdjust = true\n          pane.setHeight(options.height)\n          shouldMeasureHeight = true\n        }\n        if (isBoolean(options.dragEnabled)) {\n          this._separators.get(options.id).setDragEnabled(options.dragEnabled)\n        }\n      }\n    }\n    if (shouldAdjust) {\n      this.adjustPaneViewport(shouldMeasureHeight, true, true, true, true)\n    }\n  }\n\n  /**\n   * 设置时区\n   * @param timezone\n   */\n  setTimezone (timezone) {\n    this._chartStore.timeScaleStore().setTimezone(timezone)\n    this._xAxisPane.xAxis().computeAxis(true)\n    this._xAxisPane.invalidate(InvalidateLevel.FULL)\n  }\n\n  /**\n   * 将值装换成像素\n   * @param timestamp\n   * @param point\n   * @param paneId\n   * @param absoluteYAxis\n   */\n  convertToPixel (point, { paneId = CANDLE_PANE_ID, absoluteYAxis }) {\n    const points = [].concat(point)\n    let coordinates = []\n    const separatorSize = this._chartStore.styleOptions().separator.size\n    let absoluteTop = 0\n    const panes = this._panes.values()\n    for (const pane of panes) {\n      if (pane.id() === paneId) {\n        coordinates = points.map(({ timestamp, dataIndex, value }) => {\n          const coordinate = {}\n          let index = dataIndex\n          if (isValid(timestamp)) {\n            index = this._chartStore.timeScaleStore().timestampToDataIndex(timestamp)\n          }\n          if (isValid(index)) {\n            coordinate.x = this._xAxisPane.xAxis().convertToPixel(index)\n          }\n          if (isValid(value)) {\n            const y = pane.yAxis().convertToPixel(value)\n            coordinate.y = absoluteYAxis ? absoluteTop + y : y\n          }\n          return coordinate\n        })\n        break\n      }\n      absoluteTop += (pane.height() + separatorSize)\n    }\n    return isArray(point) ? coordinates : (coordinates[0] || {})\n  }\n\n  /**\n   * 将像素转换成值\n   * @param coordinate\n   * @param paneId\n   * @param dataIndexXAxis\n   * @param absoluteYAxis\n   * @return {{}[]|*[]}\n   */\n  convertFromPixel (coordinate, { paneId = CANDLE_PANE_ID, absoluteYAxis }) {\n    const coordinates = [].concat(coordinate)\n    let points = []\n    const separatorSize = this._chartStore.styleOptions().separator.size\n    let absoluteTop = 0\n    const panes = this._panes.values()\n    for (const pane of panes) {\n      if (pane.id() === paneId) {\n        points = coordinates.map(({ x, y }) => {\n          const point = {}\n          if (isValid(x)) {\n            point.dataIndex = this._xAxisPane.xAxis().convertFromPixel(x)\n            point.timestamp = this._chartStore.timeScaleStore().dataIndexToTimestamp(point.dataIndex)\n          }\n          if (isValid(y)) {\n            const ry = absoluteYAxis ? y - absoluteTop : y\n            point.value = pane.yAxis().convertFromPixel(ry)\n          }\n          return point\n        })\n        break\n      }\n      absoluteTop += pane.height() + separatorSize\n    }\n    return isArray(coordinate) ? points : (points[0] || {})\n  }\n\n  /**\n   * 图表宽度\n   * @return {*|{}}\n   */\n  chartWidth () {\n    return this._chartWidth\n  }\n\n  /**\n   * 图表高度\n   * @return {*|{}}\n   */\n  chartHeight () {\n    return this._chartHeight\n  }\n\n  /**\n   * 获取图表转换为图片后url\n   * @param includeOverlay,\n   * @param type\n   * @param backgroundColor\n   */\n  getConvertPictureUrl (includeOverlay, type, backgroundColor) {\n    const width = this._chartContainer.offsetWidth\n    const height = this._chartContainer.offsetHeight\n    const canvas = createElement('canvas', {\n      width: `${width}px`,\n      height: `${height}px`,\n      boxSizing: 'border-box'\n    })\n    const ctx = canvas.getContext('2d')\n    const pixelRatio = getPixelRatio(canvas)\n    canvas.width = width * pixelRatio\n    canvas.height = height * pixelRatio\n    ctx.scale(pixelRatio, pixelRatio)\n\n    ctx.fillStyle = backgroundColor\n    ctx.fillRect(0, 0, width, height)\n    let offsetTop = 0\n    this._panes.forEach((pane, paneId) => {\n      if (paneId !== CANDLE_PANE_ID) {\n        const separator = this._separators.get(paneId)\n        ctx.drawImage(\n          separator.getImage(),\n          0, offsetTop, width, separator.height()\n        )\n        offsetTop += separator.height()\n      }\n      ctx.drawImage(\n        pane.getImage(includeOverlay),\n        0, offsetTop, width, pane.height()\n      )\n      offsetTop += pane.height()\n    })\n    ctx.drawImage(\n      this._xAxisPane.getImage(includeOverlay),\n      0, offsetTop, width, this._xAxisPane.height()\n    )\n    return canvas.toDataURL(`image/${type}`)\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    this._panes.forEach(pane => {\n      pane.destroy()\n    })\n    this._separators.forEach(pane => {\n      pane.destroy()\n    })\n    this._panes.clear()\n    this._separators.clear()\n    this._xAxisPane.destroy()\n    this._container.removeChild(this._chartContainer)\n    this._chartEvent.destroy()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ChartPane, { CANDLE_PANE_ID } from './pane/ChartPane'\nimport { clone, isNumber, isObject, isArray, isFunction, isValid, isString } from './utils/typeChecks'\nimport { logWarn } from './utils/logger'\nimport { requestAnimationFrame } from './utils/compatible'\nimport { formatValue } from './utils/format'\n\nexport default class Chart {\n  constructor (container, styleOptions) {\n    this._chartPane = new ChartPane(container, styleOptions)\n  }\n\n  /**\n   * 获取宽尺寸\n   * @return {*|{}}\n   */\n  getWidth () {\n    return this._chartPane.chartWidth()\n  }\n\n  /**\n   * 获取高度尺寸\n   * @return {*|{}}\n   */\n  getHeight () {\n    return this._chartPane.chartHeight()\n  }\n\n  /**\n   * 设置样式配置\n   * @param options 配置\n   */\n  setStyleOptions (options) {\n    if (!isObject(options)) {\n      logWarn('setStyleOptions', 'options')\n      return\n    }\n    this._chartPane.chartStore().applyStyleOptions(options)\n    this._chartPane.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 获取样式配置\n   * @returns {[]|*[]}\n   */\n  getStyleOptions () {\n    return clone(this._chartPane.chartStore().styleOptions())\n  }\n\n  /**\n   * 设置价格数量精度\n   * @param pricePrecision 价格精度\n   * @param volumePrecision 数量精度\n   */\n  setPriceVolumePrecision (pricePrecision, volumePrecision) {\n    if (!isNumber(pricePrecision) || pricePrecision < 0) {\n      logWarn('setPriceVolumePrecision', 'pricePrecision', 'pricePrecision must be a number and greater than zero!!!')\n      return\n    }\n    if (!isNumber(volumePrecision) || volumePrecision < 0) {\n      logWarn('setPriceVolumePrecision', 'volumePrecision', 'volumePrecision must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartStore().setPriceVolumePrecision(pricePrecision, volumePrecision)\n  }\n\n  /**\n   * 设置时区\n   * @param timezone 时区\n   */\n  setTimezone (timezone) {\n    this._chartPane.setTimezone(timezone)\n  }\n\n  /**\n   * 获取当前时区\n   */\n  getTimezone () {\n    return this._chartPane.chartStore().timeScaleStore().timezone()\n  }\n\n  /**\n   * 重置尺寸，总是会填充父容器\n   */\n  resize () {\n    this._chartPane.adjustPaneViewport(true, true, true, true, true)\n  }\n\n  /**\n   * 设置右边间距\n   * @param space 空间大小\n   */\n  setOffsetRightSpace (space) {\n    if (!isNumber(space)) {\n      logWarn('setOffsetRightSpace', 'space', 'space must be a number!!!')\n      return\n    }\n    this._chartPane.chartStore().timeScaleStore().setOffsetRightSpace(space, true)\n  }\n\n  /**\n   * 设置左边可见的最小bar数量\n   * @param barCount bar数量\n   */\n  setLeftMinVisibleBarCount (barCount) {\n    if (!isNumber(barCount) || barCount <= 0) {\n      logWarn('setLeftMinVisibleBarCount', 'barCount', 'barCount must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartStore().timeScaleStore().setLeftMinVisibleBarCount(Math.ceil(barCount))\n  }\n\n  /**\n   * 设置右边可见的最小bar数量\n   * @param barCount bar数量\n   */\n  setRightMinVisibleBarCount (barCount) {\n    if (!isNumber(barCount) || barCount <= 0) {\n      logWarn('setRightMinVisibleBarCount', 'barCount', 'barCount must be a number and greater than zero!!!')\n      return\n    }\n    this._chartPane.chartStore().timeScaleStore().setRightMinVisibleBarCount(Math.ceil(barCount))\n  }\n\n  /**\n   * 设置一条数据的空间\n   * @param space 空间大小\n   */\n  setDataSpace (space) {\n    if (!isNumber(space)) {\n      logWarn('setDataSpace', 'space', 'space must be a number!!!')\n      return\n    }\n    this._chartPane.chartStore().timeScaleStore().setDataSpace(space)\n  }\n\n  /**\n   * 获取单条数据的空间\n   * @returns\n   */\n  getDataSpace () {\n    return this._chartPane.chartStore().timeScaleStore().dataSpace()\n  }\n\n  /**\n   * 获取单条数据绘制的空间\n   * @returns\n   */\n  getBarSpace () {\n    return this._chartPane.chartStore().timeScaleStore().barSpace()\n  }\n\n  /**\n   * 清空数据\n   */\n  clearData () {\n    this._chartPane.chartStore().clearDataList()\n  }\n\n  /**\n   * 获取数据源\n   */\n  getDataList () {\n    return this._chartPane.chartStore().dataList()\n  }\n\n  /**\n   * 添加新数据\n   * @param dataList k线数据数组\n   * @param more 是否还有更多标识\n   */\n  applyNewData (dataList, more) {\n    if (!isArray(dataList)) {\n      logWarn('applyNewData', 'dataList', 'dataList must be an array!!!')\n      return\n    }\n    const chartStore = this._chartPane.chartStore()\n    chartStore.clearDataList()\n    chartStore.addData(dataList, 0, more)\n    Promise.resolve(chartStore.technicalIndicatorStore().calcInstance()).finally(\n      _ => {\n        this._chartPane.adjustPaneViewport(false, true, true, true)\n      }\n    )\n  }\n\n  /**\n   * 添加历史更多数据\n   * @param dataList k线数据数组\n   * @param more 是否还有更多标识\n   */\n  applyMoreData (dataList, more) {\n    if (!isArray(dataList)) {\n      logWarn('applyMoreData', 'dataList', 'dataList must be an array!!!')\n      return\n    }\n    const chartStore = this._chartPane.chartStore()\n    chartStore.addData(dataList, 0, more)\n    Promise.resolve(chartStore.technicalIndicatorStore().calcInstance()).finally(\n      _ => {\n        this._chartPane.adjustPaneViewport(false, true, true, true)\n      }\n    )\n  }\n\n  /**\n   * 更新数据\n   * @param data 新的k线数据\n   */\n  updateData (data) {\n    if (!isObject(data) || isArray(data)) {\n      logWarn('updateData', 'data', 'data must be an object!!!')\n      return\n    }\n    const chartStore = this._chartPane.chartStore()\n    const dataList = chartStore.dataList()\n    const dataSize = dataList.length\n    // 这里判断单个数据应该添加到哪个位置\n    const timestamp = formatValue(data, 'timestamp', 0)\n    const lastDataTimestamp = formatValue(dataList[dataSize - 1], 'timestamp', 0)\n    if (timestamp >= lastDataTimestamp) {\n      let pos = dataSize\n      if (timestamp === lastDataTimestamp) {\n        pos = dataSize - 1\n      }\n      chartStore.addData(data, pos)\n      Promise.resolve(chartStore.technicalIndicatorStore().calcInstance()).finally(\n        _ => {\n          this._chartPane.adjustPaneViewport(false, true, true, true)\n        }\n      )\n    }\n  }\n\n  /**\n   * 设置加载更多回调\n   * @param cb 回调方法\n   */\n  loadMore (cb) {\n    if (!isFunction(cb)) {\n      logWarn('loadMore', 'cb', 'cb must be a function!!!')\n      return\n    }\n    this._chartPane.chartStore().timeScaleStore().setLoadMoreCallback(cb)\n  }\n\n  /**\n   * 创建一个技术指标\n   * @param value 指标名或者指标\n   * @param isStack 是否覆盖\n   * @param paneOptions 窗口配置\n   * @returns {string|null}\n   */\n  createTechnicalIndicator (value, isStack, paneOptions) {\n    if (!isValid(value)) {\n      logWarn('createTechnicalIndicator', 'value', 'value is invalid!!!')\n      return null\n    }\n    const tech = isObject(value) && !isArray(value) ? value : { name: value }\n    if (!this._chartPane.chartStore().technicalIndicatorStore().hasTemplate(tech.name)) {\n      logWarn('createTechnicalIndicator', 'value', 'can not find the corresponding technical indicator!!!')\n      return null\n    }\n    return this._chartPane.createTechnicalIndicator(tech, isStack, paneOptions)\n  }\n\n  /**\n   * 添加技术指标模板\n   * @param template 指标模板\n   */\n  addTechnicalIndicatorTemplate (template) {\n    if (!isObject(template)) {\n      logWarn('addTechnicalIndicatorTemplate', 'template', 'template must be an object or array!!!')\n      return\n    }\n    const templates = [].concat(template)\n    this._chartPane.chartStore().technicalIndicatorStore().addTemplate(templates)\n  }\n\n  /**\n   * 覆盖技术指标\n   * @param override 覆盖参数\n   * @param paneId 窗口id\n   */\n  overrideTechnicalIndicator (techOverride, paneId) {\n    if (!isObject(techOverride) || isArray(techOverride)) {\n      logWarn('overrideTechnicalIndicator', 'overrideTech', 'overrideTech must be an object!!!')\n      return\n    }\n    const promise = this._chartPane.chartStore().technicalIndicatorStore().override(techOverride, paneId)\n    if (promise) {\n      promise.then(\n        _ => {\n          this._chartPane.adjustPaneViewport(false, true, true, true)\n        }\n      )\n    }\n  }\n\n  /**\n   * 获取技术指标名字获取技术指标\n   * @param name 指标名\n   * @return {{}}\n   */\n  getTechnicalIndicatorTemplate (name) {\n    return this._chartPane.chartStore().technicalIndicatorStore().getTemplateInfo(name)\n  }\n\n  /**\n    * 获取窗口上的技术指标\n    * @param paneId 窗口id\n    * @param name 指标名\n    * @return {{}}\n    */\n  getTechnicalIndicatorByPaneId (paneId, name) {\n    return this._chartPane.chartStore().technicalIndicatorStore().getInstanceInfo(paneId, name)\n  }\n\n  /**\n   * 移除一个技术指标\n   * @param paneId 窗口id\n   * @param name 指标名\n   */\n  removeTechnicalIndicator (paneId, name) {\n    this._chartPane.removeTechnicalIndicator(paneId, name)\n  }\n\n  /**\n   * 添加图形模板\n   * @param template 图形模板\n   */\n  addShapeTemplate (template) {\n    if (!isObject(template)) {\n      logWarn('addShapeTemplate', 'template', 'template must be an object or array!!!')\n      return\n    }\n    const templates = [].concat(template)\n    this._chartPane.chartStore().shapeStore().addTemplate(templates)\n  }\n\n  /**\n   * 创建图形\n   * @param value 图形名或者图形配置\n   * @param paneId 窗口id\n   */\n  createShape (value, paneId) {\n    if (!isValid(value)) {\n      logWarn('createShape', 'value', 'value is invalid!!!')\n      return null\n    }\n    const shapeOptions = isObject(value) && !isArray(value) ? value : { name: value }\n    const Shape = this._chartPane.chartStore().shapeStore().getTemplate(shapeOptions.name)\n    if (!Shape) {\n      logWarn('createShape', 'value', 'can not find the corresponding shape!!!')\n      return null\n    }\n    const id = this._chartPane.createShape(Shape, shapeOptions, paneId)\n    if (!id) {\n      logWarn('createShape', 'options.id', 'duplicate id!!!')\n    }\n    return id\n  }\n\n  /**\n   * 获取图形标记\n   * @param shapeId 图形标记id\n   * @return {{name, lock: *, styles, id, points: (*|*[])}[]|{name, lock: *, styles, id, points: (*|*[])}}\n   */\n  getShape (shapeId) {\n    return this._chartPane.chartStore().shapeStore().getInstanceInfo(shapeId)\n  }\n\n  /**\n   * 设置图形标记配置\n   * @param options 图形标记配置\n   */\n  setShapeOptions (options) {\n    if (!isObject(options) || isArray(options)) {\n      logWarn('setShapeOptions', 'options', 'options must be an object!!!')\n      return\n    }\n    this._chartPane.chartStore().shapeStore().setInstanceOptions(options)\n  }\n\n  /**\n   * 移除图形\n   * @param shapeId 图形id\n   */\n  removeShape (shapeId) {\n    this._chartPane.chartStore().shapeStore().removeInstance(shapeId)\n  }\n\n  /**\n   * 创建注解\n   * @param annotation 单个注解或者注解数组\n   * @param paneId 窗口id\n   */\n  createAnnotation (annotation, paneId = CANDLE_PANE_ID) {\n    if (!isObject(annotation)) {\n      logWarn('createAnnotation', 'annotation', 'annotation must be an object or array!!!')\n      return\n    }\n    if (!this._chartPane.hasPane(paneId)) {\n      logWarn('createAnnotation', 'paneId', 'can not find the corresponding pane!!!')\n      return\n    }\n    const annotations = [].concat(annotation)\n    this._chartPane.createAnnotation(annotations, paneId)\n  }\n\n  /**\n   * 移除注解\n   * @param paneId 窗口id\n   * @param points 单个点或者点数组\n   */\n  removeAnnotation (paneId, points) {\n    this._chartPane.chartStore().annotationStore().remove(paneId, points)\n  }\n\n  /**\n   * 创建标签\n   * @param tag 单个标签或者标签数组\n   * @param paneId 窗口id\n   */\n  createTag (tag, paneId = CANDLE_PANE_ID) {\n    if (!isObject(tag)) {\n      logWarn('createTag', 'tag', 'tag must be an object or array!!!')\n      return\n    }\n    if (!this._chartPane.hasPane(paneId)) {\n      logWarn('createTag', 'paneId', 'can not find the corresponding pane!!!')\n      return\n    }\n    const tags = [].concat(tag)\n    this._chartPane.createTag(tags, paneId)\n  }\n\n  /**\n   * 移除标签\n   * @param paneId 窗口id\n   * @param tagId 标签id\n   */\n  removeTag (paneId, tagId) {\n    this._chartPane.chartStore().tagStore().remove(paneId, tagId)\n  }\n\n  /**\n   * 创建html元素\n   * @param html\n   * @param paneId\n   * @returns\n   */\n  createHtml (html, paneId = CANDLE_PANE_ID) {\n    if (!isObject(html)) {\n      logWarn('createHtml', 'html', 'options must be an object!!!')\n      return null\n    }\n    if (!isString(html.content) && !(html.content instanceof HTMLElement)) {\n      logWarn('createHtml', 'html.content', 'invalid html.content!!!')\n      return null\n    }\n    const pane = this._chartPane.getPane(paneId)\n    if (!pane) {\n      logWarn('createHtml', 'paneId', 'can not find the corresponding pane!!!')\n      return null\n    }\n    return pane.createHtml(html)\n  }\n\n  /**\n   * 移除html元素\n   * @param paneId\n   * @param htmlId\n   */\n  removeHtml (paneId, htmlId) {\n    if (paneId) {\n      const pane = this._chartPane.getPane(paneId)\n      pane && pane.removeHtml(htmlId)\n    } else {\n      this._chartPane.removeAllHtml()\n    }\n  }\n\n  /**\n   * 设置窗口属性\n   * @param options 窗口配置\n   */\n  setPaneOptions (options) {\n    if (!isObject(options)) {\n      logWarn('setPaneOptions', 'options', 'options must be an object!!!')\n      return\n    }\n    this._chartPane.setPaneOptions(options, false)\n  }\n\n  /**\n   * 设置是否可以缩放\n   * @param enabled 标识\n   */\n  setZoomEnabled (enabled) {\n    this._chartPane.chartStore().timeScaleStore().setZoomEnabled(enabled)\n  }\n\n  /**\n   * 是否可以缩放\n   * @return {boolean}\n   */\n  isZoomEnabled () {\n    return this._chartPane.chartStore().timeScaleStore().zoomEnabled()\n  }\n\n  /**\n   * 设置是否可以拖拽滚动\n   * @param enabled 标识\n   */\n  setScrollEnabled (enabled) {\n    this._chartPane.chartStore().timeScaleStore().setScrollEnabled(enabled)\n  }\n\n  /**\n   * 是否可以拖拽滚动\n   * @return {boolean}\n   */\n  isScrollEnabled () {\n    return this._chartPane.chartStore().timeScaleStore().scrollEnabled()\n  }\n\n  /**\n   * 按距离滚动\n   * @param distance 距离\n   * @param animationDuration 动画持续时间\n   */\n  scrollByDistance (distance, animationDuration) {\n    if (!isNumber(distance)) {\n      logWarn('scrollByDistance', 'distance', 'distance must be a number!!!')\n      return\n    }\n    if (isNumber(animationDuration) && animationDuration > 0) {\n      this._chartPane.chartStore().timeScaleStore().startScroll()\n      const startTime = new Date().getTime()\n      const animation = () => {\n        const progress = (new Date().getTime() - startTime) / animationDuration\n        const finished = progress >= 1\n        const dis = finished ? distance : distance * progress\n        this._chartPane.chartStore().timeScaleStore().scroll(dis)\n        if (!finished) {\n          requestAnimationFrame(animation)\n        }\n      }\n      animation()\n    } else {\n      this._chartPane.chartStore().timeScaleStore().startScroll()\n      this._chartPane.chartStore().timeScaleStore().scroll(distance)\n    }\n  }\n\n  /**\n   * 滚动到实时位置\n   * @param animationDuration 动画持续时间\n   */\n  scrollToRealTime (animationDuration) {\n    const difBarCount = this._chartPane.chartStore().timeScaleStore().offsetRightBarCount() - this._chartPane.chartStore().timeScaleStore().offsetRightSpace() / this._chartPane.chartStore().timeScaleStore().dataSpace()\n    const distance = difBarCount * this._chartPane.chartStore().timeScaleStore().dataSpace()\n    this.scrollByDistance(distance, animationDuration)\n  }\n\n  /**\n   * 滚动到指定的数据索引\n   * @param dataIndex 数据索引\n   * @param animationDuration 动画持续时间\n   */\n  scrollToDataIndex (dataIndex, animationDuration) {\n    if (!isNumber(dataIndex)) {\n      logWarn('scrollToDataIndex', 'dataIndex', 'dataIndex must be a number!!!')\n      return\n    }\n    const distance = (this._chartPane.chartStore().dataList().length - 1 - dataIndex) * this._chartPane.chartStore().timeScaleStore().dataSpace()\n    this.scrollByDistance(distance, animationDuration)\n  }\n\n  /**\n   * 在某个坐标点缩放\n   * @param scale 缩放比例\n   * @param coordinate 坐标点\n   * @param animationDuration 动画持续时间\n   */\n  zoomAtCoordinate (scale, coordinate, animationDuration) {\n    if (!isNumber(scale)) {\n      logWarn('zoomAtCoordinate', 'scale', 'scale must be a number!!!')\n      return\n    }\n    if (isNumber(animationDuration) && animationDuration > 0) {\n      const dataSpace = this._chartPane.chartStore().timeScaleStore().dataSpace()\n      const scaleDataSpace = dataSpace * scale\n      const difSpace = scaleDataSpace - dataSpace\n      const startTime = new Date().getTime()\n      const animation = () => {\n        const progress = (new Date().getTime() - startTime) / animationDuration\n        const finished = progress >= 1\n        const progressDataSpace = finished ? difSpace : difSpace * progress\n        this._chartPane.chartStore().timeScaleStore().zoom(progressDataSpace / dataSpace, coordinate)\n        if (!finished) {\n          requestAnimationFrame(animation)\n        }\n      }\n      animation()\n    } else {\n      this._chartPane.chartStore().timeScaleStore().zoom(scale, coordinate)\n    }\n  }\n\n  /**\n   * 在某个数据索引缩放\n   * @param scale 缩放比例\n   * @param dataIndex 索引位置\n   * @param animationDuration 动画持续时间\n   */\n  zoomAtDataIndex (scale, dataIndex, animationDuration) {\n    if (!isNumber(scale)) {\n      logWarn('zoomAtDataIndex', 'scale', 'scale must be a number!!!')\n      return\n    }\n    if (!isNumber(dataIndex)) {\n      logWarn('zoomAtDataIndex', 'dataIndex', 'dataIndex must be a number!!!')\n      return\n    }\n    const x = this._chartPane.chartStore().timeScaleStore().dataIndexToCoordinate(dataIndex)\n    this.zoomAtCoordinate(scale, { x }, animationDuration)\n  }\n\n  /**\n   * 将值装换成像素\n   * @param point 单个点或者点集合\n   * @param finder 过滤条件\n   */\n  convertToPixel (point, finder) {\n    return this._chartPane.convertToPixel(point, finder)\n  }\n\n  /**\n   * 将像素转换成值\n   * @param coordinate 单个坐标或者坐标集合\n   * @param finder 过滤条件\n   */\n  convertFromPixel (coordinate, finder) {\n    return this._chartPane.convertFromPixel(coordinate, finder)\n  }\n\n  /**\n   * 订阅图表动作\n   * @param type 动作类型\n   * @param callback 回调方法\n   */\n  subscribeAction (type, callback) {\n    if (!this._chartPane.chartStore().actionStore().subscribe(type, callback)) {\n      logWarn('subscribeAction', 'type', 'type does not exist!!!')\n    }\n  }\n\n  /**\n   * 取消订阅图表动作\n   * @param type 动作类型\n   * @param callback 回调方法\n   */\n  unsubscribeAction (type, callback) {\n    if (!this._chartPane.chartStore().actionStore().unsubscribe(type, callback)) {\n      logWarn('unsubscribeAction', 'type', 'type does not exist!!!')\n    }\n  }\n\n  /**\n   * 获取将图表装换成图片后的url\n   * @param includeOverlay 是否包含覆盖层\n   * @param type 图片类型\n   * @param backgroundColor 背景色\n   */\n  getConvertPictureUrl (includeOverlay, type = 'jpeg', backgroundColor = '#FFFFFF') {\n    if (type !== 'png' && type !== 'jpeg' && type !== 'bmp') {\n      logWarn('getConvertPictureUrl', 'type', 'type only supports jpeg, png and bmp!!!')\n      return\n    }\n    return this._chartPane.getConvertPictureUrl(includeOverlay, type, backgroundColor)\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    this._chartPane.destroy()\n  }\n}\n","/**\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n\n * http://www.apache.org/licenses/LICENSE-2.0\n\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Chart from './Chart'\nimport { logError, logTag, logWarn } from './utils/logger'\nimport { isString } from './utils/typeChecks'\n\nconst instances = {}\nlet chartBaseId = 1\nconst CHART_NAME_PREFIX = 'k_line_chart_'\n\n/**\n * 获取版本号\n * @returns {string}\n */\nfunction version () {\n  return '__BUILD_VERSION__'\n}\n\n/**\n * 初始化\n * @param ds\n * @param style\n * @returns {Chart}\n */\nfunction init (ds, style = {}) {\n  logTag()\n  const errorMessage = 'The chart cannot be initialized correctly. Please check the parameters. The chart container cannot be null and child elements need to be added!!!'\n  let dom\n  if (!ds) {\n    logError('', '', errorMessage)\n    return null\n  }\n  if (isString(ds)) {\n    dom = document.getElementById(ds)\n  } else {\n    dom = ds\n  }\n  if (!dom) {\n    logError('', '', errorMessage)\n    return null\n  }\n  let chart = instances[dom.chartId || '']\n  if (chart) {\n    return chart\n  }\n  const id = `${CHART_NAME_PREFIX}${chartBaseId++}`\n  chart = new Chart(dom, style)\n  chart.id = id\n  dom.chartId = id\n  instances[id] = chart\n  return chart\n}\n\n/**\n * 销毁\n * @param dcs\n */\nfunction dispose (dcs) {\n  if (dcs) {\n    let id\n    if (isString(dcs)) {\n      const dom = document.getElementById(dcs)\n      id = dom && dom.chartId\n    } else if (dcs instanceof Chart) {\n      id = dcs.id\n    } else {\n      id = dcs && dcs.chartId\n    }\n    if (id) {\n      instances[id].destroy()\n      delete instances[id]\n    }\n  }\n}\n\nexport { version, init, dispose }\n"],"names":["technicalIndicatorExtensions","shapeExtensions","addTechnicalIndicatorTemplate","template","concat","forEach","tmp","name","addShapeTemplate","merge","target","source","isObject","key","Object","prototype","hasOwnProperty","call","targetProp","sourceProp","isArray","isValid","clone","copy","v","value","toString","isFunction","isNumber","isNaN","undefined","isBoolean","isString","StrokeFillStyle","STROKE","FILL","LineStyle","DASH","SOLID","YAxisPosition","LEFT","RIGHT","YAxisType","NORMAL","PERCENTAGE","LOG","CandleType","CANDLE_SOLID","CANDLE_STROKE","CANDLE_UP_STROKE","CANDLE_DOWN_STROKE","OHLC","AREA","TooltipShowRule","ALWAYS","FOLLOW_CROSS","NONE","TooltipShowType","RECT","STANDARD","AnnotationSymbolType","CIRCLE","TRIANGLE","DIAMOND","CUSTOM","OverlayPosition","POINT","TOP","BOTTOM","defaultGrid","show","horizontal","size","color","style","dashValue","vertical","defaultCandle","margin","top","bottom","type","bar","upColor","downColor","noChangeColor","area","lineSize","lineColor","backgroundColor","offset","priceMark","high","textMargin","textSize","textFamily","textWeight","low","last","line","text","paddingLeft","paddingTop","paddingRight","paddingBottom","family","weight","borderRadius","tooltip","showRule","showType","labels","values","defaultValue","rect","offsetLeft","offsetTop","offsetRight","borderSize","borderColor","marginLeft","marginTop","marginRight","marginBottom","defaultTechnicalIndicator","colors","circle","lastValueMark","showName","showParams","defaultXAxis","height","axisLine","tickText","tickLine","length","defaultYAxis","width","position","inside","defaultCrosshair","defaultShape","point","radius","activeBackgroundColor","activeBorderColor","activeBorderSize","activeRadius","polygon","stroke","fill","arc","defaultAnnotation","symbol","activeSize","activeColor","defaultTag","mark","defaultSeparator","defaultStyleOptions","grid","candle","technicalIndicator","xAxis","yAxis","separator","crosshair","shape","annotation","tag","formatValue","data","formatDate","dateTimeFormat","timestamp","format","dateTimeString","Date","dateTimeStringArray","split","dateStringArray","date","YYYY","MM","DD","match","replace","formatPrecision","precision","toFixed","formatBigNumber","logWarn","api","invalidParam","append","console","log","logError","logTag","binarySearchNearest","dataList","valueKey","targetNumber","left","right","midIndex","Math","floor","mid","midValue","nice","exponent","log10","exp10","index10","f","nf","round","min","max","getPrecision","str","eIndex","indexOf","slice","dotIndex","pow","ActionType","ZOOM","SCROLL","CROSSHAIR","TOOLTIP","PANE_DRAG","hasAction","MIN_DATA_SPACE","MAX_DATA_SPACE","TimeScaleStore","chartStore","_chartStore","_dateTimeFormat","Intl","DateTimeFormat","hour12","year","month","day","hour","minute","_zoomEnabled","_scrollEnabled","_loading","_loadMoreCallback","_more","_totalDataSpace","_dataSpace","_barSpace","_calcBarSpace","_offsetRightSpace","_offsetRightBarCount","_leftMinVisibleBarCount","_rightMinVisibleBarCount","_from","_to","_preOffsetRightBarCount","rateBarSpace","floorBarSpace","optimalBarSpace","dataSize","barLength","maxRightOffsetBarCount","minRightOffsetBarCount","adjustVisibleDataList","more","loading","timezone","timeZone","e","resolvedOptions","dataSpace","adjustBeforeFuc","adjustFromTo","crosshairStore","recalculate","invalidate","totalSpace","space","setOffsetRightSpace","barCount","distance","distanceBarCount","actionStore","execute","cross","get","set","dataIndex","x","deltaFromRight","index","getDataByDataIndex","pixel","ceil","coordinateToFloatIndex","scale","coordinate","floatIndex","setDataSpace","enabled","callback","TechnicalIndicatorPlotType","LINE","BAR","TechnicalIndicatorSeries","PRICE","VOLUME","getTechnicalIndicatorPlotStyle","kLineDataList","techDataList","plot","techStyles","defaultStyle","isStroke","cbData","prev","kLineData","technicalIndicatorData","current","next","TechnicalIndicator","shortName","series","calcParams","plots","shouldCheckParamCount","shouldOhlc","shouldFormatBigNumber","minValue","maxValue","styles","_precisionFlag","result","map","param","flag","parseInt","params","i","allowDecimal","oldParam","push","regeneratePlots","_createParams","defaultStyles","calcTechnicalIndicator","options","TechnicalIndicatorStore","_templates","_createTemplates","_instances","Map","tech","mapping","extensions","extension","templateInstance","_createTemplateInstance","render","Template","templates","instance","_createTechInfo","templateInfos","paneId","isStack","paneInstances","has","create","getPrototypeOf","setCalcParams","setPrecision","setShouldOhlc","setShouldFormatBigNumber","setStyles","styleOptions","clear","calc","removed","delete","info","instanceInfos","entry","instanceInfo","infos","paneInstance","pricePrecision","volumePrecision","techOverride","defaultTechStyleOptions","instances","setShortName","overiderSuccss","tasks","shortNameSuccess","calcParamsSuccess","precisionSuccess","shouldOhlcSuccess","shouldFormatBigNumberSuccess","styleSuccess","Promise","resolve","all","perfectOverlayFunc","overlay","funcs","fn","Overlay","id","_id","_xAxis","_yAxis","_styles","ctx","points","event","renderFillCircle","fillColor","circleCoordinate","fillStyle","beginPath","y","PI","closePath","DEVIATION","getTriangleSquare","coordinate1","coordinate2","coordinate3","x1","abs","y1","x2","y2","checkCoordinateInCircle","circleCenterCoordinate","targetCoordinate","difX","difY","checkCoordinateInTriangle","triangleCoordinates","square","compareSquare","checkCoordinateInDiamond","centerCoordinate","xDis","yDis","checkCoordinateInRect","renderPath","coordinates","strokeFill","save","lineWidth","translate","move","moveTo","lineTo","restore","renderStrokePath","renderFillPath","renderHorizontalLine","correction","renderVerticalLine","renderLine","getPixelRatio","canvas","ownerDocument","defaultView","devicePixelRatio","calcTextWidth","measureText","createFont","fontSize","fontWeight","fontFamily","getTextRectWidth","font","textWidth","getTextRectHeight","SHAPE_DRAW_STEP_START","SHAPE_DRAW_STEP_FINISHED","ShapeMouseOperateElement","OTHER","ShapeElementType","TEXT","CONTINUOUS_LINE","POLYGON","ARC","LineType","COMMON","HORIZONTAL","VERTICAL","ShapeMode","WEAK_MAGNET","STRONG_MAGNET","getLineType","Shape","totalStep","lock","_name","_totalStep","_lock","_mode","_data","_drawStep","_points","setPoints","_prevPressPoint","_prevPoints","_coordinates","repeatTotalStep","performEventMoveForDrawing","step","mode","movePoint","performEventPressedMove","pressPointIndex","pressPoint","timeScaleStore","timestampToDataIndex","convertToPixel","lines","strokeStyle","setLineDash","lineType","continuousLines","polygons","strokeStyles","arcs","startAngle","endAngle","texts","fillStroke","strokeText","fillText","_timestampOrDataIndexToCoordinateX","shapeOptions","viewport","price","volume","_shapeDataSources","createShapeDataSource","isDraw","dataSource","_drawLines","_drawContinuousLines","_drawPolygons","_drawArcs","_drawText","drawExtend","shapeMouseOperate","shapeStore","mouseOperate","hover","element","click","isDrawing","elementIndex","eventCoordinate","start","isCheck","sources","checkEventCoordinateOnShape","convertFromPixel","highY","buffValue","lowY","open","close","dataIndexToTimestamp","_performValue","onDrawing","progressInstanceComplete","onDrawEnd","onPressedMove","difDataIndex","difValue","InvalidateLevel","OVERLAY","MAIN","FULL","ShapeStore","_mouseOperate","_progressInstance","_pressedInstance","TemplateClass","_createTemplateClass","shapeId","find","s","getInstance","fixed","progressInstance","setYAxis","shouldInvalidate","setLock","setMode","setData","shapes","onRemove","removeIndex","findIndex","splice","pressedInstance","AnnotationStore","_annotations","_visibleAnnotations","operate","visibleDataList","annotations","an","createSymbolCoordinate","idAnnotations","createVisibleAnnotations","shouldAdjust","paneAnnotations","TagStore","_tags","tags","_getById","update","idTags","tagId","paneTags","ids","CrosshairStore","_crosshair","notInvalidate","cr","realDataIndex","coordinateToDataIndex","realX","dataIndexToCoordinate","prevCrosshair","crosshairChange","Delegate","_observers","observer","ActionStore","_delegates","hasObservers","subscribe","delegate","unsubscribe","ChartStore","handler","_handler","_styleOptions","_pricePrecision","_volumePrecision","_dataList","_visibleDataList","_dragPaneFlag","_timeScaleStore","_technicalIndicatorStore","_shapeStore","_annotationStore","_tagStore","_crosshairStore","_actionStore","from","to","setSeriesPrecision","pos","setLoading","setMore","isFirstAdd","resetOffsetRightSpace","offsetRightBarCount","setOffsetRightBarCount","invalidateLevel","createElement","document","Pane","props","_height","_container","container","_initBefore","_initElement","_mainWidget","_createMainWidget","_element","_yAxisWidget","_createYAxisWidget","padding","overflow","boxSizing","lastElement","lastChild","insertBefore","appendChild","offsetWidth","mainWidgetWidth","yAxisWidgetWidth","setWidth","setHeight","mainWidgetOffsetLeft","yAxisWidgetOffsetLeft","setOffsetLeft","offsetHeight","layout","level","content","htmlId","createHtml","removeHtml","includeOverlay","getContext","pixelRatio","mainWidgetElement","getElement","mainWidgetHeight","drawImage","getImage","yAxisWidgetElement","yAxisWidgetHeight","removeChild","Widget","_width","_mainView","_createMainView","_overlayView","_createOverlayView","_htmlBaseId","_htmls","html","zIndex","innerHTML","replaceChild","flush","requestAnimationFrame","window","setTimeout","cancelAnimationFrame","clearTimeout","View","_initCanvas","_canvas","_ctx","extendFun","clearRect","_draw","_redraw","requestAnimationId","TechnicalIndicatorView","_paneId","globalCompositeOperation","_drawContent","_drawTechs","_drawGrid","gridOptions","gridHorizontalOptions","ticks","tick","gridVerticalOptions","techOptions","techs","technicalIndicatorStore","techResult","technicalIndicatorDataList","barSpace","lineColors","lineColorSize","isCandleYAxis","_drawGraphics","halfBarSpace","techData","lineCount","_drawCandleBar","valueY","plotStyle","_drawCircle","baseValue","baseValueY","_drawBar","n","strokeRect","fillRect","barOptions","barStyle","openY","closeY","highEndY","lowStartY","barHeight","renderText","TechnicalIndicatorOverlayView","textBaseline","_drawTag","_drawShape","_drawAnnotation","crosshairOptions","_drawCrosshairLine","_drawTooltip","annotationStore","draw","tagStore","drawMarkLine","progressShape","_drawBatchTechToolTip","_shouldDrawTooltip","optionsKey","end","drawLine","crosshairDirectionOptions","crosshairLineOptions","isDrawTechTooltip","techTooltipOptions","_drawTechTooltip","techTooltipTextOptions","textMarginLeft","textMarginRight","textColor","labelX","labelY","tooltipData","_getTechTooltipData","nameText","nameTextWidth","calcParamText","calcParamTextWidth","title","tooltipOptions","join","colorSize","TechnicalIndicatorWidget","renderStrokeFillRoundRect","renderFillRoundRect","renderStrokeRoundRect","renderFillRect","w","h","r","renderRoundRect","arcTo","YAxisView","yAxisOptions","_drawAxisLine","_drawTickLines","_drawTickLabels","_drawTechLastValue","_drawLastPriceLabel","isFromYAxisZero","tickLineLength","startX","endX","tickLineShow","textAlign","lastValueMarkOptions","_drawMarkLabel","priceMarkOptions","lastPriceMarkOptions","convertToNicePixel","yAxisType","fromData","fromClose","rectWidth","rectHeight","rectStartX","YAxisOverlayView","_drawCrossHairLabel","drawText","crosshairHorizontalOptions","crosshairHorizontalTextOptions","rectY","YAxisWidget","Axis","_cacheMinValue","_cacheMaxValue","_minValue","_maxValue","_range","_ticks","_initMeasureCanvas","measureCanvas","_measureCtx","forceCompute","minMax","_optimalMinMax","_computeMinMax","range","_optimalTicks","_computeTicks","intervalPrecision","_computeInterval","interval","first","YAxis","_realRange","_isCandleYAxis","minMaxArray","Number","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","plotsResult","techPrecision","techGap","candleOptions","isArea","areaValueKey","shouldCompareHighLow","specifyMin","specifyMax","dif","minCheck","maxCheck","marginOptions","topRate","rate","bottomRate","optimalTicks","textHeight","validY","_innerConvertToPixel","yAxisWidth","crosshairVerticalTextWidth","valueText","TechnicalIndicatorPane","_createYAxis","CandleView","_drawLastPriceLine","_drawArea","_drawLowHighPrice","comparePrice","_drawCandle","lineCoordinates","areaCoordinates","minY","areaOptions","areaCoordinateLength","lastCoordinate","gradient","createLinearGradient","addColorStop","optionKey","priceKey","initPriceValue","offsets","compare","lowHighPriceMarkOptions","priceY","startY","CandleOverlayView","candleTooltipOptions","isDrawCandleTooltip","_drawCandleTooltipWithRect","_drawCandleTooltipWithStandard","_getCandleTooltipData","label","labelWidth","valueColor","baseLabels","baseValues","baseTextMarginLeft","baseTextMarginRight","baseTextMarginTop","baseTextMarginBottom","baseTextSize","baseTextColor","rectOptions","rectBorderSize","rectPaddingLeft","rectPaddingRight","rectPaddingTop","rectPaddingBottom","rectLeft","rectRight","maxLabelWidth","techTooltipTextMarginLeft","techTooltipTextMarginRight","techTooltipTextMarginTop","techTooltipTextMarginBottom","techTooltipTextSize","techTooltipDataList","centerX","rectX","baseLabelX","indicatorLabelX","CandleWidget","CandlePane","XAxisView","xAxisOptions","xAxisLine","endY","tickLength","XAxisOverlayView","_drawCrosshairLabel","crosshairVerticalOptions","crosshairVerticalTextOptions","XAxisWidget","XAxis","defaultLabelWidth","tickCountDif","nextPos","nextX","xDif","prePos","preKLineData","preTimestamp","_optimalTickLabel","oV","optimalTickLength","firstTimestamp","secondTimestamp","thirdV","test","comparedTimestamp","stylOptions","xAxisHeight","crosshairVerticalTextHeight","XAxisPane","EventType","MOUSE","TOUCH","isTouch","isMouse","MouseEventButton","DELAY_RESET_CLICK","DELAY_LONG_TAG","getBoundingClientRect","isTouchEvent","Boolean","touches","preventDefault","cancelable","mobileTouch","touchEvent","DocumentTouch","navigator","maxTouchPoints","msMaxTouchPoints","getDistance","p1","p2","xDiff","clientX","yDiff","clientY","sqrt","EventBase","eventHandler","_target","_options","_clickCount","_clickTimeoutId","_longTapTimeoutId","_longTapActive","_mouseMoveStartPosition","_moveExceededManhattanDistance","_cancelClick","_unsubscribeOutsideEvents","_unsubscribeMousemove","_unsubscribeRoot","_startPinchMiddleCoordinate","_startPinchDistance","_pinchPrevented","_preventDragProcess","_mousePressed","_init","_clearLongTapTimeout","_resetClickTimeout","enterEvent","boundMouseMoveHandler","_mouseMoveHandler","bind","boundMouseWheelHandler","_mouseWheelHandler","removeEventListener","addEventListener","passive","compatEvent","_makeCompatEvent","_processEvent","mouseEnterEvent","moveEvent","mouseMoveEvent","wheelEvent","localX","localY","mouseWheelEvent","button","startMouseMovePos","xOffset","pageX","yOffset","pageY","moveExceededManhattanDistance","correctedXOffset","isVertDrag","treatVertTouchDragAsPageScroll","isHorzDrag","treatHorzTouchDragAsPageScroll","pressedMouseMoveEvent","mouseUpEvent","_mouseLeaveHandler","mouseDoubleClickEvent","mouseClickEvent","downEvent","mouseRightDownEvent","_mouseEnterHandler","boundMouseMoveWithDownHandler","_mouseMoveWithDownHandler","boundMouseUpHandler","_mouseUpHandler","rootElement","documentElement","_longTapHandler","mouseDownEvent","doc","outsideHandler","mouseDownOutsideEvent","contains","_mouseDownHandler","_initPinch","pinchStartEvent","pinchEvent","pinchEndEvent","_checkPinchState","currentDistance","_stopPinch","_startPinch","box","mouseLeaveEvent","longTapEvent","eventLike","changedTouches","screenX","screenY","ctrlKey","altKey","shiftKey","metaKey","startsWith","view","SeparatorPane","topPaneId","bottomPaneId","dragEnabled","dragEventHandler","_topPaneId","_bottomPaneId","_dragEnabled","_offsetLeft","_dragEventHandler","_dragFlag","_initEvent","_wrapper","cursor","_dragEvent","_mouseDownEvent","_mouseUpEvent","_pressedMouseMoveEvent","_mouseEnterEvent","_mouseLeaveEvent","_startY","startDrag","setDragPaneFlag","dragDistance","drag","separatorOptions","background","destroy","EventHandler","TOUCH_MIN_RADIUS","ZoomScrollEventHandler","_startScrollCoordinate","_touchCoordinate","_touchCancelCrosshair","_touchZoomed","_pinchScale","middleCoordinate","zoomScale","zoom","paneY","deltaX","deltaY","startScroll","scroll","deltaMode","DOM_DELTA_PAGE","DOM_DELTA_LINE","sign","yDif","OverlayEventHandler","overlays","preHoverOperate","hoverOperate","checkEventCoordinateOn","onMouseLeave","onMouseEnter","updatePressedInstance","_waitingForMouseMove","shapeHoverOperate","shapeClickOperate","annotationHoverOperate","isStart","updateProgressInstance","mouseMoveForDrawing","prevShapeHoverOperate","prevAnnotationHoverOperate","_performOverlayMouseHover","setMouseOperate","mouseLeftButtonDownForDrawing","startPressedOtherMove","onClick","visibleAnnotations","annotationOperate","shapeOperateValid","removeShape","onRightClick","removeInstance","mousePressedPointMove","mousePressedOtherMove","KeyBoardCode","EQUAL","MINUS","ARROW_LEFT","ARROW_RIGHT","KeyBoardEventHandler","code","ChartEvent","_chartContentLeftRight","_chartContentTopBottom","_paneContentSize","_event","_pinchStartEvent","_pinchEvent","_mouseClickEvent","_mouseRightDownEvent","_mouseMoveEvent","_mouseWheelEvent","_longTapEvent","_boundKeyBoardDownEvent","_keyBoardDownEvent","_boundContextMenuEvent","_zoomScrollEventHandler","_overlayEventHandler","_keyBoardEventHandler","keyBoardDownEvent","_checkEventInChartContent","_shouldPerformOverlayEvent","HTMLCanvasElement","_compatChartEvent","dragPaneFlag","_checkZoomScroll","_modifyEventOptions","isPressed","isEmpty","setOptions","compatY","contentTop","contentBottom","contentLeft","contentRight","chartContentLeftRight","chartContentTopBottom","paneContentSize","throttle","func","wait","previous","now","context","args","arguments","apply","renderFillDiamond","renderFillTriangle","Annotation","_point","_symbolCoordinate","isActive","symbolOptions","styleSize","styleActiveSize","drawCustomSymbol","_drawSymbol","isOn","checkEventCoordinateOnCustomSymbol","Tag","_text","_mark","success","tagOptions","_getY","_drawLine","_drawMark","tagTextOptions","tagLineOptions","textRectWidth","markRectWidth","markOffset","textValid","markValid","tagMarkOptions","DEFAULT_TECHNICAL_INDICATOR_PANE_HEIGHT","TECHNICAL_INDICATOR_PANE_ID_PREFIX","SHAPE_ID_PREFIX","CANDLE_PANE_ID","XAXIS_PANE_ID","ChartPane","_initChartContainer","_shapeBaseId","_paneBaseId","_separatorDragStartTopPaneHeight","_separatorDragStartBottomPaneHeight","_invalidatePane","_crosshairObserver","_xAxisPane","_chartContainer","_panes","_separators","_chartWidth","_chartHeight","_chartEvent","adjustPaneViewport","userSelect","webkitUserSelect","msUserSelect","MozUserSelect","webkitTapHighlightColor","outline","borderStyle","tabIndex","techDatas","_","topPaneHeight","bottomPaneHeight","pane","shouldMeasureWidth","should","computeAxis","paneHeight","separatorSize","separatorTotalHeight","getSelfHeight","paneExcludeXAxisSeparatorHeight","techPaneTotalHeight","candlePaneHeight","total","setPaneContentSize","setChartContentTopBottom","isYAxisLeft","isOutside","paneWidth","mainWidth","yAxisOffsetLeft","mainOffsetLeft","getSelfWidth","setTotalDataSpace","setSize","setChartContentLeftRight","shouldMeasureHeight","shouldLayout","shouldComputeAxis","shouldForceComputeAxis","_measurePaneHeight","isAdjust","adjust","_measurePaneWidth","hasInstance","deleteSeparatorTopPaneId","updatePaneId","addInstance","setPaneOptions","Array","keys","pop","_separatorStartDrag","_separatorDrag","ShapeTemplateClass","onDrawStart","hasPane","shapeInstance","annotationInstance","add","shouldUpdate","shouldAdd","updateSuccess","forceShouldAdjust","setDragEnabled","setTimezone","absoluteYAxis","absoluteTop","panes","ry","toDataURL","Chart","_chartPane","chartWidth","chartHeight","applyStyleOptions","setPriceVolumePrecision","setLeftMinVisibleBarCount","setRightMinVisibleBarCount","clearDataList","addData","calcInstance","finally","lastDataTimestamp","cb","setLoadMoreCallback","paneOptions","hasTemplate","createTechnicalIndicator","addTemplate","promise","override","then","getTemplateInfo","getInstanceInfo","removeTechnicalIndicator","getTemplate","createShape","setInstanceOptions","createAnnotation","remove","createTag","HTMLElement","getPane","removeAllHtml","setZoomEnabled","zoomEnabled","setScrollEnabled","scrollEnabled","animationDuration","startTime","getTime","animation","progress","finished","dis","difBarCount","offsetRightSpace","scrollByDistance","scaleDataSpace","difSpace","progressDataSpace","zoomAtCoordinate","finder","getConvertPictureUrl","chartBaseId","CHART_NAME_PREFIX","version","init","ds","errorMessage","dom","getElementById","chart","chartId","dispose","dcs"],"mappings":"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"}